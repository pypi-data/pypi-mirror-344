import{P as Jt,c as Qt}from"../chunks/BBLiiV7J.js";import{t as H,a as T,c as bt,s as et,b as $t}from"../chunks/C1951IdI.js";import{p as nt,c as w,r as y,t as tt,a as at,f as rt,n as Et,y as Yt,v as Q,q as it,aF as te,j as r,l as J,s as N,aG as Ot,A as ee,e as Zt}from"../chunks/CdjFANdp.js";import{s as Pt,r as It,a as ot,i as ut,d as ht,c as Ft,p as ne,b as Bt}from"../chunks/OpdB38Ru.js";import{s as vt,F as Dt,j as Nt,G as Ct,I as Gt,f as ae,d as oe,H as xt,J as At,K as ie,M as se,N as Ht,T as zt,O as St,c as mt,e as ft,u as re,i as Lt,b as le,g as ue}from"../chunks/8eNpkxEe.js";import{S as Xt,f as gt,a as pt,T as ce,A as de}from"../chunks/1oTWFNcQ.js";import"../chunks/DZOxPCae.js";import{p as he}from"../chunks/FZk1iL-Z.js";import{r as _t}from"../chunks/Cbydd1_z.js";import{a as me,g as fe}from"../chunks/HhvvIgyN.js";import{S as ve}from"../chunks/Dyi-qQae.js";import{a as ge}from"../chunks/D67hooA8.js";import{a as Rt}from"../chunks/DXC1p2cl.js";function pe(n){const t=new Map;return n.forEach(o=>{const c=o.annotation_label.annotation_label_name;c&&t.set(c,(t.get(c)||0)+1)}),t}var _e=H("<div><!></div>");function qt(n,t){nt(t,!0);var o=_e(),c=w(o);vt(c,()=>t.children),y(o),tt(f=>Ct(o,1,f),[()=>Dt(Nt("rounded-lg border border-gray-800 bg-black",t.className))]),T(n,o),at()}var ye=H("<div><!></div>");function Kt(n,t){nt(t,!0);var o=ye(),c=w(o);vt(c,()=>t.children),y(o),tt(f=>Ct(o,1,f),[()=>Dt(Nt("p-4",t.className))]),T(n,o),at()}function xe(n,t){nt(t,!0);let o=It(t,["$$slots","$$events","$$legacy"]);Gt(n,Pt({name:"move-left"},()=>o,{iconNode:[["path",{d:"M6 8L2 12L6 16"}],["path",{d:"M2 12H22"}]],children:(f,v)=>{var d=bt(),x=rt(d);vt(x,()=>t.children??Et),T(f,d)},$$slots:{default:!0}})),at()}function be(n,t){nt(t,!0);let o=It(t,["$$slots","$$events","$$legacy"]);Gt(n,Pt({name:"zoom-in"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(f,v)=>{var d=bt(),x=rt(d);vt(x,()=>t.children??Et),T(f,d)},$$slots:{default:!0}})),at()}function we(n,t){nt(t,!0);let o=It(t,["$$slots","$$events","$$legacy"]);Gt(n,Pt({name:"zoom-out"},()=>o,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11"}]],children:(f,v)=>{var d=bt(),x=rt(d);vt(x,()=>t.children??Et),T(f,d)},$$slots:{default:!0}})),at()}var ze=H('<div class="h-full w-full overflow-hidden"><div class="sample relative h-full w-full"><div class="absolute right-4 top-2 z-30"><!></div> <!></div></div>'),Se=H('<div class="flex h-full w-full flex-col space-y-4"><div class="flex w-full items-center space-x-4"><!> <h2 data-testid="sample-filename" class="text-xl font-semibold tracking-tight"> </h2></div> <!> <div class="flex min-h-0 flex-1 gap-4"><div class="flex-1"><!></div> <div class="relative w-[375px]"><!></div></div></div>');function Me(n,t){nt(t,!0);const[o,c]=Ft(),f=()=>ht(b,"$lastGridType",o),v=()=>ht(O,"$selectedSampleAnnotationCropIds",o),d=()=>ht(z,"$selectedSampleIds",o),x=()=>ht(R,"$isHidden",o),_=J(()=>{const l=he.data.annotationId;if(l)return t.sample.annotations.find(g=>g.annotation_id===l)}),{lastGridType:b,selectedSampleIds:z,toggleSampleSelection:q,toggleSampleAnnotationCropSelection:A,selectedSampleAnnotationCropIds:O,getDatasetVersion:W}=ae(),{isHidden:R,handleKeyEvent:I}=me(),{getKeyboardShortcuts:h}=oe();let E=it(""),P=it(!0);const Y=()=>{var l;(l=t.sample)!=null&&l.dataset_id?Ot(f()==="samples"?_t.toSamples(t.sample.dataset_id):_t.toAnnotations(t.sample.dataset_id)):Ot("/")},Z=l=>{l.key===h.go_back&&Y(),I(l)};Yt(async()=>{var l;(l=t.sample)!=null&&l.dataset_id&&Q(E,ot(await W(t.sample.dataset_id))),window.addEventListener("keydown",Z),window.addEventListener("keyup",I)}),te(()=>{window.removeEventListener("keydown",Z),window.removeEventListener("keyup",I)});const G=()=>{Q(P,!r(P))},B=J(()=>!!r(_));var p=Se(),D=w(p),S=w(D);const L=J(()=>f()==="samples"?_t.toSamples(t.sample.dataset_id):_t.toAnnotations(t.sample.dataset_id));xt(S,{variant:"outline",get href(){return r(L)},children:(l,g)=>{xe(l,{})},$$slots:{default:!0}});var V=N(S,2),C=w(V);y(V),y(D);var e=N(D,2);Xt(e,{class:"mb-4 bg-border-hard"});var i=N(e,2),a=w(i),s=w(a);qt(s,{className:"h-full",children:(l,g)=>{Kt(l,{className:"h-full",children:(M,F)=>{var k=ze(),X=w(k),K=w(X),U=w(K);{var j=lt=>{const wt=J(()=>v().has(r(_).annotation_id));Rt(lt,{onSelect:()=>A(r(_).annotation_id),get isSelected(){return r(wt)}})},ct=lt=>{const wt=J(()=>d().has(t.sample.sample_id));Rt(lt,{onSelect:()=>q(t.sample.sample_id),get isSelected(){return r(wt)}})};ut(U,lt=>{r(B)&&r(_)?lt(j):lt(ct,!1)})}y(K);var Ut=N(K,2);const jt=J(()=>`${Jt+t.sample.file_path_abs}${r(E)?`?v=${r(E)}`:""}`);Fe(Ut,{get imageURL(){return r(jt)},get annotations(){return t.sample.annotations},get imageWidth(){return t.sample.width},get imageHeight(){return t.sample.height},get showOnlySelectedAnnotation(){return r(P)},get selectedAnnotation(){return r(_)},get hideAnnotations(){return x()}}),y(X),y(k),T(M,k)},$$slots:{default:!0}})},$$slots:{default:!0}}),y(a);var u=N(a,2),m=w(u);en(m,{get sample(){return t.sample},get selectedAnnotation(){return r(_)},get showOnlySelectedAnnotation(){return r(P)},toggleShowOnlySelectedAnnotation:G}),y(u),y(i),y(p),tt(()=>et(C,`Filename: "${t.sample.file_name??""}"`)),T(n,p),at(),c()}function $(n){return typeof n=="string"?new At([[document.querySelector(n)]],[document.documentElement]):new At([[n]],ie)}function Ae(n){let t;for(;t=n.sourceEvent;)n=t;return n}function st(n,t){if(n=Ae(n),t===void 0&&(t=n.currentTarget),t){var o=t.ownerSVGElement||t;if(o.createSVGPoint){var c=o.createSVGPoint();return c.x=n.clientX,c.y=n.clientY,c=c.matrixTransform(t.getScreenCTM().inverse()),[c.x,c.y]}if(t.getBoundingClientRect){var f=t.getBoundingClientRect();return[n.clientX-f.left-t.clientLeft,n.clientY-f.top-t.clientTop]}}return[n.pageX,n.pageY]}function ke(n){return new At([document.querySelectorAll(n)],[document.documentElement])}const kt={capture:!0,passive:!1};function Tt(n){n.preventDefault(),n.stopImmediatePropagation()}function Te(n){var t=n.document.documentElement,o=$(n).on("dragstart.drag",Tt,kt);"onselectstart"in t?o.on("selectstart.drag",Tt,kt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ee(n,t){var o=n.document.documentElement,c=$(n).on("dragstart.drag",null);t&&(c.on("click.drag",Tt,kt),setTimeout(function(){c.on("click.drag",null)},0)),"onselectstart"in o?c.on("selectstart.drag",null):(o.style.MozUserSelect=o.__noselect,delete o.__noselect)}var Pe=1e-12;function Vt(n){return((n=Math.exp(n))+1/n)/2}function Ie(n){return((n=Math.exp(n))-1/n)/2}function De(n){return((n=Math.exp(2*n))-1)/(n+1)}const Ne=function n(t,o,c){function f(v,d){var x=v[0],_=v[1],b=v[2],z=d[0],q=d[1],A=d[2],O=z-x,W=q-_,R=O*O+W*W,I,h;if(R<Pe)h=Math.log(A/b)/t,I=function(B){return[x+B*O,_+B*W,b*Math.exp(t*B*h)]};else{var E=Math.sqrt(R),P=(A*A-b*b+c*R)/(2*b*o*E),Y=(A*A-b*b-c*R)/(2*A*o*E),Z=Math.log(Math.sqrt(P*P+1)-P),G=Math.log(Math.sqrt(Y*Y+1)-Y);h=(G-Z)/t,I=function(B){var p=B*h,D=Vt(Z),S=b/(o*E)*(D*De(t*p+Z)-Ie(Z));return[x+S*O,_+S*W,b*D/Vt(t*p+Z)]}}return I.duration=h*1e3*t/Math.SQRT2,I}return f.rho=function(v){var d=Math.max(.001,+v),x=d*d,_=x*x;return n(d,x,_)},f}(Math.SQRT2,2,4),yt=n=>()=>n;function Ce(n,{sourceEvent:t,target:o,transform:c,dispatch:f}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},transform:{value:c,enumerable:!0,configurable:!0},_:{value:f}})}function Mt(n){n.stopImmediatePropagation()}function dt(n){n.preventDefault(),n.stopImmediatePropagation()}function Ge(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function He(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function Wt(){return this.__zoom||Ht}function Oe(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function Ze(){return navigator.maxTouchPoints||"ontouchstart"in this}function Be(n,t,o){var c=n.invertX(t[0][0])-o[0][0],f=n.invertX(t[1][0])-o[1][0],v=n.invertY(t[0][1])-o[0][1],d=n.invertY(t[1][1])-o[1][1];return n.translate(f>c?(c+f)/2:Math.min(0,c)||Math.max(0,f),d>v?(v+d)/2:Math.min(0,v)||Math.max(0,d))}function Le(){var n=Ge,t=He,o=Be,c=Oe,f=Ze,v=[0,1/0],d=[[-1/0,-1/0],[1/0,1/0]],x=250,_=Ne,b=se("start","zoom","end"),z,q,A,O=500,W=150,R=0,I=10;function h(e){e.property("__zoom",Wt).on("wheel.zoom",p,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",S).filter(f).on("touchstart.zoom",L).on("touchmove.zoom",V).on("touchend.zoom touchcancel.zoom",C).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.transform=function(e,i,a,s){var u=e.selection?e.selection():e;u.property("__zoom",Wt),e!==u?Z(e,i,a,s):u.interrupt().each(function(){G(this,arguments).event(s).start().zoom(null,typeof i=="function"?i.apply(this,arguments):i).end()})},h.scaleBy=function(e,i,a,s){h.scaleTo(e,function(){var u=this.__zoom.k,m=typeof i=="function"?i.apply(this,arguments):i;return u*m},a,s)},h.scaleTo=function(e,i,a,s){h.transform(e,function(){var u=t.apply(this,arguments),m=this.__zoom,l=a==null?Y(u):typeof a=="function"?a.apply(this,arguments):a,g=m.invert(l),M=typeof i=="function"?i.apply(this,arguments):i;return o(P(E(m,M),l,g),u,d)},a,s)},h.translateBy=function(e,i,a,s){h.transform(e,function(){return o(this.__zoom.translate(typeof i=="function"?i.apply(this,arguments):i,typeof a=="function"?a.apply(this,arguments):a),t.apply(this,arguments),d)},null,s)},h.translateTo=function(e,i,a,s,u){h.transform(e,function(){var m=t.apply(this,arguments),l=this.__zoom,g=s==null?Y(m):typeof s=="function"?s.apply(this,arguments):s;return o(Ht.translate(g[0],g[1]).scale(l.k).translate(typeof i=="function"?-i.apply(this,arguments):-i,typeof a=="function"?-a.apply(this,arguments):-a),m,d)},s,u)};function E(e,i){return i=Math.max(v[0],Math.min(v[1],i)),i===e.k?e:new zt(i,e.x,e.y)}function P(e,i,a){var s=i[0]-a[0]*e.k,u=i[1]-a[1]*e.k;return s===e.x&&u===e.y?e:new zt(e.k,s,u)}function Y(e){return[(+e[0][0]+ +e[1][0])/2,(+e[0][1]+ +e[1][1])/2]}function Z(e,i,a,s){e.on("start.zoom",function(){G(this,arguments).event(s).start()}).on("interrupt.zoom end.zoom",function(){G(this,arguments).event(s).end()}).tween("zoom",function(){var u=this,m=arguments,l=G(u,m).event(s),g=t.apply(u,m),M=a==null?Y(g):typeof a=="function"?a.apply(u,m):a,F=Math.max(g[1][0]-g[0][0],g[1][1]-g[0][1]),k=u.__zoom,X=typeof i=="function"?i.apply(u,m):i,K=_(k.invert(M).concat(F/k.k),X.invert(M).concat(F/X.k));return function(U){if(U===1)U=X;else{var j=K(U),ct=F/j[2];U=new zt(ct,M[0]-j[0]*ct,M[1]-j[1]*ct)}l.zoom(null,U)}})}function G(e,i,a){return!a&&e.__zooming||new B(e,i)}function B(e,i){this.that=e,this.args=i,this.active=0,this.sourceEvent=null,this.extent=t.apply(e,i),this.taps=0}B.prototype={event:function(e){return e&&(this.sourceEvent=e),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(e,i){return this.mouse&&e!=="mouse"&&(this.mouse[1]=i.invert(this.mouse[0])),this.touch0&&e!=="touch"&&(this.touch0[1]=i.invert(this.touch0[0])),this.touch1&&e!=="touch"&&(this.touch1[1]=i.invert(this.touch1[0])),this.that.__zoom=i,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(e){var i=$(this.that).datum();b.call(e,this.that,new Ce(e,{sourceEvent:this.sourceEvent,target:h,transform:this.that.__zoom,dispatch:b}),i)}};function p(e,...i){if(!n.apply(this,arguments))return;var a=G(this,i).event(e),s=this.__zoom,u=Math.max(v[0],Math.min(v[1],s.k*Math.pow(2,c.apply(this,arguments)))),m=st(e);if(a.wheel)(a.mouse[0][0]!==m[0]||a.mouse[0][1]!==m[1])&&(a.mouse[1]=s.invert(a.mouse[0]=m)),clearTimeout(a.wheel);else{if(s.k===u)return;a.mouse=[m,s.invert(m)],St(this),a.start()}dt(e),a.wheel=setTimeout(l,W),a.zoom("mouse",o(P(E(s,u),a.mouse[0],a.mouse[1]),a.extent,d));function l(){a.wheel=null,a.end()}}function D(e,...i){if(A||!n.apply(this,arguments))return;var a=e.currentTarget,s=G(this,i,!0).event(e),u=$(e.view).on("mousemove.zoom",M,!0).on("mouseup.zoom",F,!0),m=st(e,a),l=e.clientX,g=e.clientY;Te(e.view),Mt(e),s.mouse=[m,this.__zoom.invert(m)],St(this),s.start();function M(k){if(dt(k),!s.moved){var X=k.clientX-l,K=k.clientY-g;s.moved=X*X+K*K>R}s.event(k).zoom("mouse",o(P(s.that.__zoom,s.mouse[0]=st(k,a),s.mouse[1]),s.extent,d))}function F(k){u.on("mousemove.zoom mouseup.zoom",null),Ee(k.view,s.moved),dt(k),s.event(k).end()}}function S(e,...i){if(n.apply(this,arguments)){var a=this.__zoom,s=st(e.changedTouches?e.changedTouches[0]:e,this),u=a.invert(s),m=a.k*(e.shiftKey?.5:2),l=o(P(E(a,m),s,u),t.apply(this,i),d);dt(e),x>0?$(this).transition().duration(x).call(Z,l,s,e):$(this).call(h.transform,l,s,e)}}function L(e,...i){if(n.apply(this,arguments)){var a=e.touches,s=a.length,u=G(this,i,e.changedTouches.length===s).event(e),m,l,g,M;for(Mt(e),l=0;l<s;++l)g=a[l],M=st(g,this),M=[M,this.__zoom.invert(M),g.identifier],u.touch0?!u.touch1&&u.touch0[2]!==M[2]&&(u.touch1=M,u.taps=0):(u.touch0=M,m=!0,u.taps=1+!!z);z&&(z=clearTimeout(z)),m&&(u.taps<2&&(q=M[0],z=setTimeout(function(){z=null},O)),St(this),u.start())}}function V(e,...i){if(this.__zooming){var a=G(this,i).event(e),s=e.changedTouches,u=s.length,m,l,g,M;for(dt(e),m=0;m<u;++m)l=s[m],g=st(l,this),a.touch0&&a.touch0[2]===l.identifier?a.touch0[0]=g:a.touch1&&a.touch1[2]===l.identifier&&(a.touch1[0]=g);if(l=a.that.__zoom,a.touch1){var F=a.touch0[0],k=a.touch0[1],X=a.touch1[0],K=a.touch1[1],U=(U=X[0]-F[0])*U+(U=X[1]-F[1])*U,j=(j=K[0]-k[0])*j+(j=K[1]-k[1])*j;l=E(l,Math.sqrt(U/j)),g=[(F[0]+X[0])/2,(F[1]+X[1])/2],M=[(k[0]+K[0])/2,(k[1]+K[1])/2]}else if(a.touch0)g=a.touch0[0],M=a.touch0[1];else return;a.zoom("touch",o(P(l,g,M),a.extent,d))}}function C(e,...i){if(this.__zooming){var a=G(this,i).event(e),s=e.changedTouches,u=s.length,m,l;for(Mt(e),A&&clearTimeout(A),A=setTimeout(function(){A=null},O),m=0;m<u;++m)l=s[m],a.touch0&&a.touch0[2]===l.identifier?delete a.touch0:a.touch1&&a.touch1[2]===l.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),a.taps===2&&(l=st(l,this),Math.hypot(q[0]-l[0],q[1]-l[1])<I)){var g=$(this).on("dblclick.zoom");g&&g.apply(this,arguments)}}}return h.wheelDelta=function(e){return arguments.length?(c=typeof e=="function"?e:yt(+e),h):c},h.filter=function(e){return arguments.length?(n=typeof e=="function"?e:yt(!!e),h):n},h.touchable=function(e){return arguments.length?(f=typeof e=="function"?e:yt(!!e),h):f},h.extent=function(e){return arguments.length?(t=typeof e=="function"?e:yt([[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]]),h):t},h.scaleExtent=function(e){return arguments.length?(v[0]=+e[0],v[1]=+e[1],h):[v[0],v[1]]},h.translateExtent=function(e){return arguments.length?(d[0][0]=+e[0][0],d[1][0]=+e[1][0],d[0][1]=+e[0][1],d[1][1]=+e[1][1],h):[[d[0][0],d[0][1]],[d[1][0],d[1][1]]]},h.constrain=function(e){return arguments.length?(o=e,h):o},h.duration=function(e){return arguments.length?(x=+e,h):x},h.interpolate=function(e){return arguments.length?(_=e,h):_},h.on=function(){var e=b.on.apply(b,arguments);return e===b?h:e},h.clickDistance=function(e){return arguments.length?(R=(e=+e)*e,h):Math.sqrt(R)},h.tapDistance=function(e){return arguments.length?(I=+e,h):I},h}function Re(n,t){let o=n.scaleIndependentXForm;o||(o=n.scaleIndependentXForm=t.createSVGTransform(),n.transform.baseVal.appendItem(o));const c=n.parentNode;if(c){const f=c.getScreenCTM();if(f){const v=f.inverse().multiply(t.getScreenCTM());v.e=v.f=0,o.setMatrix(v)}}}var Ve=H('<div class="pointer-events-auto absolute bottom-0 left-1 z-20 flex select-none items-center gap-1 rounded-lg bg-muted bg-opacity-80 shadow-md backdrop-blur-sm"><!> <div class="h-6 w-px bg-white bg-opacity-20"></div> <!> <div class="w-[32px] text-center text-sm text-muted-foreground" data-testid="zoom-level"> </div> <!></div>');function We(n,t){var o=Ve(),c=w(o);xt(c,{variant:"ghost","data-testid":"zoom-reset",size:"sm",get onclick(){return t.onZoomReset},get disabled(){return t.isResetDisabled},children:(_,b)=>{ee();var z=$t("Reset");T(_,z)},$$slots:{default:!0}});var f=N(c,4);xt(f,{title:"zoom out",variant:"ghost",size:"icon","data-testid":"zoom-out",get onclick(){return t.onZoomOut},get disabled(){return t.isZoominDisabled},children:(_,b)=>{we(_,{class:"h-4 w-4"})},$$slots:{default:!0}});var v=N(f,2),d=w(v);y(v);var x=N(v,2);xt(x,{title:"zoom in",variant:"ghost",size:"icon","data-testid":"zoom-in",get onclick(){return t.onZoomIn},get disabled(){return t.isZoomoutDisabled},children:(_,b)=>{be(_,{class:"h-4 w-4"})},$$slots:{default:!0}}),y(o),tt(_=>et(d,`${_??""}%`),[()=>Math.round(t.scale*100)]),T(n,o)}var Ye=H('<div class="relative flex h-full w-full select-none items-center justify-center"><!> <svg class="z-10 h-full w-full cursor-grab" preserveAspectRatio="xMidYMid meet"><g><image></image><!></g></svg> <svg class="pointer-events-none absolute inset-0" preserveAspectRatio="xMidYMid meet"></svg></div>');function Fe(n,t){nt(t,!0);let o=it(null),c=it(null);const f=ne(t,"hideAnnotations",3,!1);let v=it(800),d=it(600);Zt(()=>{if(!r(o))return;Q(v,ot(r(o).clientWidth)),Q(d,ot(r(o).clientHeight));const p=new ResizeObserver(()=>{r(o)&&(Q(v,ot(r(o).clientWidth)),Q(d,ot(r(o).clientHeight)))});return p.observe(r(o)),()=>p.disconnect()});const x=J(()=>t.selectedAnnotation&&t.showOnlySelectedAnnotation?[t.selectedAnnotation]:t.annotations),_=10,b=J(()=>{const p={x:0,y:0,width:t.imageWidth,height:t.imageHeight};if(t.selectedAnnotation){const{x:D,y:S,width:L,height:V}=t.selectedAnnotation;return{x:Math.round(Math.max(0,D-_)),y:Math.round(Math.max(0,S-_)),width:Math.round(Math.min(t.imageWidth-D,L+_*2)),height:Math.round(Math.min(t.imageHeight-S,V+_*2))}}return p});let z=it(ot({k:1,x:0,y:0}));const q=J(()=>{if(!r(o))return 1;const p=r(v)/t.imageWidth,D=r(d)/t.imageHeight,S=Math.min(p,D);return r(z).k*S});let A=it(null);const O=()=>{r(o)&&(Q(A,ot(Le().on("zoom",p=>{Q(z,ot(p.transform))}).filter(p=>(!p.ctrlKey||p.type==="wheel")&&!p.button&&!(p.type==="mousedown"&&p.button===2)).wheelDelta(p=>-p.deltaY*.002))),$(r(o)).call(r(A)).on("dblclick.zoom",null))},W=p=>{if(!r(o)||!r(A))return;const D=p?1.5:.75;$(r(o)).transition().duration(300).call(r(A).scaleBy,D)},R=()=>{!r(o)||!r(A)||$(r(o)).transition().duration(300).call(r(A).transform,Ht)};Yt(()=>{O()}),Zt(()=>{r(z).k,ke(".unscaled").each(function(){Re(this,r(c))})});var I=Ye(),h=w(I);We(h,{get scale(){return r(q)},onZoomIn:()=>W(!0),onZoomOut:()=>W(!1),onZoomReset:R});var E=N(h,2),P=w(E),Y=w(P),Z=N(Y);{var G=p=>{var D=bt(),S=rt(D);ft(S,17,()=>r(x),L=>L.annotation_id,(L,V)=>{ve(L,{get annotation(){return r(V)},showLabel:!0,get imageWidth(){return t.imageWidth}})}),T(p,D)};ut(Z,p=>{f()||p(G)})}y(P),y(E),Bt(E,p=>Q(o,p),()=>r(o));var B=N(E,2);mt(B,"viewBox","0 0 1024 768"),Bt(B,p=>Q(c,p),()=>r(c)),y(I),tt(()=>{mt(E,"viewBox",`${r(b).x} ${r(b).y} ${r(b).width} ${r(b).height}`),mt(P,"transform",`translate(${r(z).x}, ${r(z).y}) scale(${r(z).k})`),mt(Y,"href",t.imageURL)}),T(n,I),at()}var Xe=H('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),qe=H('<div class="flex flex-col gap-4"><!> <div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div></div>'),Ke=H("<div> </div>"),Ue=H('<div class="flex gap-1"></div>'),je=H('<div class="flex items-center justify-between gap-2 rounded-sm bg-card px-5 py-2"><div class="text-sm"> </div> <div class="text-sm"> </div></div>'),Je=H('<div class="flex flex-col gap-2"></div>'),Qe=H('<span class="text-sm"> </span> <span class="break-all text-sm"> </span>',1),$e=H('<div class="grid grid-cols-[6rem_1fr] gap-y-3 text-diffuse-foreground"></div>'),tn=H('<div class="flex-none"><div class="mb-2.5 text-lg font-semibold">Sample details</div> <!></div> <div class="flex h-full min-h-0 flex-col space-y-2 overflow-y-auto dark:[color-scheme:dark]"><!> <!> <!> <!></div>',1);function en(n,t){nt(t,!0);const[o,c]=Ft(),f=()=>ht(v,"$taskMap",o),{taskMap:v}=re(),d=t.sample.tags,x=pe(t.sample.annotations),_=J(()=>t.selectedAnnotation&&t.selectedAnnotation.annotation_task_id&&f().has(t.selectedAnnotation.annotation_task_id)?f().get(t.selectedAnnotation.annotation_task_id).is_prediction:!1),b=[{label:"Height:",value:gt(t.sample.height)+"px"},{label:"Width:",value:gt(t.sample.width)+"px"},{label:"Filename:",value:t.sample.file_name},{label:"Filepath:",value:t.sample.file_path_abs}],z=J(()=>t.selectedAnnotation?[{label:"Height:",value:gt(Math.round(t.selectedAnnotation.height))+"px"},{label:"Width:",value:gt(Math.round(t.selectedAnnotation.width))+"px"},{label:"Annotation:",value:t.selectedAnnotation.annotation_label.annotation_label_name},{label:"Type:",value:"Bounding box"},{label:"Status:",value:r(_)?"Prediction":"Ground Truth"}]:[]);qt(n,{className:"h-full",children:(q,A)=>{Kt(q,{className:"h-full flex flex-col",children:(O,W)=>{var R=tn(),I=rt(R),h=N(w(I),2);Xt(h,{class:"mb-4 bg-border-hard"}),y(I);var E=N(I,2),P=w(E);{var Y=S=>{pt(S,{title:"Selected annotation",children:(L,V)=>{var C=qe(),e=w(C);ge(e,{name:"show-all",label:"Show only selected annotation",get isChecked(){return t.showOnlySelectedAnnotation},helperText:"Hides other annotations for clarity.",get onCheckedChange(){return t.toggleShowOnlySelectedAnnotation}});var i=N(e,2);ft(i,21,()=>r(z),({label:a,value:s})=>a,(a,s)=>{let u=()=>r(s).label,m=()=>r(s).value;var l=Xe(),g=rt(l),M=w(g,!0);y(g);var F=N(g,2),k=w(F,!0);y(F),tt(()=>{et(M,u()),et(k,m())}),T(a,l)}),y(i),y(C),T(L,C)}})};ut(P,S=>{t.selectedAnnotation&&S(Y)})}var Z=N(P,2);{var G=S=>{pt(S,{title:"Tags",icon:ce,children:(L,V)=>{var C=Ue();ft(C,21,()=>d,Lt,(e,i)=>{var a=Ke(),s=w(a,!0);y(a),tt(u=>{Ct(a,1,u),et(s,r(i).name)},[()=>Dt(Nt("inline rounded-lg bg-card px-2 py-2 text-xs"))]),T(e,a)}),y(C),T(L,C)}})};ut(Z,S=>{d.length>0&&S(G)})}var B=N(Z,2);{var p=S=>{pt(S,{title:"Annotations",children:(L,V)=>{var C=Je();ft(C,21,()=>x,Lt,(e,i)=>{var a=je(),s=w(a),u=w(s,!0);y(s);var m=N(s,2),l=w(m);y(m),y(a),tt(g=>{et(u,r(i)[0]),le(m,`color: ${g??""};`),et(l,`(${r(i)[1]??""})`)},[()=>fe(r(i)[0]).color]),T(e,a)}),y(C),T(L,C)}})};ut(B,S=>{x.size>0&&S(p)})}var D=N(B,2);pt(D,{title:"Metadata",children:(S,L)=>{var V=$e();ft(V,21,()=>b,({label:C,value:e})=>C,(C,e)=>{let i=()=>r(e).label,a=()=>r(e).value;var s=Qe(),u=rt(s),m=w(u,!0);y(u);var l=N(u,2),g=w(l,!0);y(l),tt(()=>{et(m,i()),et(g,a())}),T(C,s)}),y(V),T(S,V)}}),y(E),T(O,R)},$$slots:{default:!0}})},$$slots:{default:!0}}),at(),c()}const nn=async({sample_id:n})=>{const t={data:void 0,error:void 0};try{const o=await Qt.GET("/api/samples/{sample_id}",{params:{path:{sample_id:n}}});if(o.error)throw new Error(JSON.stringify(o.error,null,2));if(!o.data)throw new Error("No data");t.data=o.data}catch(o){t.error="Error loading sample: "+String(o)}return t},an=async({params:n,url:t})=>{const{sample_id:o}=n,{data:c,error:f}=await nn({sample_id:o});return{sample:c,annotationId:t.searchParams.get("annotationId"),error:f}},bn=Object.freeze(Object.defineProperty({__proto__:null,load:an},Symbol.toStringTag,{value:"Module"}));var on=H("<a>Go home</a>"),sn=H('<div class="flex h-full w-full space-x-4 px-4 pb-4"><div class="h-full w-full space-y-6 rounded-[1vw] bg-card p-4"><!></div></div>');function wn(n,t){nt(t,!0);const o=ue(),[c,f]=o;var v=sn(),d=w(v),x=w(d);{var _=z=>{Me(z,{get sample(){return t.data.sample}})},b=z=>{de(z,{title:"Sample not found",children:(q,A)=>{var O=on();tt(W=>mt(O,"href",W),[()=>c("/",void 0)]),T(q,O)}})};ut(x,z=>{t.data.sample?z(_):z(b,!1)})}y(d),y(v),T(n,v),at()}export{wn as component,bn as universal};
