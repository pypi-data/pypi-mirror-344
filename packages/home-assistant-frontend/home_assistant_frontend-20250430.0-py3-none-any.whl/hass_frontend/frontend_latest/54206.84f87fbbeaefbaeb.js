export const __webpack_ids__=["54206"];export const __webpack_modules__={84447:function(o,e,t){var r=t(73742),i=t(27885),s=t(67522),a=t(23533),l=t(7046),n=t(59048),d=t(26292);class c extends i.g{renderOutline(){return this.filled?n.dy`<span class="filled"></span>`:super.renderOutline()}getContainerClasses(){return{...super.getContainerClasses(),active:this.active}}renderPrimaryContent(){return n.dy` <span class="leading icon" aria-hidden="true"> ${this.renderLeadingIcon()} </span> <span class="label">${this.label}</span> <span class="touch"></span> <span class="trailing leading icon" aria-hidden="true"> ${this.renderTrailingIcon()} </span> `}renderTrailingIcon(){return n.dy`<slot name="trailing-icon"></slot>`}constructor(...o){super(...o),this.filled=!1,this.active=!1}}c.styles=[a.W,l.W,s.W,n.iv`:host{--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-surface:var(--primary-text-color);--md-assist-chip-container-shape:var(
          --ha-assist-chip-container-shape,
          16px
        );--md-assist-chip-outline-color:var(--outline-color);--md-assist-chip-label-text-weight:400}.filled{display:flex;pointer-events:none;border-radius:inherit;inset:0;position:absolute;background-color:var(--ha-assist-chip-filled-container-color)}::slotted([slot=icon]),::slotted([slot=trailing-icon]){display:flex;--mdc-icon-size:var(--md-input-chip-icon-size, 18px);font-size:var(--_label-text-size)!important}.trailing.icon ::slotted(*),.trailing.icon svg{margin-inline-end:unset;margin-inline-start:var(--_icon-label-space)}::before{background:var(--ha-assist-chip-container-color,transparent);opacity:var(--ha-assist-chip-container-opacity, 1)}:where(.active)::before{background:var(--ha-assist-chip-active-container-color);opacity:var(--ha-assist-chip-active-container-opacity)}.label{font-family:Roboto,sans-serif}`],(0,r.__decorate)([(0,d.Cb)({type:Boolean,reflect:!0})],c.prototype,"filled",void 0),(0,r.__decorate)([(0,d.Cb)({type:Boolean})],c.prototype,"active",void 0),c=(0,r.__decorate)([(0,d.Mo)("ha-assist-chip")],c)},49986:function(o,e,t){t(2394),t(81738),t(22960);var r=t(73742),i=t(59048),s=t(26292),a=t(31733);class l extends i.oi{render(){return i.dy`<pre class="${(0,a.$)({wrap:!this.wrapDisabled})}"></pre>`}firstUpdated(o){super.firstUpdated(o),this.content&&this.parseTextToColoredPre(this.content)}parseLinesToColoredPre(o,e=!1){for(const t of o)this.parseLineToColoredPre(t,e)}parseLineToColoredPre(o,e=!1){const t=document.createElement("div"),r=/\x1b(?:\[(.*?)[@-~]|\].*?(?:\x07|\x1b\\))/g;let i=0;const s={bold:!1,italic:!1,underline:!1,strikethrough:!1,foregroundColor:null,backgroundColor:null},a=o=>{const e=document.createElement("span");s.bold&&e.classList.add("bold"),s.italic&&e.classList.add("italic"),s.underline&&e.classList.add("underline"),s.strikethrough&&e.classList.add("strikethrough"),null!==s.foregroundColor&&e.classList.add(`fg-${s.foregroundColor}`),null!==s.backgroundColor&&e.classList.add(`bg-${s.backgroundColor}`),e.appendChild(document.createTextNode(o)),t.appendChild(e)};let l;for(;null!==(l=r.exec(o));){const e=l.index,t=o.substring(i,e);t&&a(t),i=e+l[0].length,void 0!==l[1]&&l[1].split(";").forEach((o=>{switch(parseInt(o,10)){case 0:s.bold=!1,s.italic=!1,s.underline=!1,s.strikethrough=!1,s.foregroundColor=null,s.backgroundColor=null;break;case 1:s.bold=!0;break;case 3:s.italic=!0;break;case 4:s.underline=!0;break;case 9:s.strikethrough=!0;break;case 22:s.bold=!1;break;case 23:s.italic=!1;break;case 24:s.underline=!1;break;case 29:s.strikethrough=!1;break;case 30:case 39:s.foregroundColor=null;break;case 31:s.foregroundColor="red";break;case 32:s.foregroundColor="green";break;case 33:s.foregroundColor="yellow";break;case 34:s.foregroundColor="blue";break;case 35:s.foregroundColor="magenta";break;case 36:s.foregroundColor="cyan";break;case 37:s.foregroundColor="white";break;case 40:s.backgroundColor="black";break;case 41:s.backgroundColor="red";break;case 42:s.backgroundColor="green";break;case 43:s.backgroundColor="yellow";break;case 44:s.backgroundColor="blue";break;case 45:s.backgroundColor="magenta";break;case 46:s.backgroundColor="cyan";break;case 47:s.backgroundColor="white";break;case 49:s.backgroundColor=null}}))}const n=o.substring(i);n&&a(n),e?(this._pre?.prepend(t),t.animate([{opacity:0},{opacity:1}],{duration:500})):this._pre?.appendChild(t),this._filter&&this.filterLines(this._filter)}parseTextToColoredPre(o){const e=o.split("\n");for(const o of e)this.parseLineToColoredPre(o)}filterLines(o){this._filter=o;const e=this.shadowRoot?.querySelectorAll("div")||[];let t=0;if(o){const r=[];e.forEach((e=>{if(e.textContent?.toLowerCase().includes(o.toLowerCase())){if(e.style.display="",t++,CSS.highlights&&null!==e.firstChild&&e.textContent){e.querySelectorAll("span").forEach((e=>{const t=e.textContent.toLowerCase(),i=[];let s=0;for(;s<t.length;){const e=t.indexOf(o.toLowerCase(),s);if(-1===e)break;i.push(e),s=e+o.length}i.forEach((t=>{const i=new Range;i.setStart(e.firstChild,t),i.setEnd(e.firstChild,t+o.length),r.push(i)}))}))}}else e.style.display="none"})),CSS.highlights&&CSS.highlights.set("search-results",new Highlight(...r))}else e.forEach((o=>{o.style.display=""})),t=e.length,CSS.highlights&&CSS.highlights.delete("search-results");return!!t}clear(){this._pre&&(this._pre.innerHTML="")}constructor(...o){super(...o),this.wrapDisabled=!1,this._filter=""}}l.styles=i.iv`pre{overflow-x:auto;margin:0}pre.wrap{white-space:pre-wrap;overflow-wrap:break-word}.bold{font-weight:700}.italic{font-style:italic}.underline{text-decoration:underline}.strikethrough{text-decoration:line-through}.underline.strikethrough{text-decoration:underline line-through}.fg-red{color:var(--error-color)}.fg-green{color:var(--success-color)}.fg-yellow{color:var(--warning-color)}.fg-blue{color:var(--info-color)}.fg-magenta{color:#762671}.fg-cyan{color:#2cb5e9}.fg-white{color:#ccc}.bg-black{background-color:#000}.bg-red{background-color:var(--error-color)}.bg-green{background-color:var(--success-color)}.bg-yellow{background-color:var(--warning-color)}.bg-blue{background-color:var(--info-color)}.bg-magenta{background-color:#762671}.bg-cyan{background-color:#2cb5e9}.bg-white{background-color:#ccc}::highlight(search-results){background-color:var(--primary-color);color:var(--text-primary-color)}`,(0,r.__decorate)([(0,s.Cb)()],l.prototype,"content",void 0),(0,r.__decorate)([(0,s.Cb)({type:Boolean,attribute:"wrap-disabled"})],l.prototype,"wrapDisabled",void 0),(0,r.__decorate)([(0,s.IO)("pre")],l.prototype,"_pre",void 0),(0,r.__decorate)([(0,s.SB)()],l.prototype,"_filter",void 0),l=(0,r.__decorate)([(0,s.Mo)("ha-ansi-to-html")],l)},57701:function(o,e,t){var r=t(73742),i=t(66923),s=t(93952),a=t(59048),l=t(26292);class n extends i.i{}n.styles=[s.W,a.iv`:host{--md-divider-color:var(--divider-color)}`],n=(0,r.__decorate)([(0,l.Mo)("ha-md-divider")],n)},92952:function(o,e,t){var r=t(73742),i=t(5798),s=t(15215),a=t(59048),l=t(26292);class n extends i.${}n.styles=[s.W,a.iv`:host{--ha-icon-display:block;--md-sys-color-primary:var(--primary-text-color);--md-sys-color-on-primary:var(--primary-text-color);--md-sys-color-secondary:var(--secondary-text-color);--md-sys-color-surface:var(--card-background-color);--md-sys-color-on-surface:var(--primary-text-color);--md-sys-color-on-surface-variant:var(--secondary-text-color);--md-sys-color-secondary-container:rgba(
          var(--rgb-primary-color),
          0.15
        );--md-sys-color-on-secondary-container:var(--text-primary-color);--mdc-icon-size:16px;--md-sys-color-on-primary-container:var(--primary-text-color);--md-sys-color-on-secondary-container:var(--primary-text-color);--md-menu-item-label-text-font:Roboto,sans-serif}:host(.warning){--md-menu-item-label-text-color:var(--error-color);--md-menu-item-leading-icon-color:var(--error-color)}::slotted([slot=headline]){text-wrap:nowrap}`],(0,r.__decorate)([(0,l.Cb)({attribute:!1})],n.prototype,"clickAction",void 0),n=(0,r.__decorate)([(0,l.Mo)("ha-md-menu-item")],n)},94092:function(o,e,t){var r=t(73742),i=t(19334),s=t(91646),a=t(67419),l=t(59048),n=t(26292);class d extends i.v2{connectedCallback(){super.connectedCallback(),this.addEventListener("close-menu",this._handleCloseMenu)}_handleCloseMenu(o){o.detail.reason.kind===a.GB.KEYDOWN&&o.detail.reason.key===a.KC.ESCAPE||o.detail.initiator.clickAction?.(o.detail.initiator)}}d.styles=[s.W,l.iv`:host{--md-sys-color-surface-container:var(--card-background-color)}`],d=(0,r.__decorate)([(0,n.Mo)("ha-md-menu")],d)},6514:function(o,e,t){t.a(o,(async function(o,r){try{t.r(e),t.d(e,{HaSpinner:()=>c});var i=t(73742),s=t(57780),a=t(86842),l=t(59048),n=t(26292),d=o([s]);s=(d.then?(await d)():d)[0];class c extends s.Z{updated(o){if(super.updated(o),o.has("size"))switch(this.size){case"tiny":this.style.setProperty("--ha-spinner-size","16px");break;case"small":this.style.setProperty("--ha-spinner-size","28px");break;case"medium":this.style.setProperty("--ha-spinner-size","48px");break;case"large":this.style.setProperty("--ha-spinner-size","68px");break;case void 0:this.style.removeProperty("--ha-progress-ring-size")}}}c.styles=[a.Z,l.iv`:host{--indicator-color:var(
          --ha-spinner-indicator-color,
          var(--primary-color)
        );--track-color:var(--ha-spinner-divider-color, var(--divider-color));--track-width:4px;--speed:3.5s;font-size:var(--ha-spinner-size, 48px)}`],(0,i.__decorate)([(0,n.Cb)()],c.prototype,"size",void 0),c=(0,i.__decorate)([(0,n.Mo)("ha-spinner")],c),r()}catch(o){r(o)}}))},74691:function(o,e,t){t.d(e,{G:()=>r,l:()=>i});const r=o=>o.callApi("GET","error_log"),i="/api/error_log"},31021:function(o,e,t){t.d(e,{js:()=>s,rY:()=>i,yd:()=>n,yz:()=>l});t(67886),t(65451),t(46015),t(38334),t(94880),t(75643),t(29761);if(99387==t.j)var r=t(43893);const i=o=>o.data,s=o=>"object"==typeof o?"object"==typeof o.body?o.body.message||"Unknown error, see supervisor logs":o.body||o.message||"Unknown error, see supervisor logs":o,a=new Set([502,503,504]),l=o=>!!(o&&o.status_code&&a.has(o.status_code))||!(!o||!o.message||!o.message.includes("ERR_CONNECTION_CLOSED")&&!o.message.includes("ERR_CONNECTION_RESET")),n=async(o,e)=>(0,r.I)(o.config.version,2021,2,4)?o.callWS({type:"supervisor/api",endpoint:`/${e}/stats`,method:"get"}):i(await o.callApi("GET",`hassio/${e}/stats`))},24789:function(o,e,t){if(t.d(e,{Bq:()=>_,CP:()=>a,KQ:()=>n,Lm:()=>l,NC:()=>c,Ri:()=>h,gM:()=>g,jP:()=>u,lC:()=>s,rM:()=>p,wt:()=>d}),99387==t.j)var r=t(43893);var i=t(31021);const s=async o=>{(0,r.I)(o.config.version,2021,2,4)?await o.callWS({type:"supervisor/api",endpoint:"/supervisor/reload",method:"post"}):await o.callApi("POST","hassio/supervisor/reload")},a=async o=>(0,r.I)(o.config.version,2021,2,4)?o.callWS({type:"supervisor/api",endpoint:"/supervisor/info",method:"get"}):(0,i.rY)(await o.callApi("GET","hassio/supervisor/info")),l=async o=>(0,r.I)(o.config.version,2021,2,4)?o.callWS({type:"supervisor/api",endpoint:"/info",method:"get"}):(0,i.rY)(await o.callApi("GET","hassio/info")),n=async o=>o.callApi("GET","hassio/host/logs/boots"),d=async(o,e)=>o.callApi("GET",`hassio/${e.includes("_")?`addons/${e}`:e}/logs`),c=async(o,e,t,r=0)=>o.callApiRaw("GET",`hassio/${e.includes("_")?`addons/${e}`:e}/logs${0!==r?`/boots/${r}`:""}`,void 0,t?{Range:t}:void 0),h=async(o,e,t,r=100,i=0)=>o.callApiRaw("GET",`hassio/${e.includes("_")?`addons/${e}`:e}/logs${0!==i?`/boots/${i}`:""}/follow?lines=${r}`,void 0,void 0,t),p=async(o,e,t,r,i,s=100,a=0)=>o.callApiRaw("GET",`hassio/${e.includes("_")?`addons/${e}`:e}/logs${0!==a?`/boots/${a}`:""}/follow`,void 0,{Range:`entries=${r}:${i}:${s}`},t),g=o=>`/api/hassio/${o.includes("_")?`addons/${o}`:o}/logs`,_=(o,e,t=0)=>`/api/hassio/${o.includes("_")?`addons/${o}`:o}/logs${0!==t?`/boots/${t}`:""}?lines=${e}`,u=async(o,e)=>{(0,r.I)(o.config.version,2021,2,4)?await o.callWS({type:"supervisor/api",endpoint:"/supervisor/options",method:"post",data:e}):await o.callApi("POST","hassio/supervisor/options",e)}},54625:function(o,e,t){t.a(o,(async function(o,e){try{t(81738),t(94814),t(6989);var r=t(73742),i=t(59048),s=t(31733),a=t(62577),l=t(26292),n=(t(84447),t(12942),t(49986),t(72953),t(41037),t(31138),t(48017),t(69760),t(57701),t(94092),t(92952),t(6514)),d=(t(993),t(60673)),c=t(37528),h=t(39884),p=t(87639),g=t(74691),_=t(31021),u=t(24789),v=t(71876),b=t(16957),m=o([n]);n=(m.then?(await m)():m)[0];const f="M19.92,12.08L12,20L4.08,12.08L5.5,10.67L11,16.17V2H13V16.17L18.5,10.66L19.92,12.08M12,20H2V22H22V20H12Z",y="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",w="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",C="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z",S="M20,18H4V8H20M20,6H12L10,4H4A2,2 0 0,0 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8A2,2 0 0,0 20,6M15,16H6V14H15V16M18,12H6V10H18V12Z",k="M7,13V11H21V13H7M7,19V17H21V19H7M7,7V5H21V7H7M3,8V5H2V4H4V8H3M2,17V16H5V20H2V19H4V18.5H3V17.5H4V17H2M4.25,10A0.75,0.75 0 0,1 5,10.75C5,10.95 4.92,11.14 4.79,11.27L3.12,13H5V14H2V13.08L4,11H2V10H4.25Z",x="M7,10L12,15L17,10H7Z",L="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z",$="M21,5H3V7H21V5M3,19H10V17H3V19M3,13H18C19,13 20,13.43 20,15C20,16.57 19,17 18,17H16V15L12,18L16,21V19H18C20.95,19 22,17.73 22,15C22,12.28 21,11 18,11H3V13Z",T="M16,7H3V5H16V7M3,19H16V17H3V19M22,12L18,9V11H3V13H18V15L22,12Z",H=100;class A extends i.oi{render(){const o=this._streamSupported&&this.provider&&(0,c.p)(this.hass,"hassio")&&"loading"!==this._loadingState,e=this._streamSupported&&Array.isArray(this._boots),t=this.localizeFunc||this.hass.localize;return i.dy` <div class="error-log-intro"> ${this._error?i.dy`<ha-alert alert-type="error">${this._error}</ha-alert>`:i.Ld} <ha-card outlined> <div class="header"> <h1 class="card-header"> ${this.header||t("ui.panel.config.logs.show_full_logs")} </h1> <div class="action-buttons"> ${e&&this._showBootsSelect?i.dy` <ha-assist-chip .title="${t("ui.panel.config.logs.haos_boots_title")}" .label="${0===this._boot?t("ui.panel.config.logs.current"):-1===this._boot?t("ui.panel.config.logs.previous"):t("ui.panel.config.logs.startups_ago",{boot:-1*this._boot})}" id="boots-anchor" @click="${this._toggleBootsMenu}"> <ha-svg-icon slot="trailing-icon" .path="${x}"></ha-svg-icon></ha-assist-chip> <ha-md-menu anchor="boots-anchor" id="boots-menu" positioning="fixed"> ${this._boots.map((o=>i.dy` <ha-md-menu-item .value="${o}" @click="${this._setBoot}" .selected="${o===this._boot}"> ${0===o?t("ui.panel.config.logs.current"):-1===o?t("ui.panel.config.logs.previous"):t("ui.panel.config.logs.startups_ago",{boot:-1*o})} </ha-md-menu-item> ${0===o?i.dy`<ha-md-divider role="separator"></ha-md-divider>`:i.Ld} `))} </ha-md-menu> `:i.Ld} ${this._downloadSupported?i.dy` <ha-icon-button .path="${C}" @click="${this._downloadLogs}" .label="${t("ui.panel.config.logs.download_logs")}"></ha-icon-button> `:this._logsFileLink?i.dy` <a href="${this._logsFileLink}" target="_blank" class="download-link"> <ha-icon-button .path="${C}" .label="${t("ui.panel.config.logs.download_logs")}"></ha-icon-button> </a> `:i.Ld} <ha-icon-button .path="${this._wrapLines?T:$}" @click="${this._toggleLineWrap}" .label="${t("ui.panel.config.logs."+(this._wrapLines?"full_width":"wrap_lines"))}"></ha-icon-button> ${!o||this._error?i.dy`<ha-icon-button .path="${L}" @click="${this._loadLogs}" .label="${t("ui.common.refresh")}"></ha-icon-button>`:i.Ld} ${this.allowSwitch&&"core"===this.provider||e?i.dy` <ha-button-menu @action="${this._handleOverflowAction}"> <ha-icon-button slot="trigger" .path="${w}"> </ha-icon-button> ${this.allowSwitch&&"core"===this.provider?i.dy`<ha-list-item graphic="icon"> <ha-svg-icon slot="graphic" .path="${S}"></ha-svg-icon> ${this.hass.localize("ui.panel.config.logs.show_condensed_logs")} </ha-list-item>`:i.Ld} ${e?i.dy`<ha-list-item graphic="icon"> <ha-svg-icon slot="graphic" .path="${k}"></ha-svg-icon> ${t(`ui.panel.config.logs.${this._showBootsSelect?"hide":"show"}_haos_boots`)} </ha-list-item>`:i.Ld} </ha-button-menu> `:i.Ld} </div> </div> <div class="card-content error-log"> <div id="scroll-top-marker"></div> ${"loading"===this._loadingPrevState?i.dy`<div class="loading-old"> <ha-spinner></ha-spinner> </div>`:i.Ld} ${"loading"===this._loadingState?i.dy`<div>${t("ui.panel.config.logs.loading_log")}</div>`:"empty"===this._loadingState?i.dy`<div>${t("ui.panel.config.logs.no_errors")}</div>`:i.Ld} ${"loaded"===this._loadingState&&this.filter&&this._noSearchResults?i.dy`<div> ${t("ui.panel.config.logs.no_issues_search",{term:this.filter})} </div>`:i.Ld} <ha-ansi-to-html ?wrap-disabled="${!this._wrapLines}"></ha-ansi-to-html> <div id="scroll-bottom-marker"></div> </div> <ha-button class="new-logs-indicator ${(0,s.$)({visible:this._newLogsIndicator&&!this._scrolledToBottomController.value||!1})}" @click="${this._scrollToBottom}"> <ha-svg-icon .path="${f}" slot="icon"></ha-svg-icon> ${t("ui.panel.config.logs.scroll_down_button")} <ha-svg-icon .path="${f}" slot="trailingIcon"></ha-svg-icon> </ha-button> ${o&&0===this._boot&&!this._error?i.dy`<div class="live-indicator"> <ha-svg-icon path="${y}"></ha-svg-icon> Live </div>`:i.Ld} </ha-card> </div> `}willUpdate(o){super.willUpdate(o),this.hasUpdated||(this._downloadSupported=(0,v.G)(this.hass),this._streamSupported=!0,this._loadBoots(),window.addEventListener("connection-status",this._handleConnectionStatus),this.hass.loadFragmentTranslation("config")),o.has("provider")&&(this._boot=0,this._loadLogs())}firstUpdated(o){super.firstUpdated(o),this._scrolledToBottomController.observe(this._scrollBottomMarkerElement),this._scrolledToTopController.callback=this._handleTopScroll,this._scrolledToTopController.observe(this._scrollTopMarkerElement)}updated(o){super.updated(o),this._newLogsIndicator&&this._scrolledToBottomController.value&&(this._newLogsIndicator=!1),o.has("filter")&&this._debounceSearch(),o.has("_loadingState")&&"loaded"===this._loadingState&&this._scrolledToTopController.value&&this._firstCursor&&!this._loadingPrevState&&this._loadMoreLogs()}disconnectedCallback(){super.disconnectedCallback(),this._logStreamAborter&&this._logStreamAborter.abort(),window.removeEventListener("connection-status",this._handleConnectionStatus)}async _downloadLogs(){if(this._streamSupported&&this.provider)(0,b.X)(this,{header:this.header,provider:this.provider,defaultLineCount:this._numberOfLines,boot:this._boot});else{const o=(new Date).toISOString().replace(/:/g,"-"),e=this.provider&&"core"!==this.provider?(0,u.gM)(this.provider):g.l,t=this.provider&&"core"!==this.provider?`${this.provider}_${o}.log`:`home-assistant_${o}.log`,r=await(0,d.iI)(this.hass,e);(0,v.N)(r.path,t)}}async _loadLogs(o=!1){this._error=void 0,this._loadingState="loading",this._numberOfLines=o?this._numberOfLines??0:0,o||(this._loadingPrevState=void 0,this._firstCursor=void 0,this._ansiToHtmlElement?.clear());const e=this._streamSupported&&(0,c.p)(this.hass,"hassio")&&this.provider;try{if(this._logStreamAborter&&(this._logStreamAborter.abort(),this._logStreamAborter=void 0),e){if(this._logStreamAborter=new AbortController,!o){const o=await(0,u.NC)(this.hass,this.provider,"entries=:-1:",this._boot);(await o.text()).trim()||(this._loadingState="empty")}let e;if(e=o&&this._firstCursor?await(0,u.rM)(this.hass,this.provider,this._logStreamAborter.signal,this._firstCursor,this._numberOfLines,H,this._boot):await(0,u.Ri)(this.hass,this.provider,this._logStreamAborter.signal,H,this._boot),e.headers.has("X-First-Cursor")&&(this._firstCursor=e.headers.get("X-First-Cursor")),!e.body)throw new Error("No stream body found");this._loadingState="empty";let t="";const r=e.body.getReader(),i=new TextDecoder;let s=!1;for(;!s;){const{value:e,done:a}=await r.read();if(s=a,e){const r=i.decode(e,{stream:!s}),a=this._scrolledToBottomController.value,l=`${t}${r}`.split("\n").filter((o=>""!==o.trim()));if(t=r.endsWith("\n")?"":l.splice(-1,1)[0],l.length&&(this._ansiToHtmlElement?.parseLinesToColoredPre(l),this._numberOfLines+=l.length,"empty"===this._loadingState&&setTimeout((()=>{this._loadingState="loaded"}),100)),a&&this._logElement?this._scrollToBottom():this._newLogsIndicator=!0,!this._downloadSupported){const o=(0,u.Bq)(this.provider,this._numberOfLines,this._boot);(0,d.iI)(this.hass,o).then((o=>{this._logsFileLink=o.path}))}o=!1}}}else{this._streamSupported=!1;let o="";o=(0,c.p)(this.hass,"hassio")&&this.provider?await(0,u.wt)(this.hass,this.provider):await(0,g.G)(this.hass),o&&(this._ansiToHtmlElement?.parseTextToColoredPre(o),this._loadingState="loaded",this._scrollToBottom())}}catch(t){if("AbortError"===t.name)return;if(!o&&e)return void this._loadLogs(!0);this._error=(this.localizeFunc||this.hass.localize)("ui.panel.config.logs.failed_get_logs",{provider:this.provider,error:(0,_.js)(t)})}}_scrollToBottom(){this._logElement&&(this._newLogsIndicator=!1,"core"!==this.provider?this._logElement.scrollTo(0,this._logElement.scrollHeight):this._debounceScrollToBottom())}async _loadMoreLogs(){if(!this._firstCursor||"loading"===this._loadingPrevState||"loaded"!==this._loadingState||!this._logElement||!this.provider)return;const o=this._scrolledToBottomController.value,e=this._logElement.scrollHeight-this._logElement.scrollTop;this._loadingPrevState="loading";const t=await(0,u.NC)(this.hass,this.provider,`entries=${this._firstCursor}:-100:100`,this._boot);if(t.headers.has("X-First-Cursor")){if(this._firstCursor===t.headers.get("X-First-Cursor"))return void(this._loadingPrevState="end");this._firstCursor=t.headers.get("X-First-Cursor")}const r=await t.text();if(r){const o=r.split("\n").filter((o=>""!==o.trim())).reverse();this._ansiToHtmlElement?.parseLinesToColoredPre(o,!0),this._numberOfLines+=o.length,this._loadingPrevState="loaded"}else this._loadingPrevState="end";o?this._scrollToBottom():"end"!==this._loadingPrevState&&this._logElement&&window.requestAnimationFrame((()=>{this._logElement.scrollTop=this._logElement.scrollHeight-e}))}async _loadBoots(){if(this._streamSupported&&(0,c.p)(this.hass,"hassio"))try{const{data:o}=await(0,u.KQ)(this.hass),e=Object.keys(o.boots).map(Number).sort(((o,e)=>e-o));e.length>1&&(this._boots=e)}catch(o){console.error(o)}}_toggleLineWrap(){this._wrapLines=!this._wrapLines}_handleOverflowAction(o){let e=o.detail.index;switch("core"===this.provider&&e--,e){case-1:(0,h.B)(this,"switch-log-view");break;case 0:this._showBootsSelect=!this._showBootsSelect}}_toggleBootsMenu(){this._bootsMenu&&(this._bootsMenu.open=!this._bootsMenu.open)}_setBoot(o){this._boot=o.target.value,this._loadLogs()}constructor(...o){super(...o),this.filter="",this.allowSwitch=!1,this._scrolledToBottomController=new a.r(this,{callback:o=>o[0].isIntersecting}),this._scrolledToTopController=new a.r(this,{}),this._loadingState="loading",this._noSearchResults=!1,this._boot=0,this._showBootsSelect=!1,this._wrapLines=!0,this._debounceSearch=(0,p.D)((()=>{this._noSearchResults=!this._ansiToHtmlElement?.filterLines(this.filter),this.filter||this._scrollToBottom()}),150),this._debounceScrollToBottom=(0,p.D)((()=>{this._logElement.scrollTop=this._logElement.scrollHeight}),300),this._handleConnectionStatus=o=>{"disconnected"===o.detail&&this._logStreamAborter&&(this._logStreamAborter.abort(),this._loadingState="loading"),"connected"===o.detail&&this._loadLogs(!0)},this._handleTopScroll=o=>{const e=o[0].isIntersecting;return!this._firstCursor||!e||"loaded"!==this._loadingState||this._loadingPrevState&&"loaded"!==this._loadingPrevState||this.filter||this._loadMoreLogs(),e}}}A.styles=i.iv`:host{direction:var(--direction)}.error-log-intro{text-align:center;margin:16px}ha-card{padding-top:8px;position:relative}ha-card.hidden{display:none}ha-card .action-buttons{display:flex;align-items:center;height:100%}.header{display:flex;justify-content:space-between;padding:0 16px}.card-header{color:var(--ha-card-header-color,var(--primary-text-color));font-family:var(--ha-card-header-font-family, inherit);font-size:var(--ha-card-header-font-size, 24px);letter-spacing:-.012em;line-height:48px;display:block;margin-block-start:0px;font-weight:400;white-space:nowrap;max-width:calc(100% - 150px);overflow:hidden;text-overflow:ellipsis}ha-icon-button{float:right}.error-log{position:relative;font-family:var(--ha-font-family-code);clear:both;text-align:start;padding-top:16px;padding-bottom:16px;overflow-y:scroll;min-height:var(--error-log-card-height,calc(100vh - 240px));max-height:var(--error-log-card-height,calc(100vh - 240px));border-top:1px solid var(--divider-color);direction:ltr}@media all and (max-width:870px){.error-log{min-height:var(--error-log-card-height,calc(100vh - 190px));max-height:var(--error-log-card-height,calc(100vh - 190px))}}.error-log>div{overflow:auto;overflow-wrap:break-word}.error-log>div:hover{background-color:var(--secondary-background-color)}.new-logs-indicator{--mdc-theme-primary:var(--text-primary-color);overflow:hidden;position:absolute;bottom:0;left:0;right:0;height:0;background-color:var(--primary-color);border-radius:8px;transition:height .4s ease-out;display:flex;justify-content:space-between;align-items:center}.new-logs-indicator.visible{height:24px}.error{color:var(--error-color)}.warning{color:var(--warning-color)}.loading-old{display:flex;width:100%;justify-content:center;padding:16px}ha-assist-chip{--ha-assist-chip-container-shape:10px;--md-assist-chip-trailing-space:8px}@keyframes breathe{from{opacity:.8}to{opacity:0}}.live-indicator{position:absolute;bottom:0;inset-inline-end:16px;border-top-right-radius:8px;border-top-left-radius:8px;background-color:var(--primary-color);color:var(--text-primary-color);padding:4px 8px;opacity:.8}.live-indicator ha-svg-icon{animation:breathe 1s cubic-bezier(.5,0,1,1) infinite alternate;height:14px;width:14px}.download-link{color:var(--text-color)}`,(0,r.__decorate)([(0,l.Cb)({attribute:!1})],A.prototype,"hass",void 0),(0,r.__decorate)([(0,l.Cb)({attribute:!1})],A.prototype,"localizeFunc",void 0),(0,r.__decorate)([(0,l.Cb)()],A.prototype,"filter",void 0),(0,r.__decorate)([(0,l.Cb)()],A.prototype,"header",void 0),(0,r.__decorate)([(0,l.Cb)()],A.prototype,"provider",void 0),(0,r.__decorate)([(0,l.Cb)({attribute:"allow-switch",type:Boolean})],A.prototype,"allowSwitch",void 0),(0,r.__decorate)([(0,l.IO)(".error-log")],A.prototype,"_logElement",void 0),(0,r.__decorate)([(0,l.IO)("#scroll-top-marker")],A.prototype,"_scrollTopMarkerElement",void 0),(0,r.__decorate)([(0,l.IO)("#scroll-bottom-marker")],A.prototype,"_scrollBottomMarkerElement",void 0),(0,r.__decorate)([(0,l.IO)("ha-ansi-to-html")],A.prototype,"_ansiToHtmlElement",void 0),(0,r.__decorate)([(0,l.IO)("#boots-menu")],A.prototype,"_bootsMenu",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_firstCursor",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_scrolledToBottomController",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_scrolledToTopController",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_newLogsIndicator",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_error",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_logStreamAborter",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_streamSupported",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_loadingState",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_loadingPrevState",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_noSearchResults",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_numberOfLines",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_boot",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_boots",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_showBootsSelect",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_wrapLines",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_downloadSupported",void 0),(0,r.__decorate)([(0,l.SB)()],A.prototype,"_logsFileLink",void 0),A=(0,r.__decorate)([(0,l.Mo)("error-log-card")],A),e()}catch(o){e(o)}}))},16957:function(o,e,t){t.d(e,{X:()=>i});var r=t(39884);const i=(o,e)=>{(0,r.B)(o,"show-dialog",{dialogTag:"dialog-download-logs",dialogImport:()=>Promise.all([t.e("71353"),t.e("5055"),t.e("35582"),t.e("18972")]).then(t.bind(t,8208)),dialogParams:e})}},71876:function(o,e,t){t.d(e,{N:()=>i,G:()=>s});var r=t(59719);const i=(o,e="")=>{const t=document.createElement("a");t.target="_blank",t.href=o,t.download=e,t.style.display="none",document.body.appendChild(t),t.dispatchEvent(new MouseEvent("click")),document.body.removeChild(t)},s=o=>!(o=>!!o.auth.external&&r.G)(o)||!!o.auth.external?.config.downloadFileSupported},59719:function(o,e,t){t.d(e,{G:()=>r});const r=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}};
//# sourceMappingURL=54206.84f87fbbeaefbaeb.js.map