function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./SharedMoreDropdown-C4Y6Oi-P.js","./index-CNbwmdyR.js","./index-DOkRxd0H.css","./SharedMoreDropdown-BWKlox8E.css","./BuilderEmbeddedCodeEditor-CDgBqpMc.js","./BuilderEmbeddedCodeEditor-DiDqfWdt.css","./BuilderSettings-CPQct-PE.js","./instancePath-BsbOTTI8.js","./useComponentDescription-ohT5g4wJ.js","./marked.esm-273vDTCT.js","./BuilderSettings-Dz3KZKOl.css","./BuilderSidebar-C2S2s5LZ.js","./BuilderSidebar-BLAsr7hk.css","./ComponentRenderer--oa3X2p3.js","./ComponentRenderer-C3SDWCQG.css","./BuilderInstanceTracker-BbFuvTRE.js","./BuilderInstanceTracker-BECcXNnW.css","./BuilderInsertionOverlay-BRTPzG4O.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-CEw0TgC2.js","./BuilderInsertionLabel-_YS5WPfq.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as M,i as z,a as q,r as N,u as re,c as w,o as a,e as v,f as n,y as R,C as W,_ as U,s as P,N as b,O as ge,P as Ce,Q as Ne,R as et,w as Be,n as de,S as he,T as He,U as tt,x,W as G,b as A,t as T,V as Re,X as $,Y as De,l as Te,q as Ie,v as We,H as Oe,I as fe,Z as nt,$ as ve,a0 as qe,a1 as J,a2 as $e,a3 as se,a4 as me,a5 as Me,a6 as at,a7 as ot,a8 as Ve,G as ne,z as H,A as ie,a9 as st,aa as lt,ab as it,ac as Ze,ad as rt,ae as ee,M as te,af as Se,ag as dt,ah as ut,ai as ct,aj as pt,ak as vt,al as mt,D as ft,am as _t,an as yt,ao as Ke}from"./index-CNbwmdyR.js";import{marked as gt}from"./marked.esm-273vDTCT.js";const ht={class:"BuilderSwitcher"},bt=M({__name:"BuilderSwitcher",setup(e){const i=z(q.core),t=z(q.builderManager);let d=N(null);const r=re(i),_=m=>{const p=t.getMode();if(p!=m){switch(d.value=m,m){case"ui":r.track("nav_ui_opened");break;case"preview":r.track("nav_preview_opened");break;case"blueprints":r.track("nav_blueprints_opened");break}t.setMode(m),(m=="preview"||p=="blueprints"||m=="blueprints")&&t.setSelection(null)}},h=w(()=>t.getMode());return(m,p)=>(a(),v("div",ht,[n("button",{"data-automation-action":"set-mode-ui",class:W({active:h.value=="ui"}),type:"button",onClick:p[0]||(p[0]=g=>_("ui"))},p[3]||(p[3]=[n("i",{class:"icon material-symbols-outlined"}," brush ",-1),R(" UI ")]),2),n("button",{"data-automation-action":"set-mode-blueprints",class:W({active:h.value=="blueprints"}),type:"button",onClick:p[1]||(p[1]=g=>_("blueprints"))},p[4]||(p[4]=[n("i",{class:"icon material-symbols-outlined"},"linked_services",-1),R(" Blueprints ")]),2),n("button",{class:W({active:h.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:p[2]||(p[2]=g=>_("preview"))},p[5]||(p[5]=[n("i",{class:"icon material-symbols-outlined"}," preview ",-1),R(" Preview ")]),2)]))}}),wt=U(bt,[["__scopeId","data-v-60f9fbac"]]),kt={class:"BuilderStateExplorer"},Ct=M({__name:"BuilderStateExplorer",setup(e){const i=z(q.core);return(t,d)=>(a(),v("div",kt,[P(ge,{data:b(i).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),Bt=U(Ct,[["__scopeId","data-v-eafb7b97"]]),$t=M({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){return(i,t)=>(a(),v("div",{class:W(["WdsStateDotState",`WdsStateDotState--${e.state}`])},null,2))}}),Ge=U($t,[["__scopeId","data-v-4eacfc04"]]),ye=Ce([]);function Le(){function e(t){ye.value=ye.value.filter(d=>d.id!==t)}function i(t){const d=new Date().getTime();ye.value=[...ye.value,{...t,id:d}],t.closable||setTimeout(()=>e(d),t.delayMs??3e3)}return{pushToast:i,removeToast:e,toasts:Ne(ye)}}function St(e){const i=new AbortController,t=re(e),d=He(),{pushToast:r}=Le(),{writerApi:_,apiBaseUrl:h}=et({signal:i.signal}),m=N(!1),p=Ce(),g=Ce(),C=w(()=>e.writerApplication.value!==void 0),B=w(()=>{var f;return Number((f=e.writerApplication.value)==null?void 0:f.organizationId)||void 0}),s=w(()=>{var f;return(f=e.writerApplication.value)==null?void 0:f.id}),o=w(()=>{var V,E;const f=(E=(V=g.value.writer)==null?void 0:V.teamIds)==null?void 0:E[0];if(!f)return;const I=`/organization/${B.value}/team/${f}/framework/${s.value}`;return new URL(I,h)}),y=w(()=>g.value.lastDeployedAt?new Date(g.value.lastDeployedAt):void 0),u=w(()=>!!(C.value&&g.value)),c=w(()=>{var f;return((f=g.value)==null?void 0:f.status)==="deployed"});Be(e.writerApplication,l,{immediate:!0}),de(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await l()},{signal:i.signal})});async function l(){if(e.writerApplication.value)try{g.value=await _.fetchApplicationDeployment(B.value,s.value)}catch(f){d.error("Failed to fetch deployment information",f),g.value=void 0}}async function k(){if(e.writerApplication.value){if(!c.value){const f=`/aistudio/organization/${B.value}/agent/${s.value}/deploy`,I=new URL(f,h);window.open(I,"_blank");return}m.value=!0,p.value=void 0;try{await _.publishApplication(B.value,s.value,{applicationVersionId:g.value.applicationVersion.id,applicationVersionDataId:g.value.applicationVersionData.id}),await l();const f=o.value?{label:"See it live",func:()=>window.open(o.value,"_blank"),icon:"open_in_new"}:void 0;r({type:"success",message:"agent deployed",action:f}),t.track("deployment_succeeded")}catch(f){t.track("deployment_failed",{error:String(f)}),p.value=f,d.error("Deploy failed",f),r({type:"error",message:"deploy failed"})}finally{m.value=!1}}}return he(()=>i.abort()),{isCloudApp:C,canDeploy:u,hasBeenPublished:c,publishApplication:k,isDeploying:Ne(m),lastDeployedAt:y}}const Dt={class:"BuilderHeader"},Tt={class:"BuilderHeader__toolbar"},It=M({__name:"BuilderHeader",setup(e){const i=z(q.core),t=z(q.builderManager),d=N(!1),r=re(i),{undo:_,redo:h,getUndoRedoSnapshot:m}=De(i,t),{canDeploy:p,isDeploying:g,publishApplication:C,hasBeenPublished:B,lastDeployedAt:s}=St(i),o=w(()=>m()),y=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function u(){r.track("nav_deploy_clicked"),B.value?c.value=!0:await C()}const c=N(!1),l=[{desc:"Cancel",fn:()=>c.value=!1},{desc:"Yes, deploy changes",fn:async()=>{c.value=!1,await C()}}],k=w(()=>s.value?`Editor Last saved ${y.format(s.value)}`:void 0),f=w(()=>B.value===!0?"Deploy changes":(B.value===!1,"Configure deployment")),I=w(()=>{let F="";switch(i.syncHealth.value){case"offline":F+="Offline. Not syncing.";break;case"connected":F+="Online. Syncing...";break;case"idle":F+="Sync not initialised.";break;case"suspended":F+="Sync suspended.";break}return i.featureFlags.value.length>0&&(F+=` Feature flags: ${i.featureFlags.value.join(", ")}`),F}),V=w(()=>{switch(i.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});function E(){r.track("nav_state_explorer_opened"),d.value=!0}return(F,S)=>(a(),v("div",Dt,[S[7]||(S[7]=n("img",{src:tt,alt:"Writer Framework logo"},null,-1)),P(wt),S[8]||(S[8]=n("div",{class:"gap"},null,-1)),n("div",Tt,[P(G,{variant:"secondary",size:"smallIcon","data-automation-key":"undo","data-writer-tooltip":o.value.isUndoAvailable?`Undo: ${o.value.undoDesc}`:"Nothing to undo",disabled:!o.value.isUndoAvailable,"data-writer-tooltip-placement":"bottom",onClick:S[0]||(S[0]=Z=>b(_)())},{default:x(()=>S[3]||(S[3]=[n("i",{class:"material-symbols-outlined"},"undo",-1)])),_:1},8,["data-writer-tooltip","disabled"]),P(G,{variant:"secondary",size:"smallIcon","data-automation-key":"redo","data-writer-tooltip":o.value.isRedoAvailable?`Redo: ${o.value.redoDesc}`:"Nothing to redo",disabled:!o.value.isRedoAvailable,"data-writer-tooltip-placement":"bottom",onClick:S[1]||(S[1]=Z=>b(h)())},{default:x(()=>S[4]||(S[4]=[n("i",{class:"material-symbols-outlined"},"redo",-1)])),_:1},8,["data-writer-tooltip","disabled"]),P(G,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:E},{default:x(()=>S[5]||(S[5]=[n("i",{class:"material-symbols-outlined"},"mystery",-1)])),_:1}),b(p)?(a(),A(G,{key:0,size:"small",loading:b(g),"data-writer-tooltip":k.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:u},{default:x(()=>[R(T(f.value)+" ",1),c.value?(a(),A(Re,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:l},{default:x(()=>S[6]||(S[6]=[n("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):$("",!0)]),_:1},8,["loading","data-writer-tooltip"])):$("",!0),P(Ge,{state:V.value,"data-writer-tooltip":I.value,"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),d.value?(a(),A(Re,{key:1,title:"State Explorer","display-close-button":"",onClose:S[2]||(S[2]=Z=>d.value=!1)},{default:x(()=>[P(Bt)]),_:1})):$("",!0)])]))}}),Lt=U(It,[["__scopeId","data-v-a23195e7"]]),Pt={class:"text"},xt=200,At=4,Ft=M({__name:"BuilderTooltip",setup(e){const i=Te("rootEl"),t=N(!1),d=N(null);let r=null,_=null;const h=N("top"),m=N({top:0,left:0});async function p(){if(!r||(d.value=r.dataset.writerTooltip,!d.value))return;const o=r.dataset.writerTooltipGap?parseInt(r.dataset.writerTooltipGap):At;if(t.value=g(r),!t.value)return;await fe();const{x:y,y:u,width:c,height:l}=r.getBoundingClientRect(),{width:k,height:f}=i.value.getBoundingClientRect();switch(h.value){case"top":m.value.top=u-f-o,m.value.left=y+c/2-k/2;break;case"right":m.value.top=u+l/2-f/2,m.value.left=y+c+o;break;case"left":m.value.left=y-k-o,m.value.top=u+l/2-f/2;break;case"bottom":m.value.top=u+l+o,m.value.left=y+c/2-k/2;break}}function g(o){return o.getAttribute("data-writer-tooltip-strategy")==="overflow"?o.scrollWidth>o.clientWidth:!0}function C(o){const u=o.target.closest("[data-writer-tooltip]");if(u)r!==u&&(t.value=!1);else{t.value=!1,r=null;return}r=u,h.value=r.dataset.writerTooltipPlacement??"top",setTimeout(()=>B(u),xt)}async function B(o){o===r&&(_==null||_.disconnect(),_=new MutationObserver(p),_.observe(r,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),p())}const s=w(()=>{const{top:o,left:y}=m.value;return{top:`${o}px`,left:`${y}px`}});return de(()=>{document.documentElement.addEventListener("mouseover",C)}),he(()=>{document.documentElement.removeEventListener("mouseover",C),_==null||_.disconnect()}),(o,y)=>Ie((a(),v("div",{ref_key:"rootEl",ref:i,class:"BuilderTooltip",style:Oe(s.value)},[n("div",{class:W(["arrow",h.value])},null,2),n("div",Pt,T(d.value),1)],4)),[[We,t.value]])}}),Et=U(Ft,[["__scopeId","data-v-7ba01c7c"]]),Mt={class:"BuilderAsyncLoader"},Rt=M({__name:"BuilderAsyncLoader",setup(e){return(i,t)=>(a(),v("div",Mt,[P(nt)]))}}),le=U(Rt,[["__scopeId","data-v-bb820549"]]),Ut=""+new URL("art-paper-WsD9P5Lu.svg",import.meta.url).href,Wt="data:image/svg+xml,%3csvg%20width='120'%20height='160'%20viewBox='0%200%20120%20160'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='16.0273'%20y='89.9375'%20width='80.1422'%20height='55.209'%20rx='7.12375'%20fill='%23A95EF8'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M47.9297%20135.352H13.3542C9.41988%20135.352%206.23047%20138.541%206.23047%20142.475V152.27C6.23047%20156.205%209.41987%20159.394%2013.3542%20159.394H97.9487C101.883%20159.394%20105.072%20156.205%20105.072%20152.27V142.475C105.072%20138.541%20101.883%20135.352%2097.9487%20135.352H63.3737C63.3737%20136.103%2063.174%20136.848%2062.7859%20137.542C62.3979%20138.237%2061.8291%20138.868%2061.112%20139.399C60.395%20139.931%2059.5437%20140.352%2058.6068%20140.64C57.6699%20140.928%2056.6658%20141.076%2055.6517%20141.076C54.6376%20141.076%2053.6335%20140.928%2052.6966%20140.64C51.7597%20140.352%2050.9085%20139.931%2050.1914%20139.399C49.4744%20138.868%2048.9056%20138.237%2048.5175%20137.542C48.1295%20136.848%2047.9297%20136.103%2047.9297%20135.352Z'%20fill='%23721CC9'/%3e%3crect%20x='27.6055'%20y='103.295'%20width='56.99'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='38.293'%20y='112.199'%20width='35.6187'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='46.3047'%20y='121.104'%20width='19.5903'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20y='10.3691'%20width='40.0647'%20height='30.0485'%20rx='7.12375'%20transform='rotate(-15%200%2010.3691)'%20fill='%23EDE2FF'/%3e%3cpath%20d='M15.0475%2021.5308C15.2249%2020.8687%2016.0526%2020.6469%2016.5373%2021.1316L21.9902%2026.5846C22.475%2027.0693%2022.2532%2027.897%2021.5911%2028.0744L14.1421%2030.0703C13.48%2030.2477%2012.8741%2029.6418%2013.0515%2028.9797L15.0475%2021.5308Z'%20fill='%23D4B2F7'/%3e%3cpath%20d='M25.3727%2010.4659C25.5501%209.80376%2026.3777%209.58199%2026.8624%2010.0667L34.9516%2018.1559C35.4363%2018.6406%2035.2145%2019.4682%2034.5524%2019.6456L23.5024%2022.6065C22.8403%2022.7839%2022.2344%2022.178%2022.4118%2021.5159L25.3727%2010.4659Z'%20fill='%23D4B2F7'/%3e%3crect%20x='68.2383'%20y='23.1523'%20width='54.3186'%20height='40.0711'%20rx='7.12375'%20transform='rotate(17.6282%2068.2383%2023.1523)'%20fill='%23D4B2F7'/%3e%3cpath%20d='M72.1976%2052.7145C71.7609%2052.9406%2071.5902%2053.4779%2071.8163%2053.9146C72.0424%2054.3514%2072.5797%2054.5221%2073.0164%2054.296L72.1976%2052.7145ZM82.1128%2048.5839L82.8321%2048.059L82.3818%2047.4419L81.7034%2047.7931L82.1128%2048.5839ZM86.9945%2055.274L86.2752%2055.7989L86.71%2056.3948L87.3764%2056.0784L86.9945%2055.274ZM104.339%2047.7366C104.504%2047.2733%20104.262%2046.764%20103.798%2046.599L96.2487%2043.9102C95.7854%2043.7452%2095.2761%2043.987%2095.1111%2044.4503C94.9461%2044.9136%2095.1879%2045.4229%2095.6512%2045.5879L102.362%2047.9779L99.972%2054.6888C99.807%2055.1521%20100.049%2055.6614%20100.512%2055.8264C100.975%2055.9914%20101.485%2055.7496%20101.65%2055.2863L104.339%2047.7366ZM73.0164%2054.296L82.5222%2049.3746L81.7034%2047.7931L72.1976%2052.7145L73.0164%2054.296ZM81.3935%2049.1087L86.2752%2055.7989L87.7138%2054.7491L82.8321%2048.059L81.3935%2049.1087ZM87.3764%2056.0784L103.882%2048.2423L103.118%2046.6334L86.6126%2054.4696L87.3764%2056.0784Z'%20fill='%23F6EFFD'/%3e%3c/svg%3e",Ue=150;function Ot(e){const i=N(structuredClone(ve(e.sourceFiles.value)));Be(e.sourceFiles,(l,k)=>{let f=!1,I=structuredClone(ve(i.value));const V=h(k).map(t);for(const E of qe(l)){const F=J(E,k),S=J(E,l);if(me(S))continue;if(F===void 0||$e(S)){I=Me(E,I,structuredClone(ve(S))),f=!0;continue}if(!se(F))continue;const Z=!F.complete&&S.complete,ue=F.complete&&S.complete;if(!Z&&!ue)continue;const ce=t(E);if(V.includes(ce))continue;const ae=J(E,I);se(ae)&&(f=!0,ae.complete=!0,ae.content=S.content)}for(const E of at(I))J(E,l)===void 0&&(I=ot(E,I),f=!0);f&&(i.value=I)});function t(l){return l.join("/")}const d=Ce(),r=w(()=>Array.from(qe(i.value))),_=w(()=>h(e.sourceFiles.value));function h(l){return r.value.filter(k=>{const f=J(k,i.value);if($e(f))return!1;if(!se(f))return!0;const I=J(k,l);return se(I)?!f.complete||!I.complete?!1:f.content!==I.content:!0})}const m=w(()=>{if(d.value!==void 0)return J(d.value,i.value)}),p=w({get(){return se(m.value)?m.value.content:""},set(l){if(d.value===void 0)return;const k=J(d.value,i.value);se(k)&&(k.content=l)}});function g(l=1){const k=`new-file-${l}.txt`;return J([k],i.value)?g(l+1):k}async function C(){const l=g();i.value=Me([l],ve(i.value)),o([l]),await e.sendCreateSourceFileRequest([l])}const B=w(()=>{var k;return(k=d.value)!=null&&k.length?d.value.at(-1).split(".").at(-1):""}),s=w(()=>{switch(B.value){case"py":return"python";case"md":case"markdown":return"markdown";default:return B.value}});function o(l){d.value=l,se(m.value)&&!m.value.complete&&e.requestSourceFileLoading(l)}async function y(l){if(!(!d.value||!m.value)&&(m.value.type==="file"&&await e.sendCodeSaveRequest(p.value,d.value),l)){const k=[...ve(d.value)];d.value=void 0;try{await e.sendRenameSourceFileRequest(k,l)}catch(f){throw d.value=k,f}o(l)}}function u(l){return new Promise((k,f)=>{const I=new FileReader;I.addEventListener("loadend",V=>{const E=V.target.result;if(E instanceof ArrayBuffer){const F=String.fromCharCode.apply(null,new Uint8Array(E));return k(F)}k(E.split(",")[1])}),I.addEventListener("error",()=>{f()}),I.readAsDataURL(l)})}async function c(l){const k=Ue*1024*1024;if(l.size>k)throw Error(`Cannot upload file bigger than ${Ue}mb`);const f=[l.name];if(J(f,e.sourceFiles.value))throw Error(`The file ${l.name} already exists`);i.value=Me(f,ve(i.value),{type:"binary",uploading:!0});const I=await u(l);await e.sendFileUploadRequest(f,I)}return{code:p,sourceFileDraft:i,fileOpen:m,filepathOpen:d,pathsUnsaved:_,openedFileLanguage:s,save:y,upload:c,openFile:o,openNewFile:C,getNewFilename:g}}const zt={class:"BuilderDropFileZone"},qt=M({__name:"BuilderDropFileZone",setup(e){return(i,t)=>(a(),v("div",zt,[t[0]||(t[0]=n("img",{src:Wt,alt:"Drop file illustration"},null,-1)),t[1]||(t[1]=n("h2",null,"Upload files",-1)),n("p",null,"Files can be up to "+T(b(Ue))+"mb",1)]))}}),Vt=U(qt,[["__scopeId","data-v-92e0a561"]]),Kt={class:"BuilderPanel__collapser"},jt={class:"material-symbols-outlined"},Nt={class:"BuilderPanel__title"},Ht={class:"BuilderPanel__titleCompanion"},Zt=["data-order"],Gt={key:0,class:"BuilderPanel__contents__leftPanel"},Yt={class:"BuilderPanel__actions"},Jt={class:"BuilderPanel__actionsCompanion"},Xt={class:"material-symbols-outlined"},Qt={class:"BuilderPanel__mainContents"},en=M({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=z(q.builderManager),d=["code","log"],r=e,_=i,h=w(()=>r.enableDropFile&&m.value),m=N(!1);function p(u,c){r.enableDropFile&&(u.preventDefault(),m.value=c)}function g(u){if(m.value=!1,!r.enableDropFile)return;u.preventDefault();const c=[];if(u.dataTransfer.items)for(const l of u.dataTransfer.items){if(l.kind!=="file")continue;const k=l.getAsFile();k&&c.push(k)}else for(const l of u.dataTransfer.files)c.push(l);c.length>0&&_("filesDrop",c)}const C=w(()=>!t.openPanels.value.has(r.panelId)),B=w(()=>d.indexOf(r.panelId));function s(u){if(t.openPanels.value.has(u)){t.openPanels.value.delete(u),_("openned",!1);return}t.openPanels.value.add(u),_("openned",!0)}function o(u){const c=lt(u);if(c&&u.key==r.keyboardShortcutKey.toLowerCase()){u.preventDefault(),s(r.panelId);return}r.actions.forEach(l=>{if(!l.keyboardShortcut)return;const{key:k,modifierKey:f}=l.keyboardShortcut;k.toLowerCase()==u.key&&(!c&&f||(u.preventDefault(),l.callback()))})}function y(u){if(!u)return"";let c=" (";return u.modifierKey&&(c+=Ve()),c+=u.key,c+=")",c}return de(async()=>{document.addEventListener("keydown",o)}),he(()=>{document.removeEventListener("keydown",o)}),(u,c)=>(a(),v("div",{class:W(["BuilderPanel",{collapsed:C.value}])},[n("div",Kt,[P(G,{variant:"neutral",size:"smallIcon","data-automation-action":"toggle-panel","data-automation-key":u.panelId,"data-writer-tooltip":`Toggle ${u.name} (${b(Ve)()}${u.keyboardShortcutKey})`,onClick:c[0]||(c[0]=l=>s(u.panelId))},{default:x(()=>[n("i",jt,T(C.value?"expand_less":"expand_more"),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),n("div",Nt,T(u.name),1),n("div",Ht,[ne(u.$slots,"titleCompanion",{},void 0,!0)]),C.value?$("",!0):(a(),A(st,{key:0,to:u.contentsTeleportEl},[n("div",{style:Oe({order:B.value}),"data-order":B.value,class:W(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":u.enableLeftPanel,"BuilderPanel__contents--dropingFile":h.value}]),onDrop:g,onDragover:c[1]||(c[1]=l=>p(l,!0)),onDragleave:c[2]||(c[2]=l=>p(l,!1))},[h.value?(a(),A(Vt,{key:0})):(a(),v(H,{key:1},[u.enableLeftPanel?(a(),v("div",Gt,[ne(u.$slots,"leftPanel",{},void 0,!0)])):$("",!0),n("div",Yt,[n("div",Jt,[ne(u.$slots,"actionsCompanion",{},void 0,!0)]),(a(!0),v(H,null,ie(u.actions,(l,k)=>(a(),A(G,{key:k,"data-writer-tooltip":l.name+y(l.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:l.isDisabled,onClick:l.callback},{default:x(()=>[n("i",Xt,T(l.icon),1)]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),n("div",Qt,[ne(u.$slots,"default",{},void 0,!0)])],64))],46,Zt)],8,["to"]))],2))}}),Ye=U(en,[["__scopeId","data-v-a30a0b3d"]]),tn={class:"BuilderTree"},nn=["draggable","data-automation-key","aria-expanded"],an={class:"material-symbols-outlined"},on=["data-writer-tooltip"],sn={key:1,class:"BuilderTree__main__dropdown"},ln={class:"BuilderTree__children"},rn=M({__name:"BuilderTree",props:{name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0}},emits:{expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},setup(e,{expose:i,emit:t}){const d=ee(()=>te(()=>import("./SharedMoreDropdown-C4Y6Oi-P.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),r=e,_=t;i({expand:C,toggleCollapse:B});const h=N(!1),m=N(!1),p=w(()=>!r.matched),g=w(()=>!r.hasChildren);function C(){h.value=!1,_("expandBranch")}function B(s){s??(s=!h.value),s!==h.value&&(h.value=s)}return(s,o)=>(a(),v("div",tn,[n("div",{class:W(["BuilderTree__main",{selected:e.selected,notMatched:p.value,childless:g.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!h.value,onMouseenter:o[2]||(o[2]=y=>m.value=!0),onMouseleave:o[3]||(o[3]=y=>m.value=!1),onClick:o[4]||(o[4]=y=>s.$emit("select",y)),onKeydown:o[5]||(o[5]=Ze(y=>s.$emit("select",y),["enter"])),onDragover:o[6]||(o[6]=y=>s.$emit("dragover",y)),onDragstart:o[7]||(o[7]=y=>s.$emit("dragstart",y)),onDragend:o[8]||(o[8]=y=>s.$emit("dragend",y)),onDrop:o[9]||(o[9]=y=>s.$emit("drop",y))},[e.hasChildren?(a(),A(G,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:o[0]||(o[0]=it(y=>B(void 0),["stop"]))},{default:x(()=>[n("i",an,T(h.value?"expand_more":"expand_less"),1)]),_:1},8,["disabled"])):$("",!0),ne(s.$slots,"nameLeft",{},void 0,!0),n("span",{class:W(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},T(e.name),11,on),ne(s.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&m.value?(a(),v("div",sn,[P(b(d),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:o[1]||(o[1]=y=>s.$emit("dropdownSelect",y))},null,8,["options"])])):$("",!0)],42,nn),P(rt,null,{default:x(()=>[Ie(n("div",ln,[ne(s.$slots,"children",{},void 0,!0)],512),[[We,!h.value&&e.hasChildren]])]),_:3})]))}}),dn=U(rn,[["__scopeId","data-v-fca510f3"]]),un=["width","height","viewBox","aria-valuenow"],cn=["r","cx","cy","stroke","stroke-width"],pn=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],vn=M({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const i=e,t=w(()=>i.sizePx/2),d=w(()=>i.sizePx/2-i.strokeWidth/2),r=w(()=>2*Math.PI*d.value),_=w(()=>r.value*((100-i.progress)/100)),h=w(()=>`0 0 ${i.sizePx} ${i.sizePx}`);return(m,p)=>(a(),v("svg",{width:e.sizePx,height:e.sizePx,viewBox:h.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[n("circle",{r:d.value,cx:t.value,cy:t.value,fill:"transparent",stroke:b(Se).Blue1,"stroke-width":e.strokeWidth},null,8,cn),n("circle",{r:d.value,cx:t.value,cy:t.value,fill:"transparent",stroke:b(Se).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":r.value,"stroke-dashoffset":_.value},null,8,pn)],8,un))}}),mn=M({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const i=e,t=N(0);return de(()=>{let d;const r=_=>{d||(d=_);const h=_-d;t.value=Math.min(h/i.timeMs*100,100),t.value<100&&requestAnimationFrame(r)};requestAnimationFrame(r)}),(d,r)=>(a(),A(vn,{class:"BuilderCodePanelFileUploading",progress:t.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),fn=U(mn,[["__scopeId","data-v-449f2dac"]]),je=[{label:"Delete",value:"delete",icon:"delete"}],_n=M({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:i}){const t=e,d=i;function r(o){return o.join("/")}const _=w(()=>r(t.pathActive)),h=w(()=>t.pathsUnsaved.map(r)),m=w(()=>me(t.sourceFiles)?Object.entries(t.sourceFiles.children).sort((o,y)=>o[0].localeCompare(y[0])):[]);function p(o){const y=J([...t.path,o],t.sourceFiles);return $e(y)&&y.uploading}function g(o){const y=r([...t.path,o]);return h.value.includes(y)}function C(o){return r([...t.path,o])===_.value}function B(o){if(!me(t.sourceFiles)||p(o))return;const y=t.sourceFiles.children[o];me(y)||d("select",[...t.path,o])}function s(o,y){o==="delete"&&d("delete",[...t.path,y])}return(o,y)=>(a(),v("div",null,[(a(!0),v(H,null,ie(m.value,([u,c])=>(a(),A(dn,{key:u,name:u,matched:"","has-children":b(me)(c),selected:C(u),disabled:p(u),"right-click-options":je,"dropdown-options":b(me)(c)||b($e)(c)?je:void 0,onSelect:l=>B(u),onDropdownSelect:l=>s(l,u)},dt({children:x(()=>[P(Je,{"source-files":c,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,u],onSelect:y[0]||(y[0]=l=>o.$emit("select",l)),onDelete:y[1]||(y[1]=l=>o.$emit("delete",l))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[p(u)||g(u)?{name:"nameLeft",fn:x(()=>[p(u)?(a(),A(fn,{key:0,"time-ms":2e3})):g(u)?(a(),A(Ge,{key:1,state:"newDraft"})):$("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),Je=U(_n,[["__scopeId","data-v-42a4456e"]]),yn=["disabled"],gn={key:0,class:"material-symbols-outlined"},hn={class:"WdsButtonLink__text"},bn={key:1,class:"material-symbols-outlined"},wn=M({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disbaled:{type:Boolean}},setup(e){const i=e,t=w(()=>[`WdsButtonLink--variant-${i.variant}`,`WdsButtonLink--weight-${i.weight}`]);return(d,r)=>(a(),v("button",{class:W(["WdsButtonLink",t.value]),disabled:e.disbaled,role:"button"},[e.leftIcon?(a(),v("i",gn,T(e.leftIcon),1)):$("",!0),n("span",hn,T(e.text),1),e.rightIcon?(a(),v("i",bn,T(e.rightIcon),1)):$("",!0)],10,yn))}}),Xe=U(wn,[["__scopeId","data-v-27c92b97"]]),kn={class:"BuilderCodePanelFileUploadBtn"},Cn=M({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=Te("input"),d=i;function r(){var _;(_=t.value.files)!=null&&_.length&&d("selected",t.value.files)}return(_,h)=>(a(),v("form",kn,[Ie(n("input",{ref_key:"input",ref:t,type:"file",multiple:"true",onChange:r},null,544),[[We,!1]]),P(Xe,{"left-icon":"upload",text:"Upload",onClick:h[0]||(h[0]=m=>b(t).click())})]))}}),Bn={class:"BuilderCodePanel__tree"},$n={class:"BuilderCodePanel__tree__actions"},Sn={key:1,class:"BuilderCodePanel__noPreview"},Dn={class:"BuilderCodePanel__actionsCompanion"},Tn=M({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const i=ee(()=>te(()=>import("./SharedMoreDropdown-C4Y6Oi-P.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),t=ee({loader:()=>te(()=>import("./BuilderEmbeddedCodeEditor-CDgBqpMc.js").then(D=>D.a),__vite__mapDeps([4,1,2,5]),import.meta.url),loadingComponent:le}),d=z(q.core),r=[{label:"Rename file",value:"rename",icon:"edit"},{label:"Delete file",value:"delete",icon:"delete"}],_=re(d),{sourceFileDraft:h,openFile:m,upload:p,openNewFile:g,code:C,openedFileLanguage:B,filepathOpen:s,fileOpen:o,pathsUnsaved:y,save:u}=Ot(d);async function c(D){await Promise.all([...D].map(l))}async function l(D){try{await p(D),f({type:"success",message:`File ${D.name} uploaded`})}catch(K){f({type:"error",message:K.message})}}const k=w(()=>{var D;return(D=o.value)==null?void 0:D.type}),{pushToast:f}=Le(),I=He();function V(D){const K=new AbortController;de(()=>{document.addEventListener("keydown",async Y=>{const Ae=Y.metaKey||Y.ctrlKey,Fe=Y.key==="s"||Y.key==="S";!Ae||!Fe||(Y.preventDefault(),await D())},{signal:K.signal})}),he(()=>K.abort())}V(_e);const E=Te("filenameEl"),F=N(""),S=N(!1),Z=w(()=>{var D;return((D=s.value)==null?void 0:D.join("/"))??""}),ue=w(()=>Z.value!=="main.py"),ce=w(()=>Z.value!==F.value),ae=w(()=>S.value||Z.value==="main.py"),be=w(()=>ce.value?!1:s.value===void 0?!0:!y.value.map(D=>D.join("/")).includes(Z.value));Be(s,()=>{var D;F.value=((D=s.value)==null?void 0:D.join("/"))??""}),Be(d.sessionTimestamp,()=>{S.value=!1});function Pe(D){D&&(_.track("nav_code_opened"),s.value===void 0&&m(["main.py"]))}async function we(){var D;Z.value!=="main.py"&&(await fe(),(D=E.value)==null||D.focus())}async function xe(D){switch(D){case"rename":return we();case"delete":await ke(s.value)}}async function Q(){await g(),we()}async function ke(D){await d.sendDeleteSourceFileRequest(D),f({type:"success",message:"The file was deleted"}),s.value.join("/").startsWith(D.join("/"))&&m(["main.py"])}async function _e(){if(s.value===void 0)return f({type:"error",message:"There is no file open"});if(be.value)return f({type:"info",message:"There are not file changes to save"});S.value=!0;try{await u(ce.value?F.value.split("/"):void 0),f({type:"success",message:"The file was saved"}),_.track("nav_code_file_updated",{path:s.value})}catch(D){I.error("The file hasn't been saved.",D),f({type:"error",message:"The file hasn't been saved"});return}finally{S.value=!1}}return(D,K)=>(a(),A(Ye,{"panel-id":"code",name:"Code","contents-teleport-el":D.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"",onFilesDrop:c,onOpenned:Pe},{leftPanel:x(()=>[n("div",Bn,[P(Je,{"path-active":b(s),"paths-unsaved":b(y),"source-files":b(h),onAddFile:Q,onSelect:b(m),onDelete:ke},null,8,["path-active","paths-unsaved","source-files","onSelect"]),n("div",$n,[P(Xe,{"left-icon":"add",text:"Add file",onClick:Q}),P(Cn,{onSelected:c})])])]),actionsCompanion:x(()=>[n("div",Dn,[P(ut,{ref_key:"filenameEl",ref:E,modelValue:F.value,"onUpdate:modelValue":K[1]||(K[1]=Y=>F.value=Y),disabled:!ue.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:Ze(_e,["enter"])},null,8,["modelValue","disabled"]),P(G,{variant:"primary",size:"small",disabled:S.value||be.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:_e},{default:x(()=>K[3]||(K[3]=[n("i",{class:"material-symbols-outlined"},"keyboard_backspace",-1),R(" Save file ")])),_:1},8,["disabled"]),P(b(i),{disabled:ae.value,options:r,onSelect:xe},null,8,["disabled"])])]),default:x(()=>[k.value==="file"?(a(),A(b(t),{key:0,modelValue:b(C),"onUpdate:modelValue":K[0]||(K[0]=Y=>ct(C)?C.value=Y:null),variant:"full",language:b(B),disabled:S.value},null,8,["modelValue","language","disabled"])):$("",!0),k.value==="binary"?(a(),v("div",Sn,K[2]||(K[2]=[n("img",{class:"BuilderCodePanel__noPreview__img",src:Ut},null,-1),n("p",{class:"BuilderCodePanel__noPreview__title"},"Can’t Preview File",-1),n("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):$("",!0)]),_:1},8,["contents-teleport-el"]))}}),In=U(Tn,[["__scopeId","data-v-59d54f01"]]),Ln={class:"BuiderLogBlueprintExecutionTrace"},Pn={key:0,class:"trace"},xn={class:"type"},An={key:0},Fn={key:1},En={class:"main"},Mn={key:0},Rn={key:1},Un={key:2},Wn={key:3},On={class:"details"},zn={class:"data","data-automation-key":"result"},qn={key:1,class:"nothing"},Vn={class:"data","data-automation-key":"return-value"},Kn={class:"environment"},jn={class:"data"},Nn={key:1,class:"nothing"},Hn={class:"callStack"},Zn={class:"eyebrow"},Gn=M({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:i}){const t=z(q.core),d=z(q.builderManager),r=re(t),_=i,{goToComponentParentPage:h}=De(t,d),m=e,p=w(()=>{var s;const B=((s=m.executionItem.executionEnvironment)==null?void 0:s.call_stack)??[];return Object.fromEntries(B.map(o=>[o,t.getComponentById(o)]))}),g=w(()=>{var B;return((B=m.executionItem.executionEnvironment)==null?void 0:B.trace)??[]});de(()=>{r.track("blueprints_logs_trace_opened")});async function C(B){_("closeModal"),d.setMode("blueprints"),await fe(),h(B),await fe(),d.setSelection(B,void 0,"log")}return(B,s)=>{var o,y,u;return a(),v("div",Ln,[g.value.length>0?(a(),v("div",Pn,[(a(!0),v(H,null,ie(g.value,(c,l)=>(a(),v("div",{key:l,class:"traceEntry"},[n("div",xn,[c.type=="functionCall"?(a(),v("span",An,"⚡️")):$("",!0),c.type=="reasoning"?(a(),v("span",Fn,"🧠")):$("",!0)]),n("div",En,[c.thought?(a(),v("div",Mn,[s[0]||(s[0]=n("strong",null,"Thought.",-1)),R(" "+T(c.thought),1)])):$("",!0),c.action?(a(),v("div",Rn,[s[1]||(s[1]=n("strong",null,"Action.",-1)),R(" "+T(c.action),1)])):$("",!0),c.name?(a(),v("div",Un,T(c.name),1)):$("",!0),c.parameters?(a(),v("div",Wn,[P(ge,{"hide-root":!0,data:c.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):$("",!0)])]))),128))])):$("",!0),n("div",On,[n("div",null,[s[2]||(s[2]=n("h3",null,"Result",-1)),s[3]||(s[3]=n("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),n("div",zn,[(o=B.executionItem)!=null&&o.result?(a(),A(ge,{key:0,data:B.executionItem.result,"initial-depth":1,class:"data"},null,8,["data"])):(a(),v("div",qn,"No result."))])]),n("div",null,[s[4]||(s[4]=n("h3",null,"Return value",-1)),s[5]||(s[5]=n("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),n("div",Vn,[(y=B.executionItem)!=null&&y.returnValue?(a(),A(ge,{key:0,data:B.executionItem.returnValue,"initial-depth":1,class:"data"},null,8,["data"])):(a(),v(H,{key:1},[R(" No return value. ")],64))])])]),n("div",Kn,[s[6]||(s[6]=n("h3",null,"Execution environment",-1)),s[7]||(s[7]=n("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),n("div",jn,[(u=B.executionItem)!=null&&u.executionEnvironment?(a(),A(ge,{key:0,data:B.executionItem.executionEnvironment,"initial-depth":1,class:"data"},null,8,["data"])):(a(),v("div",Nn,"Empty execution environment."))])]),n("div",Hn,[s[9]||(s[9]=n("h3",null,"Call stack",-1)),(a(!0),v(H,null,ie(p.value,(c,l)=>{var k,f,I;return a(),v("div",{key:l,class:W(["component",{active:l==B.executionItem.componentId}])},[n("div",null,[n("div",Zn,[l==B.executionItem.componentId?(a(),v(H,{key:0},[R(" This block · ")],64)):$("",!0),R(" "+T(((k=b(t).getComponentDefinition(c==null?void 0:c.type))==null?void 0:k.name)??"Unavailable component")+" · Id: "+T(l),1)]),R(" "+T(((f=c==null?void 0:c.content)==null?void 0:f.alias)??((I=b(t).getComponentDefinition(c==null?void 0:c.type))==null?void 0:I.name)??"Unavailable component"),1)]),c?(a(),A(G,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:V=>C(l)},{default:x(()=>s[8]||(s[8]=[n("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):$("",!0)],2)}),128))])])}}}),Yn=U(Gn,[["__scopeId","data-v-6ee8bb1e"]]),Jn={class:"BuilderListItem"},Xn=["viewBox"],Qn=["d","stroke"],ea=["d","stroke"],ta={class:"BuilderListItem__content"},na=M({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:Se.Blue2},colorLast:{type:String,required:!1,default:Se.Blue2}},setup(e){const i=e,t=w(()=>i.height/2),d=w(()=>`0 0 17 ${i.height}`),r=w(()=>["M1 0",`V${t.value-8}`,`C1 ${t.value-4}.4183 4.58172 ${t.value} 9 ${t.value}`,"H17"].join(" ")),_=w(()=>[`M1 ${t.value-8}`,`V${i.height}`].join(" "));return(h,m)=>(a(),v("div",Jn,[(a(),v("svg",{viewBox:d.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?$("",!0):(a(),v("path",{key:0,d:_.value,stroke:e.colorLast,"stroke-width":"1"},null,8,Qn)),n("path",{d:r.value,stroke:e.color,"stroke-width":"1"},null,8,ea)],8,Xn)),n("div",ta,[ne(h.$slots,"default",{},void 0,!0)])]))}}),aa=U(na,[["__scopeId","data-v-33f3edcd"]]),oa={class:"BuilderLogBlueprintExecution"},sa={class:"name"},la={key:0},ia={class:"eyebrow"},ra={class:"outcome"},da={class:"result"},ua={class:"time"},ca={key:0,class:"message markdown"},pa=M({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const i=z(q.core),t=z(q.builderManager),{goToComponentParentPage:d}=De(i,t),r=e,_=N(null),h=w(()=>({summary:[...r.executionLog.summary.filter(C=>!!C.outcome).map(C=>({...C,component:i.getComponentById(C.componentId),componentDef:i.getComponentById(C.componentId)?i.getComponentDefinition(i.getComponentById(C.componentId).type):void 0}))]}));async function m(g){t.setMode("blueprints"),await fe(),d(g),await fe(),t.setSelection(g,void 0,"log")}function p(g){return g<0?"N/A":g<.1?"< 0.1s":`${g.toFixed(2)}s`}return(g,C)=>{const B=pt("dompurify-html");return a(),v("div",oa,[(a(!0),v(H,null,ie(h.value.summary,(s,o)=>(a(),A(aa,{key:o,"is-last":o+1===h.value.summary.length},{default:x(()=>{var y,u,c,l,k,f,I,V,E,F,S,Z;return[n("div",{class:W(["itemWrapper",{"itemWrapper--first":o===0,"itemWrapper--last":o+1===h.value.summary.length}])},[n("div",{class:W(["item",{selected:b(t).isComponentIdSelected(s.componentId)}])},[n("div",sa,[(u=(y=s.component)==null?void 0:y.content)!=null&&u.alias?(a(),v("div",la,[n("div",ia,T(((c=s.componentDef)==null?void 0:c.name)??"Unavailable component"),1),R(" "+T((k=(l=s.component)==null?void 0:l.content)==null?void 0:k.alias),1)])):(a(),v(H,{key:1},[R(T(((f=s.componentDef)==null?void 0:f.name)??"Unavailable component"),1)],64)),s.component?(a(),A(G,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:ue=>m(s.componentId)},{default:x(()=>C[1]||(C[1]=[n("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):$("",!0)]),n("div",ra,[s.outcome!=="in_progress"?(a(),v(H,{key:0},[n("div",{class:W(["ball",(E=(V=(I=s.componentDef)==null?void 0:I.outs)==null?void 0:V[s.outcome])==null?void 0:E.style])},null,2),R(" "+T(((Z=(S=(F=s.componentDef)==null?void 0:F.outs)==null?void 0:S[s.outcome])==null?void 0:Z.name)??s.outcome),1)],64)):(a(),v(H,{key:1},[C[2]||(C[2]=n("div",{class:"ballContainer"},[n("div",{class:"ball inProgress"})],-1)),C[3]||(C[3]=R(" In progress... "))],64))]),n("div",da,[_.value==o?(a(),A(Re,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>_.value=null}]},{default:x(()=>[P(Yn,{"execution-item":s,onCloseModal:C[0]||(C[0]=()=>_.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):$("",!0),s.result||s.returnValue||s.executionEnvironment?(a(),A(G,{key:1,variant:"special",size:"small",onClick:()=>_.value=o},{default:x(()=>C[4]||(C[4]=[n("i",{class:"material-symbols-outlined"},"find_in_page",-1),R(" Trace ")])),_:2},1032,["onClick"])):$("",!0)]),n("div",ua,T(p(s.executionTimeInSeconds)),1),s.message?Ie((a(),v("div",ca,null,512)),[[B,b(gt).parse(s.message)]]):$("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),va=U(pa,[["__scopeId","data-v-d778122d"]]),ma={class:"BuilderLogIndicator"},fa={key:0,class:"number error"},_a={key:1,class:"number info"},ya=M({__name:"BuilderLogIndicator",setup(e){const i=z(q.builderManager),t=w(()=>i.getLogEntries().reduce((d,r)=>(r.type in d||(d[r.type]=0),d[r.type]++,d),{}));return(d,r)=>(a(),v("div",ma,[t.value.error>0?(a(),v("div",fa,[r[0]||(r[0]=n("div",{class:"icon"},[n("i",{class:"material-symbols-outlined"},"error")],-1)),R(" "+T(t.value.error??0),1)])):$("",!0),t.value.info>0?(a(),v("div",_a,[r[1]||(r[1]=n("div",{class:"icon"},[n("i",{class:"material-symbols-outlined"},"info")],-1)),R(" "+T(t.value.info??0),1)])):$("",!0)]))}}),ga=U(ya,[["__scopeId","data-v-34a7a9ff"]]),ha={key:0,class:"entries"},ba={class:"icon"},wa={key:0,class:"material-symbols-outlined"},ka={key:1,class:"material-symbols-outlined"},Ca={class:"title"},Ba={class:"time"},$a={class:"content"},Sa={key:0,class:"codeContainer"},Da={key:1,class:"emptyMessage"},Ta=M({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const i=z(q.core),t=z(q.builderManager),d=re(i);function r(m){m&&d.track("nav_logs_opened")}const _=[{icon:"delete",name:"Clear log",callback:()=>{t.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],h=w(()=>t.getLogEntries());return(m,p)=>(a(),A(Ye,{"panel-id":"log",name:"Log","contents-teleport-el":m.contentsTeleportEl,actions:_,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:r},{titleCompanion:x(()=>[P(ga)]),default:x(()=>[h.value.length>0?(a(),v("div",ha,[(a(!0),v(H,null,ie(h.value,(g,C)=>(a(),v(H,{key:C},[n("div",{class:W(["entry",g.type])},[n("div",ba,[g.type=="error"?(a(),v("i",wa,"error")):(a(),v("i",ka,"info"))]),n("div",Ca,T(g.title)+T(g.repeated>0?` · Repeated ${g.repeated} times`:""),1),n("div",Ba,T(g.timestampReceived.toLocaleTimeString()),1),n("div",$a,[R(T(g.message)+" ",1),g.code?(a(),v("div",Sa,[n("code",null,T(g.code),1)])):$("",!0)])],2),g.blueprintExecution?(a(),A(va,{key:0,"execution-log":g.blueprintExecution},null,8,["execution-log"])):$("",!0)],64))),128))])):$("",!0),h.value.length==0?(a(),v("div",Da,p[0]||(p[0]=[n("div",null,[R(" Exceptions and other relevant messages will be shown here."),n("br"),R("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):$("",!0)]),_:1},8,["contents-teleport-el"]))}}),Ia=U(Ta,[["__scopeId","data-v-dd30a100"]]),La={class:"switches"},Pa=M({__name:"BuilderPanelSwitcher",setup(e){const i=z(q.builderManager),t=Te("screenEl");return(d,r)=>(a(),v("div",{class:W(["BuilderPanelSwitcher",{openPanels:b(i).openPanels.value.size>0}])},[n("div",{ref_key:"screenEl",ref:t,class:"screen"},null,512),n("div",La,[P(In,{"contents-teleport-el":b(t)},null,8,["contents-teleport-el"]),P(Ia,{"contents-teleport-el":b(t)},null,8,["contents-teleport-el"])])],2))}}),xa=U(Pa,[["__scopeId","data-v-75a489c0"]]),Aa={class:"WdsToast__icon"},Fa={class:"material-symbols-outlined"},Ea={class:"material-symbols-outlined"},Ma=M({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const i=e,t=w(()=>{switch(i.type){case"info":return"info";case"success":return"check";case"error":return"close";default:return"question_mark"}});return(d,r)=>(a(),v("div",{class:W(["WdsToast",`WdsToast--${e.type}`])},[n("div",Aa,[n("span",Fa,T(t.value),1)]),n("p",null,T(e.message),1),e.action?(a(),v("button",{key:0,class:"WdsToast__action",onClick:r[0]||(r[0]=(..._)=>e.action.func&&e.action.func(..._))},[R(T(e.action.label)+" ",1),n("span",Ea,T(e.action.icon),1)])):$("",!0),e.closable?(a(),A(G,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:r[1]||(r[1]=_=>d.$emit("close"))},{default:x(()=>r[2]||(r[2]=[n("span",{class:"material-symbols-outlined"},"close",-1)])),_:1})):$("",!0)],2))}}),Ra=U(Ma,[["__scopeId","data-v-e8cc4657"]]),Ua={class:"BuilderToasts"},Wa=M({__name:"BuilderToasts",setup(e){const{toasts:i,removeToast:t}=Le();return(d,r)=>(a(),v("div",Ua,[P(vt,{name:"list",tag:"div"},{default:x(()=>[(a(!0),v(H,null,ie(b(i),_=>(a(),A(Ra,{key:_.id,class:"BuilderToasts__toast",closable:_.closable,message:_.message,type:_.type,action:_.action,onClick:h=>b(t)(_.id)},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),Oa=U(Wa,[["__scopeId","data-v-6c357255"]]),za={key:0,class:"sidebar"},qa={class:"builderMain"},Va={class:"rendererWrapper"},Ka=M({__name:"BuilderApp",setup(e){mt(L=>({c23e0f1c:b(p).getMode()!=="preview"?"var(--builderSidebarWidth)":"0px"}));const i=ee({loader:()=>te(()=>import("./BuilderSettings-CPQct-PE.js"),__vite__mapDeps([6,1,2,7,8,4,5,9,10]),import.meta.url),loadingComponent:le}),t=ee({loader:()=>te(()=>import("./BuilderSidebar-C2S2s5LZ.js"),__vite__mapDeps([11,1,2,8,9,12]),import.meta.url),loadingComponent:le}),d=ee({loader:()=>te(()=>import("./ComponentRenderer--oa3X2p3.js"),__vite__mapDeps([13,1,2,7,14]),import.meta.url),loadingComponent:le}),r=ee({loader:()=>te(()=>import("./BuilderInstanceTracker-BbFuvTRE.js"),__vite__mapDeps([15,1,2,16]),import.meta.url),loadingComponent:le}),_=ee({loader:()=>te(()=>import("./BuilderInsertionOverlay-BRTPzG4O.js"),__vite__mapDeps([17,1,2,18]),import.meta.url),loadingComponent:le}),h=ee({loader:()=>te(()=>import("./BuilderInsertionLabel-CEw0TgC2.js"),__vite__mapDeps([19,1,2,20]),import.meta.url),loadingComponent:le}),m=z(q.core),p=z(q.builderManager),g=re(m),{candidateId:C,candidateInstancePath:B,isCandidacyConfirmed:s,dropComponent:o,assignInsertionCandidacy:y,removeInsertionCandidacy:u}=_t(m),{createAndInsertComponent:c,undo:l,redo:k,moveComponent:f,moveComponentUp:I,moveComponentDown:V,cutComponent:E,isPasteAllowed:F,isCopyAllowed:S,isCutAllowed:Z,isDeleteAllowed:ue,isGoToParentAllowed:ce,pasteComponent:ae,copyComponent:be,removeComponentsSubtree:Pe,goToParent:we}=De(m,p,g),xe=Le(),Q=w(()=>p.getMode()),ke=w(()=>p.firstSelectedId.value);async function _e(L){if(L.key=="Escape"){p.setSelection(null);return}const j=yt()?L.metaKey:L.ctrlKey;if(L.target.closest("textarea, input, select"))return;if(L.key=="z"&&j){L.preventDefault(),l();return}if(L.key=="y"&&j){L.preventDefault(),k();return}if(!p.isSingleSelectionActive.value||!p.firstSelectedItem.value)return;const{componentId:O,instancePath:pe}=p.firstSelectedItem.value;if(L.key=="Delete"){const oe=p.selection.value.filter(Ee=>ue(Ee.componentId)).map(Ee=>Ee.componentId);Pe(...oe);return}if(L.key=="ArrowUp"&&j&&L.shiftKey){if(!ce(O))return;we(O,pe);return}if(L.key=="ArrowUp"&&j){I(O);return}if(L.key=="ArrowDown"&&j){V(O);return}if(L.key=="v"&&j){if(!F(O))return;try{await ae(O)}catch(oe){xe.pushToast({type:"error",message:String(oe)})}return}if(L.key=="c"&&j){if(!S(O))return;be(O);return}if(L.key=="x"&&j){if(!Z(O))return;E(O);return}}function D(L){Q.value!=="preview"&&y(L)}function K(L){if(Q.value==="preview")return;p.setSelection(null);const j=o(L);if(!j)return;const{draggedType:X,draggedId:O,parentId:pe,position:oe}=j;O?f(O,pe,oe):c(X,pe,oe)}function Y(L){if(Q.value==="preview"||L.target.closest("[data-writer-unselectable]"))return;const X=L.target.closest("[data-writer-id]");if(!X)return;const O=X.dataset.writerId,pe=X.dataset.writerInstancePath;p.isComponentIdSelected(O)&&p.selectionStatus.value!==Ke.Multiple||(L.preventDefault(),L.stopPropagation(),p.handleSelectionFromEvent(L,O,pe,"click"))}function Ae(){p.isSettingsBarCollapsed.value=!1}const Fe=L=>{if(Q.value==="preview")return;const X=L.target.closest("[data-writer-id]").dataset.writerId,{type:O}=m.getComponentById(X);p.selectionStatus.value===Ke.Multiple&&(p.setSelection(X,void 0,"click"),p.isSettingsBarCollapsed.value=!0),L.dataTransfer.setData(`application/json;writer=${O},${X}`,"{}")};function Qe(L){p.setSelection(null),u(L)}const ze=new AbortController;return de(()=>{document.addEventListener("keydown",_e,{signal:ze.signal})}),he(()=>ze.abort()),(L,j)=>(a(),v("div",{class:"BuilderApp",tabindex:"-1",style:Oe(b(ft))},[n("div",{class:W(["mainGrid",{openPanels:b(p).openPanels.value.size>0}])},[P(Lt,{class:"builderHeader"}),Q.value!=="preview"?(a(),v("div",za,[P(b(t))])):$("",!0),n("div",qa,[n("div",Va,[P(b(d),{class:W(["componentRenderer",{settingsOpen:b(p).isSingleSelectionActive}]),onDragover:D,onDragstart:Fe,onDragend:Qe,onDrop:K,onClickCapture:Y,onDblclick:Ae},null,8,["class"])]),b(p).isSingleSelectionActive?(a(),A(b(i),{key:ke.value??"noneSelected"})):$("",!0)]),P(xa,{class:"panelSwitcher"})],2),Q.value!=="preview"?(a(),v(H,{key:0},[b(C)&&!b(s)?(a(),v(H,{key:0},[(a(),A(b(r),{key:b(B),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":b(B),"match-size":!0},{default:x(()=>[P(b(_))]),_:1},8,["instance-path"])),(a(),A(b(r),{key:b(B),class:"insertionLabelTracker","instance-path":b(B),"vertical-offset-pixels":-48},{default:x(()=>[P(b(h),null,{default:x(()=>[R(T(b(m).getComponentDefinition(b(m).getComponentById(b(C)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):$("",!0)],64)):$("",!0),j[0]||(j[0]=n("div",{id:"modal"},null,-1)),P(Et,{id:"tooltip"}),P(Oa)],4))}}),ja=U(Ka,[["__scopeId","data-v-4f96196e"]]),Za=Object.freeze(Object.defineProperty({__proto__:null,default:ja},Symbol.toStringTag,{value:"Module"}));export{le as B,dn as T,Xe as W,aa as a,Za as b,Le as u};
