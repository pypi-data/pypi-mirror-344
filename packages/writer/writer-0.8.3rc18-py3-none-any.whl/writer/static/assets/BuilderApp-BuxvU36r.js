function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./SharedMoreDropdown-DffPheGC.js","./index-Zr2uxkwm.js","./index-DOkRxd0H.css","./SharedMoreDropdown-BWKlox8E.css","./BuilderEmbeddedCodeEditor-CHqWjmKb.js","./BuilderEmbeddedCodeEditor-DiDqfWdt.css","./BuilderSettings-BHuJWzZ9.js","./instancePath-BsbOTTI8.js","./useComponentDescription-XAPc6apm.js","./marked.esm-273vDTCT.js","./BuilderSettings-Dz3KZKOl.css","./BuilderSidebar-E9x1fdsG.js","./BuilderSidebar-BLAsr7hk.css","./ComponentRenderer-FbxROz85.js","./ComponentRenderer-C3SDWCQG.css","./BuilderInstanceTracker-D0yzJR-l.js","./BuilderInstanceTracker-BECcXNnW.css","./BuilderInsertionOverlay-D2HKC6JD.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-B7R3Z1Tv.js","./BuilderInsertionLabel-_YS5WPfq.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as M,i as V,a as K,r as H,u as de,c as b,o as a,e as p,f as n,y as R,C as O,_ as W,s as I,N as g,O as ge,P as Ce,Q as Ne,R as tt,w as Be,n as ue,S as he,T as He,U as Ze,x,W as G,b as A,t as T,V as Re,X as S,Y as De,l as Te,q as Le,v as We,H as Oe,I as fe,Z as nt,$ as ve,a0 as qe,a1 as J,a2 as $e,a3 as le,a4 as me,a5 as Me,a6 as at,a7 as ot,a8 as Ve,G as ae,z as Z,A as re,a9 as st,aa as lt,ab as it,ac as Ge,ad as rt,ae as te,M as ne,af as Se,ag as dt,ah as ut,ai as ct,aj as pt,ak as vt,al as mt,D as ft,am as _t,an as yt,ao as Ke}from"./index-Zr2uxkwm.js";import{marked as gt}from"./marked.esm-273vDTCT.js";const ht={class:"BuilderSwitcher"},bt=M({__name:"BuilderSwitcher",setup(e){const i=V(K.core),t=V(K.builderManager);let d=H(null);const r=de(i),_=f=>{const c=t.getMode();if(c!=f){switch(d.value=f,f){case"ui":r.track("nav_ui_opened");break;case"preview":r.track("nav_preview_opened");break;case"blueprints":r.track("nav_blueprints_opened");break}t.setMode(f),(f=="preview"||c=="blueprints"||f=="blueprints")&&t.setSelection(null)}},h=b(()=>t.getMode());return(f,c)=>(a(),p("div",ht,[n("button",{"data-automation-action":"set-mode-ui",class:O({active:h.value=="ui"}),type:"button",onClick:c[0]||(c[0]=y=>_("ui"))},c[3]||(c[3]=[n("i",{class:"icon material-symbols-outlined"}," brush ",-1),R(" UI ")]),2),n("button",{"data-automation-action":"set-mode-blueprints",class:O({active:h.value=="blueprints"}),type:"button",onClick:c[1]||(c[1]=y=>_("blueprints"))},c[4]||(c[4]=[n("i",{class:"icon material-symbols-outlined"},"linked_services",-1),R(" Blueprints ")]),2),n("button",{class:O({active:h.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:c[2]||(c[2]=y=>_("preview"))},c[5]||(c[5]=[n("i",{class:"icon material-symbols-outlined"}," preview ",-1),R(" Preview ")]),2)]))}}),wt=W(bt,[["__scopeId","data-v-60f9fbac"]]),kt={class:"BuilderStateExplorer"},Ct=M({__name:"BuilderStateExplorer",setup(e){const i=V(K.core);return(t,d)=>(a(),p("div",kt,[I(ge,{data:g(i).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),Bt=W(Ct,[["__scopeId","data-v-eafb7b97"]]),$t=M({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){return(i,t)=>(a(),p("div",{class:O(["WdsStateDotState",`WdsStateDotState--${e.state}`])},null,2))}}),Ye=W($t,[["__scopeId","data-v-4eacfc04"]]),ye=Ce([]);function Ie(){function e(t){ye.value=ye.value.filter(d=>d.id!==t)}function i(t){const d=new Date().getTime();ye.value=[...ye.value,{...t,id:d}],t.closable||setTimeout(()=>e(d),t.delayMs??3e3)}return{pushToast:i,removeToast:e,toasts:Ne(ye)}}function St(e){const i=new AbortController,t=de(e),d=He(),{pushToast:r}=Ie(),{writerApi:_,apiBaseUrl:h}=tt({signal:i.signal}),f=H(!1),c=Ce(),y=Ce(),B=b(()=>e.writerApplication.value!==void 0),C=b(()=>{var w;return Number((w=e.writerApplication.value)==null?void 0:w.organizationId)||void 0}),o=b(()=>{var w;return(w=e.writerApplication.value)==null?void 0:w.id}),s=b(()=>{var E,U;const w=(U=(E=y.value.writer)==null?void 0:E.teamIds)==null?void 0:U[0];if(!w)return;const q=`/organization/${C.value}/team/${w}/framework/${o.value}`;return new URL(q,h)}),v=b(()=>{if(!(!C.value||!o.value))return new URL(`/aistudio/organization/${C.value}/agent/${o.value}/deploy`,h)}),u=b(()=>y.value.lastDeployedAt?new Date(y.value.lastDeployedAt):void 0),m=b(()=>!!(B.value&&y.value)),l=b(()=>{var w;return((w=y.value)==null?void 0:w.status)==="deployed"});Be(e.writerApplication,k,{immediate:!0}),ue(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await k()},{signal:i.signal})});async function k(){if(e.writerApplication.value)try{y.value=await _.fetchApplicationDeployment(C.value,o.value)}catch(w){d.error("Failed to fetch deployment information",w),y.value=void 0}}async function $(){if(e.writerApplication.value){if(!l.value){const w=`/aistudio/organization/${C.value}/agent/${o.value}/deploy`,q=new URL(w,h);window.open(q,"_blank");return}f.value=!0,c.value=void 0;try{await _.publishApplication(C.value,o.value,{applicationVersionId:y.value.applicationVersion.id,applicationVersionDataId:y.value.applicationVersionData.id}),await k();const w=s.value?{label:"See it live",func:()=>window.open(s.value,"_blank"),icon:"open_in_new"}:void 0;r({type:"success",message:"agent deployed",action:w}),t.track("deployment_succeeded")}catch(w){t.track("deployment_failed",{error:String(w)}),c.value=w,d.error("Deploy failed",w),r({type:"error",message:"deploy failed"})}finally{f.value=!1}}}return he(()=>i.abort()),{isCloudApp:B,canDeploy:m,writerDeployUrl:v,hasBeenPublished:l,publishApplication:$,isDeploying:Ne(f),lastDeployedAt:u}}const Dt={class:"BuilderHeader"},Tt=["href"],Lt={key:1,src:Ze,alt:"Writer Framework logo"},It={class:"BuilderHeader__toolbar"},Pt=M({__name:"BuilderHeader",setup(e){const i=V(K.core),t=V(K.builderManager),d=H(!1),r=de(i),{undo:_,redo:h,getUndoRedoSnapshot:f}=De(i,t),{canDeploy:c,isDeploying:y,publishApplication:B,hasBeenPublished:C,lastDeployedAt:o,writerDeployUrl:s}=St(i),v=b(()=>f()),u=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function m(){r.track("nav_deploy_clicked"),C.value?l.value=!0:await B()}const l=H(!1),k=[{desc:"Cancel",fn:()=>l.value=!1},{desc:"Yes, deploy changes",fn:async()=>{l.value=!1,await B()}}],$=b(()=>o.value?`Editor Last saved ${u.format(o.value)}`:void 0),w=b(()=>C.value===!0?"Deploy changes":(C.value===!1,"Configure deployment")),q=b(()=>{let F="";switch(i.syncHealth.value){case"offline":F+="Offline. Not syncing.";break;case"connected":F+="Online. Syncing...";break;case"idle":F+="Sync not initialised.";break;case"suspended":F+="Sync suspended.";break}return i.featureFlags.value.length>0&&(F+=` Feature flags: ${i.featureFlags.value.join(", ")}`),F}),E=b(()=>{switch(i.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});function U(){r.track("nav_state_explorer_opened"),d.value=!0}return(F,P)=>(a(),p("div",Dt,[g(s)?(a(),p("a",{key:0,href:g(s).toString(),target:"_blank",class:"BuilderHeader__goBack"},P[3]||(P[3]=[n("img",{src:Ze,alt:"Writer Framework logo"},null,-1)]),8,Tt)):(a(),p("img",Lt)),I(wt),P[8]||(P[8]=n("div",{class:"gap"},null,-1)),n("div",It,[I(G,{variant:"secondary",size:"smallIcon","data-automation-key":"undo","data-writer-tooltip":v.value.isUndoAvailable?`Undo: ${v.value.undoDesc}`:"Nothing to undo",disabled:!v.value.isUndoAvailable,"data-writer-tooltip-placement":"bottom",onClick:P[0]||(P[0]=Q=>g(_)())},{default:x(()=>P[4]||(P[4]=[n("i",{class:"material-symbols-outlined"},"undo",-1)])),_:1},8,["data-writer-tooltip","disabled"]),I(G,{variant:"secondary",size:"smallIcon","data-automation-key":"redo","data-writer-tooltip":v.value.isRedoAvailable?`Redo: ${v.value.redoDesc}`:"Nothing to redo",disabled:!v.value.isRedoAvailable,"data-writer-tooltip-placement":"bottom",onClick:P[1]||(P[1]=Q=>g(h)())},{default:x(()=>P[5]||(P[5]=[n("i",{class:"material-symbols-outlined"},"redo",-1)])),_:1},8,["data-writer-tooltip","disabled"]),I(G,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:U},{default:x(()=>P[6]||(P[6]=[n("i",{class:"material-symbols-outlined"},"mystery",-1)])),_:1}),g(c)?(a(),A(G,{key:0,size:"small",loading:g(y),"data-writer-tooltip":$.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:m},{default:x(()=>[R(T(w.value)+" ",1),l.value?(a(),A(Re,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:k},{default:x(()=>P[7]||(P[7]=[n("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):S("",!0)]),_:1},8,["loading","data-writer-tooltip"])):S("",!0),I(Ye,{state:E.value,"data-writer-tooltip":q.value,"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),d.value?(a(),A(Re,{key:1,title:"State Explorer","display-close-button":"",onClose:P[2]||(P[2]=Q=>d.value=!1)},{default:x(()=>[I(Bt)]),_:1})):S("",!0)])]))}}),xt=W(Pt,[["__scopeId","data-v-4be84bba"]]),At={class:"text"},Ft=200,Et=4,Mt=M({__name:"BuilderTooltip",setup(e){const i=Te("rootEl"),t=H(!1),d=H(null);let r=null,_=null;const h=H("top"),f=H({top:0,left:0});async function c(){if(!r||(d.value=r.dataset.writerTooltip,!d.value))return;const s=r.dataset.writerTooltipGap?parseInt(r.dataset.writerTooltipGap):Et;if(t.value=y(r),!t.value)return;await fe();const{x:v,y:u,width:m,height:l}=r.getBoundingClientRect(),{width:k,height:$}=i.value.getBoundingClientRect();switch(h.value){case"top":f.value.top=u-$-s,f.value.left=v+m/2-k/2;break;case"right":f.value.top=u+l/2-$/2,f.value.left=v+m+s;break;case"left":f.value.left=v-k-s,f.value.top=u+l/2-$/2;break;case"bottom":f.value.top=u+l+s,f.value.left=v+m/2-k/2;break}}function y(s){return s.getAttribute("data-writer-tooltip-strategy")==="overflow"?s.scrollWidth>s.clientWidth:!0}function B(s){const u=s.target.closest("[data-writer-tooltip]");if(u)r!==u&&(t.value=!1);else{t.value=!1,r=null;return}r=u,h.value=r.dataset.writerTooltipPlacement??"top",setTimeout(()=>C(u),Ft)}async function C(s){s===r&&(_==null||_.disconnect(),_=new MutationObserver(c),_.observe(r,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),c())}const o=b(()=>{const{top:s,left:v}=f.value;return{top:`${s}px`,left:`${v}px`}});return ue(()=>{document.documentElement.addEventListener("mouseover",B)}),he(()=>{document.documentElement.removeEventListener("mouseover",B),_==null||_.disconnect()}),(s,v)=>Le((a(),p("div",{ref_key:"rootEl",ref:i,class:"BuilderTooltip",style:Oe(o.value)},[n("div",{class:O(["arrow",h.value])},null,2),n("div",At,T(d.value),1)],4)),[[We,t.value]])}}),Rt=W(Mt,[["__scopeId","data-v-7ba01c7c"]]),Ut={class:"BuilderAsyncLoader"},Wt=M({__name:"BuilderAsyncLoader",setup(e){return(i,t)=>(a(),p("div",Ut,[I(nt)]))}}),ie=W(Wt,[["__scopeId","data-v-bb820549"]]),Ot=""+new URL("art-paper-WsD9P5Lu.svg",import.meta.url).href,zt="data:image/svg+xml,%3csvg%20width='120'%20height='160'%20viewBox='0%200%20120%20160'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3crect%20x='16.0273'%20y='89.9375'%20width='80.1422'%20height='55.209'%20rx='7.12375'%20fill='%23A95EF8'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M47.9297%20135.352H13.3542C9.41988%20135.352%206.23047%20138.541%206.23047%20142.475V152.27C6.23047%20156.205%209.41987%20159.394%2013.3542%20159.394H97.9487C101.883%20159.394%20105.072%20156.205%20105.072%20152.27V142.475C105.072%20138.541%20101.883%20135.352%2097.9487%20135.352H63.3737C63.3737%20136.103%2063.174%20136.848%2062.7859%20137.542C62.3979%20138.237%2061.8291%20138.868%2061.112%20139.399C60.395%20139.931%2059.5437%20140.352%2058.6068%20140.64C57.6699%20140.928%2056.6658%20141.076%2055.6517%20141.076C54.6376%20141.076%2053.6335%20140.928%2052.6966%20140.64C51.7597%20140.352%2050.9085%20139.931%2050.1914%20139.399C49.4744%20138.868%2048.9056%20138.237%2048.5175%20137.542C48.1295%20136.848%2047.9297%20136.103%2047.9297%20135.352Z'%20fill='%23721CC9'/%3e%3crect%20x='27.6055'%20y='103.295'%20width='56.99'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='38.293'%20y='112.199'%20width='35.6187'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20x='46.3047'%20y='121.104'%20width='19.5903'%20height='3.56187'%20rx='1.78094'%20fill='%23F6EFFD'/%3e%3crect%20y='10.3691'%20width='40.0647'%20height='30.0485'%20rx='7.12375'%20transform='rotate(-15%200%2010.3691)'%20fill='%23EDE2FF'/%3e%3cpath%20d='M15.0475%2021.5308C15.2249%2020.8687%2016.0526%2020.6469%2016.5373%2021.1316L21.9902%2026.5846C22.475%2027.0693%2022.2532%2027.897%2021.5911%2028.0744L14.1421%2030.0703C13.48%2030.2477%2012.8741%2029.6418%2013.0515%2028.9797L15.0475%2021.5308Z'%20fill='%23D4B2F7'/%3e%3cpath%20d='M25.3727%2010.4659C25.5501%209.80376%2026.3777%209.58199%2026.8624%2010.0667L34.9516%2018.1559C35.4363%2018.6406%2035.2145%2019.4682%2034.5524%2019.6456L23.5024%2022.6065C22.8403%2022.7839%2022.2344%2022.178%2022.4118%2021.5159L25.3727%2010.4659Z'%20fill='%23D4B2F7'/%3e%3crect%20x='68.2383'%20y='23.1523'%20width='54.3186'%20height='40.0711'%20rx='7.12375'%20transform='rotate(17.6282%2068.2383%2023.1523)'%20fill='%23D4B2F7'/%3e%3cpath%20d='M72.1976%2052.7145C71.7609%2052.9406%2071.5902%2053.4779%2071.8163%2053.9146C72.0424%2054.3514%2072.5797%2054.5221%2073.0164%2054.296L72.1976%2052.7145ZM82.1128%2048.5839L82.8321%2048.059L82.3818%2047.4419L81.7034%2047.7931L82.1128%2048.5839ZM86.9945%2055.274L86.2752%2055.7989L86.71%2056.3948L87.3764%2056.0784L86.9945%2055.274ZM104.339%2047.7366C104.504%2047.2733%20104.262%2046.764%20103.798%2046.599L96.2487%2043.9102C95.7854%2043.7452%2095.2761%2043.987%2095.1111%2044.4503C94.9461%2044.9136%2095.1879%2045.4229%2095.6512%2045.5879L102.362%2047.9779L99.972%2054.6888C99.807%2055.1521%20100.049%2055.6614%20100.512%2055.8264C100.975%2055.9914%20101.485%2055.7496%20101.65%2055.2863L104.339%2047.7366ZM73.0164%2054.296L82.5222%2049.3746L81.7034%2047.7931L72.1976%2052.7145L73.0164%2054.296ZM81.3935%2049.1087L86.2752%2055.7989L87.7138%2054.7491L82.8321%2048.059L81.3935%2049.1087ZM87.3764%2056.0784L103.882%2048.2423L103.118%2046.6334L86.6126%2054.4696L87.3764%2056.0784Z'%20fill='%23F6EFFD'/%3e%3c/svg%3e",Ue=150;function qt(e){const i=H(structuredClone(ve(e.sourceFiles.value)));Be(e.sourceFiles,(l,k)=>{let $=!1,w=structuredClone(ve(i.value));const q=h(k).map(t);for(const E of qe(l)){const U=J(E,k),F=J(E,l);if(me(F))continue;if(U===void 0||$e(F)){w=Me(E,w,structuredClone(ve(F))),$=!0;continue}if(!le(U))continue;const P=!U.complete&&F.complete,Q=U.complete&&F.complete;if(!P&&!Q)continue;const ce=t(E);if(q.includes(ce))continue;const oe=J(E,w);le(oe)&&($=!0,oe.complete=!0,oe.content=F.content)}for(const E of at(w))J(E,l)===void 0&&(w=ot(E,w),$=!0);$&&(i.value=w)});function t(l){return l.join("/")}const d=Ce(),r=b(()=>Array.from(qe(i.value))),_=b(()=>h(e.sourceFiles.value));function h(l){return r.value.filter(k=>{const $=J(k,i.value);if($e($))return!1;if(!le($))return!0;const w=J(k,l);return le(w)?!$.complete||!w.complete?!1:$.content!==w.content:!0})}const f=b(()=>{if(d.value!==void 0)return J(d.value,i.value)}),c=b({get(){return le(f.value)?f.value.content:""},set(l){if(d.value===void 0)return;const k=J(d.value,i.value);le(k)&&(k.content=l)}});function y(l=1){const k=`new-file-${l}.txt`;return J([k],i.value)?y(l+1):k}async function B(){const l=y();i.value=Me([l],ve(i.value)),s([l]),await e.sendCreateSourceFileRequest([l])}const C=b(()=>{var k;return(k=d.value)!=null&&k.length?d.value.at(-1).split(".").at(-1):""}),o=b(()=>{switch(C.value){case"py":return"python";case"md":case"markdown":return"markdown";default:return C.value}});function s(l){d.value=l,le(f.value)&&!f.value.complete&&e.requestSourceFileLoading(l)}async function v(l){if(!(!d.value||!f.value)&&(f.value.type==="file"&&await e.sendCodeSaveRequest(c.value,d.value),l)){const k=[...ve(d.value)];d.value=void 0;try{await e.sendRenameSourceFileRequest(k,l)}catch($){throw d.value=k,$}s(l)}}function u(l){return new Promise((k,$)=>{const w=new FileReader;w.addEventListener("loadend",q=>{const E=q.target.result;if(E instanceof ArrayBuffer){const U=String.fromCharCode.apply(null,new Uint8Array(E));return k(U)}k(E.split(",")[1])}),w.addEventListener("error",()=>{$()}),w.readAsDataURL(l)})}async function m(l){const k=Ue*1024*1024;if(l.size>k)throw Error(`Cannot upload file bigger than ${Ue}mb`);const $=[l.name];if(J($,e.sourceFiles.value))throw Error(`The file ${l.name} already exists`);i.value=Me($,ve(i.value),{type:"binary",uploading:!0});const w=await u(l);await e.sendFileUploadRequest($,w)}return{code:c,sourceFileDraft:i,fileOpen:f,filepathOpen:d,pathsUnsaved:_,openedFileLanguage:o,save:v,upload:m,openFile:s,openNewFile:B,getNewFilename:y}}const Vt={class:"BuilderDropFileZone"},Kt=M({__name:"BuilderDropFileZone",setup(e){return(i,t)=>(a(),p("div",Vt,[t[0]||(t[0]=n("img",{src:zt,alt:"Drop file illustration"},null,-1)),t[1]||(t[1]=n("h2",null,"Upload files",-1)),n("p",null,"Files can be up to "+T(g(Ue))+"mb",1)]))}}),jt=W(Kt,[["__scopeId","data-v-92e0a561"]]),Nt={class:"BuilderPanel__collapser"},Ht={class:"material-symbols-outlined"},Zt={class:"BuilderPanel__title"},Gt={class:"BuilderPanel__titleCompanion"},Yt=["data-order"],Jt={key:0,class:"BuilderPanel__contents__leftPanel"},Xt={class:"BuilderPanel__actions"},Qt={class:"BuilderPanel__actionsCompanion"},en={class:"material-symbols-outlined"},tn={class:"BuilderPanel__mainContents"},nn=M({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=V(K.builderManager),d=["code","log"],r=e,_=i,h=b(()=>r.enableDropFile&&f.value),f=H(!1);function c(u,m){r.enableDropFile&&(u.preventDefault(),f.value=m)}function y(u){if(f.value=!1,!r.enableDropFile)return;u.preventDefault();const m=[];if(u.dataTransfer.items)for(const l of u.dataTransfer.items){if(l.kind!=="file")continue;const k=l.getAsFile();k&&m.push(k)}else for(const l of u.dataTransfer.files)m.push(l);m.length>0&&_("filesDrop",m)}const B=b(()=>!t.openPanels.value.has(r.panelId)),C=b(()=>d.indexOf(r.panelId));function o(u){if(t.openPanels.value.has(u)){t.openPanels.value.delete(u),_("openned",!1);return}t.openPanels.value.add(u),_("openned",!0)}function s(u){const m=lt(u);if(m&&u.key==r.keyboardShortcutKey.toLowerCase()){u.preventDefault(),o(r.panelId);return}r.actions.forEach(l=>{if(!l.keyboardShortcut)return;const{key:k,modifierKey:$}=l.keyboardShortcut;k.toLowerCase()==u.key&&(!m&&$||(u.preventDefault(),l.callback()))})}function v(u){if(!u)return"";let m=" (";return u.modifierKey&&(m+=Ve()),m+=u.key,m+=")",m}return ue(async()=>{document.addEventListener("keydown",s)}),he(()=>{document.removeEventListener("keydown",s)}),(u,m)=>(a(),p("div",{class:O(["BuilderPanel",{collapsed:B.value}])},[n("div",Nt,[I(G,{variant:"neutral",size:"smallIcon","data-automation-action":"toggle-panel","data-automation-key":u.panelId,"data-writer-tooltip":`Toggle ${u.name} (${g(Ve)()}${u.keyboardShortcutKey})`,onClick:m[0]||(m[0]=l=>o(u.panelId))},{default:x(()=>[n("i",Ht,T(B.value?"expand_less":"expand_more"),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),n("div",Zt,T(u.name),1),n("div",Gt,[ae(u.$slots,"titleCompanion",{},void 0,!0)]),B.value?S("",!0):(a(),A(st,{key:0,to:u.contentsTeleportEl},[n("div",{style:Oe({order:C.value}),"data-order":C.value,class:O(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":u.enableLeftPanel,"BuilderPanel__contents--dropingFile":h.value}]),onDrop:y,onDragover:m[1]||(m[1]=l=>c(l,!0)),onDragleave:m[2]||(m[2]=l=>c(l,!1))},[h.value?(a(),A(jt,{key:0})):(a(),p(Z,{key:1},[u.enableLeftPanel?(a(),p("div",Jt,[ae(u.$slots,"leftPanel",{},void 0,!0)])):S("",!0),n("div",Xt,[n("div",Qt,[ae(u.$slots,"actionsCompanion",{},void 0,!0)]),(a(!0),p(Z,null,re(u.actions,(l,k)=>(a(),A(G,{key:k,"data-writer-tooltip":l.name+v(l.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:l.isDisabled,onClick:l.callback},{default:x(()=>[n("i",en,T(l.icon),1)]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),n("div",tn,[ae(u.$slots,"default",{},void 0,!0)])],64))],46,Yt)],8,["to"]))],2))}}),Je=W(nn,[["__scopeId","data-v-a30a0b3d"]]),an={class:"BuilderTree"},on=["draggable","data-automation-key","aria-expanded"],sn={class:"material-symbols-outlined"},ln=["data-writer-tooltip"],rn={key:1,class:"BuilderTree__main__dropdown"},dn={class:"BuilderTree__children"},un=M({__name:"BuilderTree",props:{name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0}},emits:{expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},setup(e,{expose:i,emit:t}){const d=te(()=>ne(()=>import("./SharedMoreDropdown-DffPheGC.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),r=e,_=t;i({expand:B,toggleCollapse:C});const h=H(!1),f=H(!1),c=b(()=>!r.matched),y=b(()=>!r.hasChildren);function B(){h.value=!1,_("expandBranch")}function C(o){o??(o=!h.value),o!==h.value&&(h.value=o)}return(o,s)=>(a(),p("div",an,[n("div",{class:O(["BuilderTree__main",{selected:e.selected,notMatched:c.value,childless:y.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!h.value,onMouseenter:s[2]||(s[2]=v=>f.value=!0),onMouseleave:s[3]||(s[3]=v=>f.value=!1),onClick:s[4]||(s[4]=v=>o.$emit("select",v)),onKeydown:s[5]||(s[5]=Ge(v=>o.$emit("select",v),["enter"])),onDragover:s[6]||(s[6]=v=>o.$emit("dragover",v)),onDragstart:s[7]||(s[7]=v=>o.$emit("dragstart",v)),onDragend:s[8]||(s[8]=v=>o.$emit("dragend",v)),onDrop:s[9]||(s[9]=v=>o.$emit("drop",v))},[e.hasChildren?(a(),A(G,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:s[0]||(s[0]=it(v=>C(void 0),["stop"]))},{default:x(()=>[n("i",sn,T(h.value?"expand_more":"expand_less"),1)]),_:1},8,["disabled"])):S("",!0),ae(o.$slots,"nameLeft",{},void 0,!0),n("span",{class:O(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},T(e.name),11,ln),ae(o.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&f.value?(a(),p("div",rn,[I(g(d),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:s[1]||(s[1]=v=>o.$emit("dropdownSelect",v))},null,8,["options"])])):S("",!0)],42,on),I(rt,null,{default:x(()=>[Le(n("div",dn,[ae(o.$slots,"children",{},void 0,!0)],512),[[We,!h.value&&e.hasChildren]])]),_:3})]))}}),cn=W(un,[["__scopeId","data-v-fca510f3"]]),pn=["width","height","viewBox","aria-valuenow"],vn=["r","cx","cy","stroke","stroke-width"],mn=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],fn=M({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const i=e,t=b(()=>i.sizePx/2),d=b(()=>i.sizePx/2-i.strokeWidth/2),r=b(()=>2*Math.PI*d.value),_=b(()=>r.value*((100-i.progress)/100)),h=b(()=>`0 0 ${i.sizePx} ${i.sizePx}`);return(f,c)=>(a(),p("svg",{width:e.sizePx,height:e.sizePx,viewBox:h.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[n("circle",{r:d.value,cx:t.value,cy:t.value,fill:"transparent",stroke:g(Se).Blue1,"stroke-width":e.strokeWidth},null,8,vn),n("circle",{r:d.value,cx:t.value,cy:t.value,fill:"transparent",stroke:g(Se).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":r.value,"stroke-dashoffset":_.value},null,8,mn)],8,pn))}}),_n=M({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const i=e,t=H(0);return ue(()=>{let d;const r=_=>{d||(d=_);const h=_-d;t.value=Math.min(h/i.timeMs*100,100),t.value<100&&requestAnimationFrame(r)};requestAnimationFrame(r)}),(d,r)=>(a(),A(fn,{class:"BuilderCodePanelFileUploading",progress:t.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),yn=W(_n,[["__scopeId","data-v-449f2dac"]]),je=[{label:"Delete",value:"delete",icon:"delete"}],gn=M({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:i}){const t=e,d=i;function r(s){return s.join("/")}const _=b(()=>r(t.pathActive)),h=b(()=>t.pathsUnsaved.map(r)),f=b(()=>me(t.sourceFiles)?Object.entries(t.sourceFiles.children).sort((s,v)=>s[0].localeCompare(v[0])):[]);function c(s){const v=J([...t.path,s],t.sourceFiles);return $e(v)&&v.uploading}function y(s){const v=r([...t.path,s]);return h.value.includes(v)}function B(s){return r([...t.path,s])===_.value}function C(s){if(!me(t.sourceFiles)||c(s))return;const v=t.sourceFiles.children[s];me(v)||d("select",[...t.path,s])}function o(s,v){s==="delete"&&d("delete",[...t.path,v])}return(s,v)=>(a(),p("div",null,[(a(!0),p(Z,null,re(f.value,([u,m])=>(a(),A(cn,{key:u,name:u,matched:"","has-children":g(me)(m),selected:B(u),disabled:c(u),"right-click-options":je,"dropdown-options":g(me)(m)||g($e)(m)?je:void 0,onSelect:l=>C(u),onDropdownSelect:l=>o(l,u)},dt({children:x(()=>[I(Xe,{"source-files":m,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,u],onSelect:v[0]||(v[0]=l=>s.$emit("select",l)),onDelete:v[1]||(v[1]=l=>s.$emit("delete",l))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[c(u)||y(u)?{name:"nameLeft",fn:x(()=>[c(u)?(a(),A(yn,{key:0,"time-ms":2e3})):y(u)?(a(),A(Ye,{key:1,state:"newDraft"})):S("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),Xe=W(gn,[["__scopeId","data-v-42a4456e"]]),hn=["disabled"],bn={key:0,class:"material-symbols-outlined"},wn={class:"WdsButtonLink__text"},kn={key:1,class:"material-symbols-outlined"},Cn=M({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disbaled:{type:Boolean}},setup(e){const i=e,t=b(()=>[`WdsButtonLink--variant-${i.variant}`,`WdsButtonLink--weight-${i.weight}`]);return(d,r)=>(a(),p("button",{class:O(["WdsButtonLink",t.value]),disabled:e.disbaled,role:"button"},[e.leftIcon?(a(),p("i",bn,T(e.leftIcon),1)):S("",!0),n("span",wn,T(e.text),1),e.rightIcon?(a(),p("i",kn,T(e.rightIcon),1)):S("",!0)],10,hn))}}),Qe=W(Cn,[["__scopeId","data-v-27c92b97"]]),Bn={class:"BuilderCodePanelFileUploadBtn"},$n=M({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:i}){const t=Te("input"),d=i;function r(){var _;(_=t.value.files)!=null&&_.length&&d("selected",t.value.files)}return(_,h)=>(a(),p("form",Bn,[Le(n("input",{ref_key:"input",ref:t,type:"file",multiple:"true",onChange:r},null,544),[[We,!1]]),I(Qe,{"left-icon":"upload",text:"Upload",onClick:h[0]||(h[0]=f=>g(t).click())})]))}}),Sn={class:"BuilderCodePanel__tree"},Dn={class:"BuilderCodePanel__tree__actions"},Tn={key:1,class:"BuilderCodePanel__noPreview"},Ln={class:"BuilderCodePanel__actionsCompanion"},In=M({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const i=te(()=>ne(()=>import("./SharedMoreDropdown-DffPheGC.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),t=te({loader:()=>ne(()=>import("./BuilderEmbeddedCodeEditor-CHqWjmKb.js").then(D=>D.a),__vite__mapDeps([4,1,2,5]),import.meta.url),loadingComponent:ie}),d=V(K.core),r=[{label:"Rename file",value:"rename",icon:"edit"},{label:"Delete file",value:"delete",icon:"delete"}],_=de(d),{sourceFileDraft:h,openFile:f,upload:c,openNewFile:y,code:B,openedFileLanguage:C,filepathOpen:o,fileOpen:s,pathsUnsaved:v,save:u}=qt(d);async function m(D){await Promise.all([...D].map(l))}async function l(D){try{await c(D),$({type:"success",message:`File ${D.name} uploaded`})}catch(j){$({type:"error",message:j.message})}}const k=b(()=>{var D;return(D=s.value)==null?void 0:D.type}),{pushToast:$}=Ie(),w=He();function q(D){const j=new AbortController;ue(()=>{document.addEventListener("keydown",async Y=>{const Ae=Y.metaKey||Y.ctrlKey,Fe=Y.key==="s"||Y.key==="S";!Ae||!Fe||(Y.preventDefault(),await D())},{signal:j.signal})}),he(()=>j.abort())}q(_e);const E=Te("filenameEl"),U=H(""),F=H(!1),P=b(()=>{var D;return((D=o.value)==null?void 0:D.join("/"))??""}),Q=b(()=>P.value!=="main.py"),ce=b(()=>P.value!==U.value),oe=b(()=>F.value||P.value==="main.py"),be=b(()=>ce.value?!1:o.value===void 0?!0:!v.value.map(D=>D.join("/")).includes(P.value));Be(o,()=>{var D;U.value=((D=o.value)==null?void 0:D.join("/"))??""}),Be(d.sessionTimestamp,()=>{F.value=!1});function Pe(D){D&&(_.track("nav_code_opened"),o.value===void 0&&f(["main.py"]))}async function we(){var D;P.value!=="main.py"&&(await fe(),(D=E.value)==null||D.focus())}async function xe(D){switch(D){case"rename":return we();case"delete":await ke(o.value)}}async function ee(){await y(),we()}async function ke(D){await d.sendDeleteSourceFileRequest(D),$({type:"success",message:"The file was deleted"}),o.value.join("/").startsWith(D.join("/"))&&f(["main.py"])}async function _e(){if(o.value===void 0)return $({type:"error",message:"There is no file open"});if(be.value)return $({type:"info",message:"There are not file changes to save"});F.value=!0;try{await u(ce.value?U.value.split("/"):void 0),$({type:"success",message:"The file was saved"}),_.track("nav_code_file_updated",{path:o.value})}catch(D){w.error("The file hasn't been saved.",D),$({type:"error",message:"The file hasn't been saved"});return}finally{F.value=!1}}return(D,j)=>(a(),A(Je,{"panel-id":"code",name:"Code","contents-teleport-el":D.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"",onFilesDrop:m,onOpenned:Pe},{leftPanel:x(()=>[n("div",Sn,[I(Xe,{"path-active":g(o),"paths-unsaved":g(v),"source-files":g(h),onAddFile:ee,onSelect:g(f),onDelete:ke},null,8,["path-active","paths-unsaved","source-files","onSelect"]),n("div",Dn,[I(Qe,{"left-icon":"add",text:"Add file",onClick:ee}),I($n,{onSelected:m})])])]),actionsCompanion:x(()=>[n("div",Ln,[I(ut,{ref_key:"filenameEl",ref:E,modelValue:U.value,"onUpdate:modelValue":j[1]||(j[1]=Y=>U.value=Y),disabled:!Q.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:Ge(_e,["enter"])},null,8,["modelValue","disabled"]),I(G,{variant:"primary",size:"small",disabled:F.value||be.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:_e},{default:x(()=>j[3]||(j[3]=[n("i",{class:"material-symbols-outlined"},"keyboard_backspace",-1),R(" Save file ")])),_:1},8,["disabled"]),I(g(i),{disabled:oe.value,options:r,onSelect:xe},null,8,["disabled"])])]),default:x(()=>[k.value==="file"?(a(),A(g(t),{key:0,modelValue:g(B),"onUpdate:modelValue":j[0]||(j[0]=Y=>ct(B)?B.value=Y:null),variant:"full",language:g(C),disabled:F.value},null,8,["modelValue","language","disabled"])):S("",!0),k.value==="binary"?(a(),p("div",Tn,j[2]||(j[2]=[n("img",{class:"BuilderCodePanel__noPreview__img",src:Ot},null,-1),n("p",{class:"BuilderCodePanel__noPreview__title"},"Can’t Preview File",-1),n("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):S("",!0)]),_:1},8,["contents-teleport-el"]))}}),Pn=W(In,[["__scopeId","data-v-59d54f01"]]),xn={class:"BuiderLogBlueprintExecutionTrace"},An={key:0,class:"trace"},Fn={class:"type"},En={key:0},Mn={key:1},Rn={class:"main"},Un={key:0},Wn={key:1},On={key:2},zn={key:3},qn={class:"details"},Vn={class:"data","data-automation-key":"result"},Kn={key:1,class:"nothing"},jn={class:"data","data-automation-key":"return-value"},Nn={class:"environment"},Hn={class:"data"},Zn={key:1,class:"nothing"},Gn={class:"callStack"},Yn={class:"eyebrow"},Jn=M({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:i}){const t=V(K.core),d=V(K.builderManager),r=de(t),_=i,{goToComponentParentPage:h}=De(t,d),f=e,c=b(()=>{var o;const C=((o=f.executionItem.executionEnvironment)==null?void 0:o.call_stack)??[];return Object.fromEntries(C.map(s=>[s,t.getComponentById(s)]))}),y=b(()=>{var C;return((C=f.executionItem.executionEnvironment)==null?void 0:C.trace)??[]});ue(()=>{r.track("blueprints_logs_trace_opened")});async function B(C){_("closeModal"),d.setMode("blueprints"),await fe(),h(C),await fe(),d.setSelection(C,void 0,"log")}return(C,o)=>{var s,v,u;return a(),p("div",xn,[y.value.length>0?(a(),p("div",An,[(a(!0),p(Z,null,re(y.value,(m,l)=>(a(),p("div",{key:l,class:"traceEntry"},[n("div",Fn,[m.type=="functionCall"?(a(),p("span",En,"⚡️")):S("",!0),m.type=="reasoning"?(a(),p("span",Mn,"🧠")):S("",!0)]),n("div",Rn,[m.thought?(a(),p("div",Un,[o[0]||(o[0]=n("strong",null,"Thought.",-1)),R(" "+T(m.thought),1)])):S("",!0),m.action?(a(),p("div",Wn,[o[1]||(o[1]=n("strong",null,"Action.",-1)),R(" "+T(m.action),1)])):S("",!0),m.name?(a(),p("div",On,T(m.name),1)):S("",!0),m.parameters?(a(),p("div",zn,[I(ge,{"hide-root":!0,data:m.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):S("",!0)])]))),128))])):S("",!0),n("div",qn,[n("div",null,[o[2]||(o[2]=n("h3",null,"Result",-1)),o[3]||(o[3]=n("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),n("div",Vn,[(s=C.executionItem)!=null&&s.result?(a(),A(ge,{key:0,data:C.executionItem.result,"initial-depth":1,class:"data"},null,8,["data"])):(a(),p("div",Kn,"No result."))])]),n("div",null,[o[4]||(o[4]=n("h3",null,"Return value",-1)),o[5]||(o[5]=n("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),n("div",jn,[(v=C.executionItem)!=null&&v.returnValue?(a(),A(ge,{key:0,data:C.executionItem.returnValue,"initial-depth":1,class:"data"},null,8,["data"])):(a(),p(Z,{key:1},[R(" No return value. ")],64))])])]),n("div",Nn,[o[6]||(o[6]=n("h3",null,"Execution environment",-1)),o[7]||(o[7]=n("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),n("div",Hn,[(u=C.executionItem)!=null&&u.executionEnvironment?(a(),A(ge,{key:0,data:C.executionItem.executionEnvironment,"initial-depth":1,class:"data"},null,8,["data"])):(a(),p("div",Zn,"Empty execution environment."))])]),n("div",Gn,[o[9]||(o[9]=n("h3",null,"Call stack",-1)),(a(!0),p(Z,null,re(c.value,(m,l)=>{var k,$,w;return a(),p("div",{key:l,class:O(["component",{active:l==C.executionItem.componentId}])},[n("div",null,[n("div",Yn,[l==C.executionItem.componentId?(a(),p(Z,{key:0},[R(" This block · ")],64)):S("",!0),R(" "+T(((k=g(t).getComponentDefinition(m==null?void 0:m.type))==null?void 0:k.name)??"Unavailable component")+" · Id: "+T(l),1)]),R(" "+T((($=m==null?void 0:m.content)==null?void 0:$.alias)??((w=g(t).getComponentDefinition(m==null?void 0:m.type))==null?void 0:w.name)??"Unavailable component"),1)]),m?(a(),A(G,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:q=>B(l)},{default:x(()=>o[8]||(o[8]=[n("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):S("",!0)],2)}),128))])])}}}),Xn=W(Jn,[["__scopeId","data-v-6ee8bb1e"]]),Qn={class:"BuilderListItem"},ea=["viewBox"],ta=["d","stroke"],na=["d","stroke"],aa={class:"BuilderListItem__content"},oa=M({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:Se.Blue2},colorLast:{type:String,required:!1,default:Se.Blue2}},setup(e){const i=e,t=b(()=>i.height/2),d=b(()=>`0 0 17 ${i.height}`),r=b(()=>["M1 0",`V${t.value-8}`,`C1 ${t.value-4}.4183 4.58172 ${t.value} 9 ${t.value}`,"H17"].join(" ")),_=b(()=>[`M1 ${t.value-8}`,`V${i.height}`].join(" "));return(h,f)=>(a(),p("div",Qn,[(a(),p("svg",{viewBox:d.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?S("",!0):(a(),p("path",{key:0,d:_.value,stroke:e.colorLast,"stroke-width":"1"},null,8,ta)),n("path",{d:r.value,stroke:e.color,"stroke-width":"1"},null,8,na)],8,ea)),n("div",aa,[ae(h.$slots,"default",{},void 0,!0)])]))}}),sa=W(oa,[["__scopeId","data-v-33f3edcd"]]),la={class:"BuilderLogBlueprintExecution"},ia={class:"name"},ra={key:0},da={class:"eyebrow"},ua={class:"outcome"},ca={class:"result"},pa={class:"time"},va={key:0,class:"message markdown"},ma=M({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const i=V(K.core),t=V(K.builderManager),{goToComponentParentPage:d}=De(i,t),r=e,_=H(null),h=b(()=>({summary:[...r.executionLog.summary.filter(B=>!!B.outcome).map(B=>({...B,component:i.getComponentById(B.componentId),componentDef:i.getComponentById(B.componentId)?i.getComponentDefinition(i.getComponentById(B.componentId).type):void 0}))]}));async function f(y){t.setMode("blueprints"),await fe(),d(y),await fe(),t.setSelection(y,void 0,"log")}function c(y){return y<0?"N/A":y<.1?"< 0.1s":`${y.toFixed(2)}s`}return(y,B)=>{const C=pt("dompurify-html");return a(),p("div",la,[(a(!0),p(Z,null,re(h.value.summary,(o,s)=>(a(),A(sa,{key:s,"is-last":s+1===h.value.summary.length},{default:x(()=>{var v,u,m,l,k,$,w,q,E,U,F,P;return[n("div",{class:O(["itemWrapper",{"itemWrapper--first":s===0,"itemWrapper--last":s+1===h.value.summary.length}])},[n("div",{class:O(["item",{selected:g(t).isComponentIdSelected(o.componentId)}])},[n("div",ia,[(u=(v=o.component)==null?void 0:v.content)!=null&&u.alias?(a(),p("div",ra,[n("div",da,T(((m=o.componentDef)==null?void 0:m.name)??"Unavailable component"),1),R(" "+T((k=(l=o.component)==null?void 0:l.content)==null?void 0:k.alias),1)])):(a(),p(Z,{key:1},[R(T((($=o.componentDef)==null?void 0:$.name)??"Unavailable component"),1)],64)),o.component?(a(),A(G,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:Q=>f(o.componentId)},{default:x(()=>B[1]||(B[1]=[n("i",{class:"material-symbols-outlined"},"jump_to_element",-1)])),_:2},1032,["onClick"])):S("",!0)]),n("div",ua,[o.outcome!=="in_progress"?(a(),p(Z,{key:0},[n("div",{class:O(["ball",(E=(q=(w=o.componentDef)==null?void 0:w.outs)==null?void 0:q[o.outcome])==null?void 0:E.style])},null,2),R(" "+T(((P=(F=(U=o.componentDef)==null?void 0:U.outs)==null?void 0:F[o.outcome])==null?void 0:P.name)??o.outcome),1)],64)):(a(),p(Z,{key:1},[B[2]||(B[2]=n("div",{class:"ballContainer"},[n("div",{class:"ball inProgress"})],-1)),B[3]||(B[3]=R(" In progress... "))],64))]),n("div",ca,[_.value==s?(a(),A(Re,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>_.value=null}]},{default:x(()=>[I(Xn,{"execution-item":o,onCloseModal:B[0]||(B[0]=()=>_.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):S("",!0),o.result||o.returnValue||o.executionEnvironment?(a(),A(G,{key:1,variant:"special",size:"small",onClick:()=>_.value=s},{default:x(()=>B[4]||(B[4]=[n("i",{class:"material-symbols-outlined"},"find_in_page",-1),R(" Trace ")])),_:2},1032,["onClick"])):S("",!0)]),n("div",pa,T(c(o.executionTimeInSeconds)),1),o.message?Le((a(),p("div",va,null,512)),[[C,g(gt).parse(o.message)]]):S("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),fa=W(ma,[["__scopeId","data-v-d778122d"]]),_a={class:"BuilderLogIndicator"},ya={key:0,class:"number error"},ga={key:1,class:"number info"},ha=M({__name:"BuilderLogIndicator",setup(e){const i=V(K.builderManager),t=b(()=>i.getLogEntries().reduce((d,r)=>(r.type in d||(d[r.type]=0),d[r.type]++,d),{}));return(d,r)=>(a(),p("div",_a,[t.value.error>0?(a(),p("div",ya,[r[0]||(r[0]=n("div",{class:"icon"},[n("i",{class:"material-symbols-outlined"},"error")],-1)),R(" "+T(t.value.error??0),1)])):S("",!0),t.value.info>0?(a(),p("div",ga,[r[1]||(r[1]=n("div",{class:"icon"},[n("i",{class:"material-symbols-outlined"},"info")],-1)),R(" "+T(t.value.info??0),1)])):S("",!0)]))}}),ba=W(ha,[["__scopeId","data-v-34a7a9ff"]]),wa={key:0,class:"entries"},ka={class:"icon"},Ca={key:0,class:"material-symbols-outlined"},Ba={key:1,class:"material-symbols-outlined"},$a={class:"title"},Sa={class:"time"},Da={class:"content"},Ta={key:0,class:"codeContainer"},La={key:1,class:"emptyMessage"},Ia=M({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const i=V(K.core),t=V(K.builderManager),d=de(i);function r(f){f&&d.track("nav_logs_opened")}const _=[{icon:"delete",name:"Clear log",callback:()=>{t.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],h=b(()=>t.getLogEntries());return(f,c)=>(a(),A(Je,{"panel-id":"log",name:"Log","contents-teleport-el":f.contentsTeleportEl,actions:_,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:r},{titleCompanion:x(()=>[I(ba)]),default:x(()=>[h.value.length>0?(a(),p("div",wa,[(a(!0),p(Z,null,re(h.value,(y,B)=>(a(),p(Z,{key:B},[n("div",{class:O(["entry",y.type])},[n("div",ka,[y.type=="error"?(a(),p("i",Ca,"error")):(a(),p("i",Ba,"info"))]),n("div",$a,T(y.title)+T(y.repeated>0?` · Repeated ${y.repeated} times`:""),1),n("div",Sa,T(y.timestampReceived.toLocaleTimeString()),1),n("div",Da,[R(T(y.message)+" ",1),y.code?(a(),p("div",Ta,[n("code",null,T(y.code),1)])):S("",!0)])],2),y.blueprintExecution?(a(),A(fa,{key:0,"execution-log":y.blueprintExecution},null,8,["execution-log"])):S("",!0)],64))),128))])):S("",!0),h.value.length==0?(a(),p("div",La,c[0]||(c[0]=[n("div",null,[R(" Exceptions and other relevant messages will be shown here."),n("br"),R("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):S("",!0)]),_:1},8,["contents-teleport-el"]))}}),Pa=W(Ia,[["__scopeId","data-v-dd30a100"]]),xa={class:"switches"},Aa=M({__name:"BuilderPanelSwitcher",setup(e){const i=V(K.builderManager),t=Te("screenEl");return(d,r)=>(a(),p("div",{class:O(["BuilderPanelSwitcher",{openPanels:g(i).openPanels.value.size>0}])},[n("div",{ref_key:"screenEl",ref:t,class:"screen"},null,512),n("div",xa,[I(Pn,{"contents-teleport-el":g(t)},null,8,["contents-teleport-el"]),I(Pa,{"contents-teleport-el":g(t)},null,8,["contents-teleport-el"])])],2))}}),Fa=W(Aa,[["__scopeId","data-v-75a489c0"]]),Ea={class:"WdsToast__icon"},Ma={class:"material-symbols-outlined"},Ra={class:"material-symbols-outlined"},Ua=M({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const i=e,t=b(()=>{switch(i.type){case"info":return"info";case"success":return"check";case"error":return"close";default:return"question_mark"}});return(d,r)=>(a(),p("div",{class:O(["WdsToast",`WdsToast--${e.type}`])},[n("div",Ea,[n("span",Ma,T(t.value),1)]),n("p",null,T(e.message),1),e.action?(a(),p("button",{key:0,class:"WdsToast__action",onClick:r[0]||(r[0]=(..._)=>e.action.func&&e.action.func(..._))},[R(T(e.action.label)+" ",1),n("span",Ra,T(e.action.icon),1)])):S("",!0),e.closable?(a(),A(G,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:r[1]||(r[1]=_=>d.$emit("close"))},{default:x(()=>r[2]||(r[2]=[n("span",{class:"material-symbols-outlined"},"close",-1)])),_:1})):S("",!0)],2))}}),Wa=W(Ua,[["__scopeId","data-v-e8cc4657"]]),Oa={class:"BuilderToasts"},za=M({__name:"BuilderToasts",setup(e){const{toasts:i,removeToast:t}=Ie();return(d,r)=>(a(),p("div",Oa,[I(vt,{name:"list",tag:"div"},{default:x(()=>[(a(!0),p(Z,null,re(g(i),_=>(a(),A(Wa,{key:_.id,class:"BuilderToasts__toast",closable:_.closable,message:_.message,type:_.type,action:_.action,onClick:h=>g(t)(_.id)},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),qa=W(za,[["__scopeId","data-v-6c357255"]]),Va={key:0,class:"sidebar"},Ka={class:"builderMain"},ja={class:"rendererWrapper"},Na=M({__name:"BuilderApp",setup(e){mt(L=>({c23e0f1c:g(c).getMode()!=="preview"?"var(--builderSidebarWidth)":"0px"}));const i=te({loader:()=>ne(()=>import("./BuilderSettings-BHuJWzZ9.js"),__vite__mapDeps([6,1,2,7,8,4,5,9,10]),import.meta.url),loadingComponent:ie}),t=te({loader:()=>ne(()=>import("./BuilderSidebar-E9x1fdsG.js"),__vite__mapDeps([11,1,2,8,9,12]),import.meta.url),loadingComponent:ie}),d=te({loader:()=>ne(()=>import("./ComponentRenderer-FbxROz85.js"),__vite__mapDeps([13,1,2,7,14]),import.meta.url),loadingComponent:ie}),r=te({loader:()=>ne(()=>import("./BuilderInstanceTracker-D0yzJR-l.js"),__vite__mapDeps([15,1,2,16]),import.meta.url),loadingComponent:ie}),_=te({loader:()=>ne(()=>import("./BuilderInsertionOverlay-D2HKC6JD.js"),__vite__mapDeps([17,1,2,18]),import.meta.url),loadingComponent:ie}),h=te({loader:()=>ne(()=>import("./BuilderInsertionLabel-B7R3Z1Tv.js"),__vite__mapDeps([19,1,2,20]),import.meta.url),loadingComponent:ie}),f=V(K.core),c=V(K.builderManager),y=de(f),{candidateId:B,candidateInstancePath:C,isCandidacyConfirmed:o,dropComponent:s,assignInsertionCandidacy:v,removeInsertionCandidacy:u}=_t(f),{createAndInsertComponent:m,undo:l,redo:k,moveComponent:$,moveComponentUp:w,moveComponentDown:q,cutComponent:E,isPasteAllowed:U,isCopyAllowed:F,isCutAllowed:P,isDeleteAllowed:Q,isGoToParentAllowed:ce,pasteComponent:oe,copyComponent:be,removeComponentsSubtree:Pe,goToParent:we}=De(f,c,y),xe=Ie(),ee=b(()=>c.getMode()),ke=b(()=>c.firstSelectedId.value);async function _e(L){if(L.key=="Escape"){c.setSelection(null);return}const N=yt()?L.metaKey:L.ctrlKey;if(L.target.closest("textarea, input, select"))return;if(L.key=="z"&&N){L.preventDefault(),l();return}if(L.key=="y"&&N){L.preventDefault(),k();return}if(!c.isSingleSelectionActive.value||!c.firstSelectedItem.value)return;const{componentId:z,instancePath:pe}=c.firstSelectedItem.value;if(L.key=="Delete"){const se=c.selection.value.filter(Ee=>Q(Ee.componentId)).map(Ee=>Ee.componentId);Pe(...se);return}if(L.key=="ArrowUp"&&N&&L.shiftKey){if(!ce(z))return;we(z,pe);return}if(L.key=="ArrowUp"&&N){w(z);return}if(L.key=="ArrowDown"&&N){q(z);return}if(L.key=="v"&&N){if(!U(z))return;try{await oe(z)}catch(se){xe.pushToast({type:"error",message:String(se)})}return}if(L.key=="c"&&N){if(!F(z))return;be(z);return}if(L.key=="x"&&N){if(!P(z))return;E(z);return}}function D(L){ee.value!=="preview"&&v(L)}function j(L){if(ee.value==="preview")return;c.setSelection(null);const N=s(L);if(!N)return;const{draggedType:X,draggedId:z,parentId:pe,position:se}=N;z?$(z,pe,se):m(X,pe,se)}function Y(L){if(ee.value==="preview"||L.target.closest("[data-writer-unselectable]"))return;const X=L.target.closest("[data-writer-id]");if(!X)return;const z=X.dataset.writerId,pe=X.dataset.writerInstancePath;c.isComponentIdSelected(z)&&c.selectionStatus.value!==Ke.Multiple||(L.preventDefault(),L.stopPropagation(),c.handleSelectionFromEvent(L,z,pe,"click"))}function Ae(){c.isSettingsBarCollapsed.value=!1}const Fe=L=>{if(ee.value==="preview")return;const X=L.target.closest("[data-writer-id]").dataset.writerId,{type:z}=f.getComponentById(X);c.selectionStatus.value===Ke.Multiple&&(c.setSelection(X,void 0,"click"),c.isSettingsBarCollapsed.value=!0),L.dataTransfer.setData(`application/json;writer=${z},${X}`,"{}")};function et(L){c.setSelection(null),u(L)}const ze=new AbortController;return ue(()=>{document.addEventListener("keydown",_e,{signal:ze.signal})}),he(()=>ze.abort()),(L,N)=>(a(),p("div",{class:"BuilderApp",tabindex:"-1",style:Oe(g(ft))},[n("div",{class:O(["mainGrid",{openPanels:g(c).openPanels.value.size>0}])},[I(xt,{class:"builderHeader"}),ee.value!=="preview"?(a(),p("div",Va,[I(g(t))])):S("",!0),n("div",Ka,[n("div",ja,[I(g(d),{class:O(["componentRenderer",{settingsOpen:g(c).isSingleSelectionActive}]),onDragover:D,onDragstart:Fe,onDragend:et,onDrop:j,onClickCapture:Y,onDblclick:Ae},null,8,["class"])]),g(c).isSingleSelectionActive?(a(),A(g(i),{key:ke.value??"noneSelected"})):S("",!0)]),I(Fa,{class:"panelSwitcher"})],2),ee.value!=="preview"?(a(),p(Z,{key:0},[g(B)&&!g(o)?(a(),p(Z,{key:0},[(a(),A(g(r),{key:g(C),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":g(C),"match-size":!0},{default:x(()=>[I(g(_))]),_:1},8,["instance-path"])),(a(),A(g(r),{key:g(C),class:"insertionLabelTracker","instance-path":g(C),"vertical-offset-pixels":-48},{default:x(()=>[I(g(h),null,{default:x(()=>[R(T(g(f).getComponentDefinition(g(f).getComponentById(g(B)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):S("",!0)],64)):S("",!0),N[0]||(N[0]=n("div",{id:"modal"},null,-1)),I(Rt,{id:"tooltip"}),I(qa)],4))}}),Ha=W(Na,[["__scopeId","data-v-4f96196e"]]),Ya=Object.freeze(Object.defineProperty({__proto__:null,default:Ha},Symbol.toStringTag,{value:"Module"}));export{ie as B,cn as T,Qe as W,sa as a,Ya as b,Ie as u};
