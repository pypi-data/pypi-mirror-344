import"../chunks/CWj6FrbW.js";import{p as me,a as n,b as C,s as d,f as ye,c as we,d as s,e as o,g as e,u as x,r as l,t as ae}from"../chunks/DJ4-OfXg.js";import{t as P,a as H}from"../chunks/BBucZf18.js";import{i as R}from"../chunks/DU3kBxd7.js";import{S as ke,g as xe,a as ze}from"../chunks/Cf3ghc6X.js";import{D as I}from"../chunks/BWiL5A4Q.js";import{f as Se,B as Ce}from"../chunks/UUmwxa9-.js";import{g as p}from"../chunks/CqS7hfz2.js";var De=P('<div class="accordion-item"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">Data selection</button></h2> <div id="collapseTwo" class="accordion-collapse collapse show"><div class="accordion-body"><div class="row"><div class="col-6"><h3>Year</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Node</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Carrier</h3> <!></div></div> <div class="row"><div class="col-6"><h3>Smoothing Window Size</h3> <!></div></div></div></div></div>'),Oe=P('<div class="text-center"><div class="spinner-border center" role="status"><span class="visually-hidden">Loading...</span></div></div>'),je=P('<div style="position: relative;"><!></div>'),Te=P('<h2>The Energy Balance</h2> <div class="position-relative"><div class="filters"><div class="accordion" id="accordionExample"><div class="accordion-item solution-selection"><h2 class="accordion-header"><button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Solution Selection</button></h2> <div id="collapseOne" class="accordion-collapse collapse show"><div class="accordion-body"><!></div></div></div> <!></div></div></div> <div class="mt-4"><!> <!></div>',1);function Fe(re,oe){me(oe,!0);var D=["rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(255, 206, 86)","rgb(153, 102, 255)","rgb(255, 159, 64)","rgb(255, 99, 132)","rgb(201, 203, 207)","rgb(220,20,60)","rgb(255,99,71)","rgb(255,69,0)","rgb(154,205,50)","rgb(0,100,0)","rgb(50,205,50)","rgb(0,139,139)","rgb(153,50,204)","rgb(255,105,180)"];let r=n(null),A=n(!1),_=n(!1),v=n(!1),O=n(C([])),b=n(null),j=n(C([])),y=n(null),T=n(C([])),w=n(null),F=n(""),Y=n("");const se=["Hourly","Daily","Weekly","Monthly"];let K=n("Hourly"),W=n(C([])),Z=n(C([]));const le=x(()=>({type:"line",data:{datasets:e(W),labels:e(Z)},options:{animation:!1,normalized:!0,elements:{point:{radius:0}},responsive:!0,scales:{x:{stacked:!0,title:{display:!0,text:"Time"}},y:{stacked:!0,beginAtZero:!0,title:{display:!0,text:`Power [${e(F)}]`}}},borderWidth:1,plugins:{zoom:{pan:{enabled:!0,modifierKey:"ctrl",mode:"x"},zoom:{drag:{enabled:!0},wheel:{enabled:!0},mode:"x"}}}}}));async function ne(){e(r)&&(o(b,e(O)[0],!0),o(y,e(j)[0],!0),o(w,e(T)[0],!0),o(A,!1),await z())}async function z(){var M;if(o(v,!0),ae(),e(b)==null||e(y)==null||e(w)==null||e(r)==null){o(v,!1);return}let a=Math.floor((e(w)-e(r).detail.system.reference_year)/e(r).detail.system.interval_between_years),i=1;switch(e(K)){case"Daily":i=24;break;case"Weekly":i=168;break;case"Monthly":i=720;break}let c=await xe(e(r).solution_name,e(b),e(y),e(r).scenario_name,a,i),S=await ze(e(r).solution_name,p("flow_export",e(r).version),e(r).scenario_name);S===null?o(F,""):o(F,S.data[0][0],!0),o(W,[],!0);let f=0;for(const u in c){let k={node:[e(b)]};if(c[u]==null||c[u].data.length==0)continue;if("technology"in c[u].data[0]){let t=[];for(const g of c[u].data)t.push(g.technology);k={technology:t}}let B={},E=Se(c[u].data,k,B);if(E.length!=0)for(let t of E){if(Object.keys(t.data).length==0)continue;switch(u){case p("flow_storage_discharge",e(r).version):t.label=t.label+" (discharge)";break;case p("flow_transport_in",e(r).version):t.label=t.label+" (transport in)";break;case p("flow_import",e(r).version):t.label="Import",e(r).version;break;case p("shed_demand",e(r).version):t.label="Shed Demand";break;case p("flow_storage_charge",e(r).version):t.label=t.label+" (charge)";break;case p("flow_transport_out",e(r).version):t.label=t.label+" (transport out)";break;case p("flow_export",e(r).version):t.label="Export";break}let g="line";Object.keys(t.data).length==1&&(g="bar"),u=="demand"?(t.label="Demand",t.type="line",t.stack="ownCustomStack",t.fill=!1,t.borderColor="black",t.backgroundColor="white",t.borderWidth=2,t.stepped=!0,Object.keys(t.data).length==1&&(t.pointRadius=2)):(t.type=g,t.fill="origin",t.borderColor=D[f%D.length],t.backgroundColor=D[f%D.length].replace(")",", 1)"),t.stepped=!0,t.cubicInterpolationMode="monotone"),e(W).push(t),f++}}o(Z,Object.keys(e(W)[0].data),!0),o(v,!1),o(A,!0),await ae();let h=e(r).solution_name.split(".");o(Y,[h[(h==null?void 0:h.length)-1],(M=e(r))==null?void 0:M.scenario_name,"balance",e(y),e(b),e(w)].join("_"),!0)}var $=Te(),L=d(ye($),2),q=s(L),G=s(q),N=s(G),J=d(s(N),2),Q=s(J),ie=s(Q);const de=x(()=>!e(_)&&!e(v));ke(ie,{solution_selected:ne,get enabled(){return e(de)},get carriers(){return e(j)},set carriers(a){o(j,a,!0)},get nodes(){return e(O)},set nodes(a){o(O,a,!0)},get years(){return e(T)},set years(a){o(T,a,!0)},get selected_solution(){return e(r)},set selected_solution(a){o(r,a,!0)},get loading(){return e(_)},set loading(a){o(_,a,!0)}}),l(Q),l(J),l(N);var ce=d(N,2);{var ve=a=>{var i=De(),c=d(s(i),2),S=s(c),f=s(S),h=s(f),M=d(s(h),2);const u=x(()=>!e(v)&&!e(_));I(M,{get options(){return e(T)},selection_changed:z,get enabled(){return e(u)},get selected_option(){return e(w)},set selected_option(m){o(w,m,!0)}}),l(h),l(f);var k=d(f,2),B=s(k),E=d(s(B),2);const t=x(()=>!e(v)&&!e(_));I(E,{get options(){return e(O)},selection_changed:z,get enabled(){return e(t)},get selected_option(){return e(b)},set selected_option(m){o(b,m,!0)}}),l(B),l(k);var g=d(k,2),X=s(g),pe=d(s(X),2);const be=x(()=>!e(v)&&!e(_));I(pe,{get options(){return e(j)},selection_changed:z,get enabled(){return e(be)},get selected_option(){return e(y)},set selected_option(m){o(y,m,!0)}}),l(X),l(g);var ee=d(g,2),te=s(ee),fe=d(s(te),2);const he=x(()=>!e(v)&&!e(_));I(fe,{options:se,selection_changed:z,get enabled(){return e(he)},get selected_option(){return e(K)},set selected_option(m){o(K,m,!0)}}),l(te),l(ee),l(S),l(c),l(i),H(a,i)};R(ce,a=>{!e(_)&&e(r)&&a(ve)})}l(G),l(q),l(L);var U=d(L,2),V=s(U);{var ue=a=>{var i=Oe();H(a,i)};R(V,a=>{e(v)&&a(ue)})}var _e=d(V,2);{var ge=a=>{var i=je(),c=s(i);Ce(c,{get config(){return e(le)},get plot_name(){return e(Y)},zoom:!0}),l(i),H(a,i)};R(_e,a=>{!e(v)&&e(A)&&a(ge)})}l(U),H(re,$),we()}export{Fe as component};
