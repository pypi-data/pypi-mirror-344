[project]
name = "highlighter-sdk"
version =  "2.5.0"
readme = "README.md"
description = "Package to interact with the Highlighter Perception System"
requires-python = ">=3.10,<=3.13"

# From pep 0639:
# https://peps.python.org/pep-0639/#i-have-a-private-package-that-won-t-be-distributed
license-files = { paths = ["LICENSE"] }


keywords = [
  "enterprise perception system"
]

# See: https://pypi.org/classifiers/
classifiers = [
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "License :: OSI Approved :: Apache Software License",
    "Operating System :: Unix",
    "Intended Audience :: Developers",
]

authors = [
{name = "Joshua Patterson", email = "joshua.patterson@silverpond.com.au"},
{name = "Jono Chang", email = "jonathan.chang@silverpond.com.au"},
{name = "Simon Hudson", email = "simon.hudson@silverpond.com.au"},
]


dependencies = [
  "click>=7, <9, != 8.0.0",
  "Pillow~=10.4.0",
  "requests>=2.32.3,<3",
  "pandas~=2.2",
  "tqdm~=4.0",
  "pydantic>=1.6, <2.9",
  "aiohttp~=3.7",
  "PyYAML>=5.0",
  "colorama~=0.4.4",
  "jupyterlab~=4.1",
  "tables~=3.7",
  "shapely>2.0.1",
  "pooch~=1.5",
  "gql~=3.5.0",
  "websockets~=12.0",
  "boto3~=1.34.00",
  "python-magic~=0.4.0; sys_platform == 'linux'",
  "python-magic~=0.4.0; sys_platform == 'darwin'",
  "python-magic-bin~=0.4.0; sys_platform == 'win32'",
  "fastavro~=1.8",
  "requests-toolbelt",
  "cookiecutter",
  "av~=14.1.0",
  
  #aiko dependecies
  "asciimatics~=1.15.0",
  "avro~=1.12.0",
  "avro-validator~=1.2.1",
  "paho-mqtt>=1.6.1,<2.0.0",
  "psutil~=6.0.0",
  "pyperclip~=1.9.0",
  "pyzmq~=26.2.0",
  "transitions~=0.9.2",
  "wrapt~=1.16.0"
]

[project.optional-dependencies]
cv2 =        ["opencv-python~=4.7"]
predictors = ["opencv-python~=4.7", "torch", "onnxruntime"]
yolo =       ["opencv-python~=4.7", "torch", "onnxruntime", "ultralytics"]

# Needed to allow aiko_services git dependency
[tool.hatch.metadata]
allow-direct-references = true

[tool.hatch.envs.default]
dependencies = [
  "pytest~=8.0",
  "twine",
  "black>=19.10b0",
  "pylint~=2.6",
  "wrapt",  # needed due to error in pylint
  "nbstripout",
  "isort~=5.0",
]

[tool.hatch.envs.default.scripts]
test = "pytest {args:tests}"

check = [ ]

# Run formatting
# hatch run fmt:fmt
fmt = [
  "isort --cr . --resolve-all-configs --overwrite-in-place . ",
  "black --config pyproject.toml .",
  "nbstripout notebooks/*",
  "check",
  ]

[project.scripts]
hl = "highlighter.cli.highlighter:highlighter_group"
aiko_dashboard = "aiko_services.main.dashboard:main"
aiko_pipeline = "aiko_services.main.pipeline:main"
aiko_registrar = "aiko_services.main.registrar:main"

[project.urls]
Documentation = "https://highlighter-docs.netlify.app/"

[tool.hatch]
[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.isort]
profile = "black"
skip = ["./venv", "./src/highlighter/agent/template/*", "./src/highlighter/template/*"]

[tool.black]
line-length = 110
target-version = ['py310']
exclude = '''
(
    /src/highlighter/agent/template/.*
  | /src/highlighter/template/.*
  | /venv/.*
)
'''

# https://hatch.pypa.io/latest/config/build/#build-targets
[tool.hatch.build.targets.wheel]
packages = ["src/highlighter", "src/aiko_services"]
exclude = [
  "dist/",
  "venv/",
  "hl/",
  "docs/",
  "src/aiko_services/archive",
  "src/aiko_services/elements/media/data",
  "src/aiko_services/examples"
]

[tool.hatch.build.targets.sdist]
packages = ["src/highlighter", "src/aiko_services"]
exclude = [
  "dist/",
  "venv/",
  "hl/",
  "docs/",
  "src/aiko_services/archive",
  "src/aiko_services/elements/media/data",
  "src/aiko_services/examples"
]

[tool.hatch.build.targets.sdist.hooks.custom]
path = "check_aiko_is_vendored.py"
