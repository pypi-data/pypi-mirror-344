
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Membership probabilities &#8212; [ ASteCA ]</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2dd1c7b5" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=810a7e51"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/tabs.js?v=3ee01567"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'contents/membership';</script>
    <script src="../_static/umami.js?v=3075c5f1"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Generate synthetic clusters" href="synthetic.html" />
    <link rel="prev" title="Structure analysis" href="structure.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">[ ASteCA ]</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="user_guide.html">User Guide</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="cluster_mod.html">Cluster module</a></li>
<li class="toctree-l2"><a class="reference internal" href="membership_mod.html">Membership module</a></li>
<li class="toctree-l2"><a class="reference internal" href="isochrones_mod.html">Isochrones module</a></li>
<li class="toctree-l2"><a class="reference internal" href="synthetic_mod.html">Synthetic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="likelihood_mod.html">Likelihood module</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="tutorials.html">Tutorials</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="structure.html">Structure analysis</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Membership probabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="synthetic.html">Generate synthetic clusters</a></li>
<li class="toctree-l2"><a class="reference internal" href="paramfit.html">Parameters fit with pyABC</a></li>
<li class="toctree-l2"><a class="reference internal" href="masses_bfr.html">Masses and binary fraction</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../build/api/asteca.Cluster.html">Cluster</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build/api/asteca.Membership.html">Membership</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build/api/asteca.Isochrones.html">Isochrones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build/api/asteca.Synthetic.html">Synthetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../build/api/asteca.Likelihood.html">Likelihood</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/asteca/ASteCA/main?urlpath=tree/docs/contents/membership.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/asteca/ASteCA/blob/main/docs/contents/membership.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/asteca/ASteCA" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/asteca/ASteCA/edit/main/docs/contents/membership.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/asteca/ASteCA/issues/new?title=Issue%20on%20page%20%2Fcontents/membership.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/contents/membership.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Membership probabilities</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fastmp-method">fastMP method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-method">Bayesian method</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="membership-probabilities">
<span id="membership-ntbk"></span><h1>Membership probabilities<a class="headerlink" href="#membership-probabilities" title="Link to this heading">#</a></h1>
<p><strong>ASteCA</strong> includes a <a class="reference internal" href="../build/api/asteca.Membership.html#asteca.Membership" title="asteca.Membership"><span class="xref myst py py-class">Membership</span></a> class designed to estimate membership probabilities for stars in an observed field. The class currently supports two methods <a class="reference internal" href="../build/api/asteca.Membership.html#asteca.Membership.bayesian" title="asteca.Membership.bayesian"><span class="xref myst py py-meth">bayesian()</span></a> and <a class="reference internal" href="../build/api/asteca.Membership.html#asteca.Membership.fastmp" title="asteca.Membership.fastmp"><span class="xref myst py py-meth">fastmp()</span></a>, as described in the <a class="reference internal" href="membership_mod.html"><span class="doc std std-doc">Membership module</span></a> section.</p>
<p>Both methods require some parameters to be obtained before they can be used. In both cases the center and approximated number of true cluster members values need to be estimated. The <code class="docutils literal notranslate"><span class="pre">bayesian</span></code> method also requires an approximated cluster radius value.</p>
<p>In the following example we will show how these two methods can be applied on an observed field. We begin by loading the required packages and our field data file, and use this data to create an <a class="reference internal" href="../build/api/asteca.Cluster.html#asteca.Cluster" title="asteca.Cluster"><span class="xref myst py py-class">Cluster</span></a> object which we call <code class="docutils literal notranslate"><span class="pre">my_field</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asteca</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="n">field_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../_static/field.csv&quot;</span><span class="p">)</span>

<span class="n">my_field</span> <span class="o">=</span> <span class="n">asteca</span><span class="o">.</span><span class="n">Cluster</span><span class="p">(</span>
    <span class="n">ra</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;RA_ICRS&quot;</span><span class="p">],</span>
    <span class="n">dec</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;DE_ICRS&quot;</span><span class="p">],</span>
    <span class="n">pmra</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;pmRA&quot;</span><span class="p">],</span>
    <span class="n">pmde</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;pmDE&quot;</span><span class="p">],</span>
    <span class="n">plx</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;Plx&quot;</span><span class="p">],</span>
    <span class="n">e_pmra</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;e_pmRA&quot;</span><span class="p">],</span>
    <span class="n">e_pmde</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;e_pmDE&quot;</span><span class="p">],</span>
    <span class="n">e_plx</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;e_Plx&quot;</span><span class="p">],</span>
    <span class="n">verbose</span> <span class="o">=</span> <span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Instantiating cluster
Columns read   : RA, DEC, Plx, pmRA, pmDE
N_stars        : 8683
N_clust_min    : 25
N_clust_max    : 5000
Cluster object generated
</pre></div>
</div>
</div>
</div>
<p>We can generate a simple <code class="docutils literal notranslate"><span class="pre">(ra,</span> <span class="pre">dec)</span></code> plot to see that this is indeed an observed field and not a data file with the cluster member’s already identified.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">my_field</span><span class="o">.</span><span class="n">ra</span><span class="p">,</span> <span class="n">my_field</span><span class="o">.</span><span class="n">dec</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;ra&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;dec&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/3918bf0c3963d6468436322458d6a7676b5850485c685cfa63ecb05334db5c37.png" src="../_images/3918bf0c3963d6468436322458d6a7676b5850485c685cfa63ecb05334db5c37.png" />
</div>
</div>
<section id="fastmp-method">
<h2>fastMP method<a class="headerlink" href="#fastmp-method" title="Link to this heading">#</a></h2>
<p>Before running the <code class="docutils literal notranslate"><span class="pre">fastmp</span></code> method we need to estimate the center and approximated number of members for the cluster. The number of members in the cluster is a crucial parameter in the estimation of membership probabilities. <strong>ASteCA</strong> currently contains two methods within the <a class="reference internal" href="../build/api/asteca.Cluster.html#asteca.Cluster.get_nmembers" title="asteca.Cluster.get_nmembers"><span class="xref myst py py-meth">get_nmembers()</span></a> method, to perform this estimation. We use here the default methods both to estimate the center and the number of member stars.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate the cluster&#39;s center coordinates, use the default algorithm</span>
<span class="n">my_field</span><span class="o">.</span><span class="n">get_center</span><span class="p">()</span>

<span class="c1"># Estimate the number of cluster members, use the default algorithm</span>
<span class="n">my_field</span><span class="o">.</span><span class="n">get_nmembers</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Center coordinates found
radec_c        : (6.3049, 61.3218)
pms_c          : (-2.811, -1.070)
plx_c          : 0.288

Number of members estimated
N_cluster      : 600
</pre></div>
</div>
</div>
</div>
<p>With the required parameters loaded in the <code class="docutils literal notranslate"><span class="pre">my_field</span></code> object, we can instantiate a <code class="docutils literal notranslate"><span class="pre">membership</span></code> object as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a `membership` object</span>
<span class="n">memb</span> <span class="o">=</span> <span class="n">asteca</span><span class="o">.</span><span class="n">Membership</span><span class="p">(</span><span class="n">my_field</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Membership object generated
N_cluster      : 600
Random seed    : None
</pre></div>
</div>
</div>
</div>
<p>Now all we have to do is call the <code class="docutils literal notranslate"><span class="pre">fastmp</span></code> method to obtain the membership probabilities for all the stars in the observed frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run `fastmp` method</span>
<span class="n">probs_fastmp</span> <span class="o">=</span> <span class="n">memb</span><span class="o">.</span><span class="n">fastmp</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running fastMP
lonlat_c       : (119.7908, -1.3899)
pms_c          : (-2.811, -1.070)
plx_c          : 0.288
fixed_centers  : False
N_cluster      : 600
N_resample     : 1000
Convergence reached at 94 runs
</pre></div>
</div>
</div>
</div>
<p>Finally we plot the CMD of the field, coloring the stars according to their membership probabilities (only those with P&gt;50%):</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;fastMP membership probabilities&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>
<span class="n">msk</span> <span class="o">=</span> <span class="n">probs_fastmp</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">probs_fastmp</span><span class="p">[</span><span class="n">msk</span><span class="p">],</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/5b36773d2997da3c2de67de5e7946fb268c2ca56cec421cf8dc83a7c58df178f.png" src="../_images/5b36773d2997da3c2de67de5e7946fb268c2ca56cec421cf8dc83a7c58df178f.png" />
</div>
</div>
</section>
<section id="bayesian-method">
<h2>Bayesian method<a class="headerlink" href="#bayesian-method" title="Link to this heading">#</a></h2>
<p>As stated in the in the <a class="reference internal" href="membership_mod.html"><span class="doc std std-doc">Membership module</span></a> section, the <code class="docutils literal notranslate"><span class="pre">bayesian</span></code> method should only be preferred over <code class="docutils literal notranslate"><span class="pre">fastmp</span></code> when there is no proper motions and parallax data available. In those cases, the <code class="docutils literal notranslate"><span class="pre">fastmp</span></code> method will most likely give better results.</p>
<p>We will show here how the <code class="docutils literal notranslate"><span class="pre">bayesian</span></code> method can be used with photometric data exclusively. We thus re-instantiate a <code class="docutils literal notranslate"><span class="pre">Cluster</span></code> object without proper motions and parallax data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_field</span> <span class="o">=</span> <span class="n">asteca</span><span class="o">.</span><span class="n">Cluster</span><span class="p">(</span>
    <span class="n">ra</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;RA_ICRS&quot;</span><span class="p">],</span>
    <span class="n">dec</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;DE_ICRS&quot;</span><span class="p">],</span>
    <span class="n">magnitude</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;Gmag&quot;</span><span class="p">],</span>
    <span class="n">e_mag</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;e_Gmag&quot;</span><span class="p">],</span>
    <span class="n">color</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;BP-RP&quot;</span><span class="p">],</span>
    <span class="n">e_color</span><span class="o">=</span><span class="n">field_df</span><span class="p">[</span><span class="s2">&quot;e_BP-RP&quot;</span><span class="p">],</span>
    <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Instantiating cluster
Columns read   : RA, DEC, Magnitude, e_mag, Color, e_color
N_stars        : 8683
N_clust_min    : 25
N_clust_max    : 5000
Cluster object generated
</pre></div>
</div>
</div>
</div>
<p>Now we need to estimate the center coordinates and number of members (just like with <code class="docutils literal notranslate"><span class="pre">fastmp</span></code>) and in addition we need to add a <code class="docutils literal notranslate"><span class="pre">radius</span></code> argument (which is not required for <code class="docutils literal notranslate"><span class="pre">fastmp</span></code>).</p>
<p>We will use here the <code class="docutils literal notranslate"><span class="pre">density</span></code> algorithm of the <code class="docutils literal notranslate"><span class="pre">get_nmebers()</span></code> method to estimate the number of members, but we could have used the same default method used above with <code class="docutils literal notranslate"><span class="pre">fastmp</span></code> (or even set this argument manually):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate the cluster&#39;s center coordinates, using the `kde_2d` algorithm and (RA, DEC) data</span>
<span class="n">my_field</span><span class="o">.</span><span class="n">get_center</span><span class="p">(</span><span class="s2">&quot;kde_2d&quot;</span><span class="p">)</span>

<span class="c1"># Add a radius attribute manually</span>
<span class="n">my_field</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="mf">0.09</span>  <span class="c1"># in degrees</span>

<span class="c1"># Estimate the number of cluster members, using the `density` algorithm</span>
<span class="n">my_field</span><span class="o">.</span><span class="n">get_nmembers</span><span class="p">(</span><span class="s2">&quot;density&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Center coordinates found
radec_c        : (6.3142, 61.3262)

Number of members estimated
N_cluster      : 247
</pre></div>
</div>
</div>
</div>
<p>Now we can instantiate the <code class="docutils literal notranslate"><span class="pre">membership</span></code> object and obtain the membership probabilities using the <code class="docutils literal notranslate"><span class="pre">bayesian</span></code> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a `membership` object</span>
<span class="n">memb</span> <span class="o">=</span> <span class="n">asteca</span><span class="o">.</span><span class="n">Membership</span><span class="p">(</span><span class="n">my_field</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Run `bayesian` method</span>
<span class="n">probs_bayes</span> <span class="o">=</span> <span class="n">memb</span><span class="o">.</span><span class="n">bayesian</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Membership object generated
N_cluster      : 247
Random seed    : None

Running Bayesian DA
radec_c        : (6.3142, 61.3262)
radius         : 0.0900 [deg]
N_cluster      : 247
N_runs         : 1000
Convergence reached at 91 runs
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Bayesian membership probabilities&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>
<span class="n">msk</span> <span class="o">=</span> <span class="n">probs_bayes</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">probs_bayes</span><span class="p">[</span><span class="n">msk</span><span class="p">],</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">();</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/fa0d9c86db15ee3d280a3aeae6f13aeb712285e51b27cc6dd8a18f09ce770d3d.png" src="../_images/fa0d9c86db15ee3d280a3aeae6f13aeb712285e51b27cc6dd8a18f09ce770d3d.png" />
</div>
</div>
<p>A side-by-side plot of the CMDs shows that the stars with P&gt;50% selected by each of the methods are not necessarily the same, as is their assigned membership probabilities.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># fastMP membership</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;fastMP&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>
<span class="n">msk</span> <span class="o">=</span> <span class="n">probs_fastmp</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="n">im1</span><span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">probs_fastmp</span><span class="p">[</span><span class="n">msk</span><span class="p">],</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>

<span class="c1"># Bayesian memberhsip</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Bayesian&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>
<span class="n">msk</span> <span class="o">=</span> <span class="n">probs_bayes</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="n">im2</span> <span class="o">=</span> <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;BP-RP&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">field_df</span><span class="p">[</span><span class="s1">&#39;Gmag&#39;</span><span class="p">][</span><span class="n">msk</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">probs_bayes</span><span class="p">[</span><span class="n">msk</span><span class="p">],</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/f764ae4d0ceb805a00db1110a1196e1e5e891a6d6cdd1b6119eb0e8260a94028.png" src="../_images/f764ae4d0ceb805a00db1110a1196e1e5e891a6d6cdd1b6119eb0e8260a94028.png" />
</div>
</div>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="structure.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Structure analysis</p>
      </div>
    </a>
    <a class="right-next"
       href="synthetic.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Generate synthetic clusters</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fastmp-method">fastMP method</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-method">Bayesian method</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Gabriel I Perren
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Gabriel I Perren.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>