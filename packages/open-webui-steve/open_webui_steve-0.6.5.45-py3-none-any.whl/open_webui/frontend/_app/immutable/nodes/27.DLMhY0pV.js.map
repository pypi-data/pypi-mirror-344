{"version":3,"file":"27.DLMhY0pV.js","sources":["../../../../../../src/routes/(app)/workspace/models/create/+page.svelte"],"sourcesContent":["<script>\r\n\timport { v4 as uuidv4 } from 'uuid';\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { goto } from '$app/navigation';\r\n\timport { config, models, settings } from '$lib/stores';\r\n\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\timport { createNewModel, getModelById } from '$lib/apis/models';\r\n\timport { getModels } from '$lib/apis';\r\n\r\n\timport ModelEditor from '$lib/components/workspace/Models/ModelEditor.svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\tconst onSubmit = async (modelInfo) => {\r\n\t\tif ($models.find((m) => m.id === modelInfo.id)) {\r\n\t\t\ttoast.error(\r\n\t\t\t\t`Error: A model with the ID '${modelInfo.id}' already exists. Please select a different ID to proceed.`\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (modelInfo.id === '') {\r\n\t\t\ttoast.error('Error: Model ID cannot be empty. Please enter a valid ID to proceed.');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (modelInfo) {\r\n\t\t\tconst res = await createNewModel(localStorage.token, {\r\n\t\t\t\t...modelInfo,\r\n\t\t\t\tmeta: {\r\n\t\t\t\t\t...modelInfo.meta,\r\n\t\t\t\t\tprofile_image_url: modelInfo.meta.profile_image_url ?? '/static/favicon.png',\r\n\t\t\t\t\tsuggestion_prompts: modelInfo.meta.suggestion_prompts\r\n\t\t\t\t\t\t? modelInfo.meta.suggestion_prompts.filter((prompt) => prompt.content !== '')\r\n\t\t\t\t\t\t: null\r\n\t\t\t\t},\r\n\t\t\t\tparams: { ...modelInfo.params }\r\n\t\t\t}).catch((error) => {\r\n\t\t\t\ttoast.error(`${error}`);\r\n\t\t\t\treturn null;\r\n\t\t\t});\r\n\r\n\t\t\tif (res) {\r\n\t\t\t\tawait models.set(\r\n\t\t\t\t\tawait getModels(\r\n\t\t\t\t\t\tlocalStorage.token,\r\n\t\t\t\t\t\t$config?.features?.enable_direct_connections && ($settings?.directConnections ?? null)\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t\ttoast.success($i18n.t('Model created successfully!'));\r\n\t\t\t\tawait goto('/workspace/models');\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tlet model = null;\r\n\r\n\tonMount(async () => {\r\n\t\twindow.addEventListener('message', async (event) => {\r\n\t\t\tif (\r\n\t\t\t\t!['https://openwebui.com', 'https://www.openwebui.com', 'http://localhost:5173'].includes(\r\n\t\t\t\t\tevent.origin\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tlet data = JSON.parse(event.data);\r\n\r\n\t\t\tif (data?.info) {\r\n\t\t\t\tdata = data.info;\r\n\t\t\t}\r\n\r\n\t\t\tmodel = data;\r\n\t\t});\r\n\r\n\t\tif (window.opener ?? false) {\r\n\t\t\twindow.opener.postMessage('loaded', '*');\r\n\t\t}\r\n\r\n\t\tif (sessionStorage.model) {\r\n\t\t\tmodel = JSON.parse(sessionStorage.model);\r\n\t\t\tsessionStorage.removeItem('model');\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n{#key model}\r\n\t<ModelEditor {model} {onSubmit} />\r\n{/key}\r\n"],"names":["ctx","i18n","getContext","onSubmit","modelInfo","$models","m","toast","createNewModel","prompt","error","models","getModels","_a","$config","$settings","$i18n","goto","model","onMount","event","data","$$invalidate"],"mappings":"ivBAwFMA,EAAK,CAAA,2GAALA,EAAK,CAAA,CAAA,iOA5EJC,EAAOC,EAAW,MAAM,qBAExB,MAAAC,QAAkBC,GAAS,UAC5BC,EAAQ,KAAMC,GAAMA,EAAE,KAAOF,EAAU,EAAE,EAAA,CAC5CG,EAAM,MAC0B,+BAAAH,EAAU,EAAE,4DAAA,YAKzCA,EAAU,KAAO,GAAE,CACtBG,EAAM,MAAM,sEAAsE,SAI/EH,GACe,MAAAI,EAAe,aAAa,MAAK,IAC/CJ,EACH,KAAI,CACA,GAAAA,EAAU,KACb,kBAAmBA,EAAU,KAAK,mBAAqB,sBACvD,mBAAoBA,EAAU,KAAK,mBAChCA,EAAU,KAAK,mBAAmB,OAAQK,GAAWA,EAAO,UAAY,EAAE,EAC1E,MAEJ,OAAM,CAAA,GAAOL,EAAU,MAAM,CAC3B,CAAA,EAAA,MAAOM,IACTH,EAAM,MAAK,GAAIG,CAAK,EAAA,EACb,SAID,MAAAC,EAAO,IAAG,MACTC,EACL,aAAa,QACbC,EAAAC,GAAA,YAAAA,EAAS,WAAT,YAAAD,EAAmB,8BAA8BE,GAAA,YAAAA,EAAW,oBAAqB,KAAI,CAAA,EAGvFR,EAAM,QAAQS,EAAM,EAAE,6BAA6B,CAAA,EAC7C,MAAAC,EAAK,mBAAmB,IAK7B,IAAAC,EAAQ,KAEZ,OAAAC,EAAO,SAAA,CACN,OAAO,iBAAiB,gBAAkBC,GAAK,MAE3C,wBAAyB,4BAA6B,yBAAyB,SAChFA,EAAM,MAAM,SAMV,IAAAC,EAAO,KAAK,MAAMD,EAAM,IAAI,EAE5BC,GAAA,MAAAA,EAAM,OACTA,EAAOA,EAAK,MAGbC,EAAA,EAAAJ,EAAQG,CAAI,KAGT,OAAO,QAAU,KACpB,OAAO,OAAO,YAAY,SAAU,GAAG,EAGpC,eAAe,QAClBC,EAAA,EAAAJ,EAAQ,KAAK,MAAM,eAAe,KAAK,CAAA,EACvC,eAAe,WAAW,OAAO"}