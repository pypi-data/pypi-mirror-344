{"version":3,"file":"30.CJ0gq5aW.js","sources":["../../../../../../src/routes/(app)/workspace/prompts/create/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\r\n\timport { toast } from 'svelte-sonner';\r\n\timport { goto } from '$app/navigation';\r\n\timport { prompts } from '$lib/stores';\r\n\timport { onMount, tick, getContext } from 'svelte';\r\n\r\n\tconst i18n = getContext('i18n');\r\n\r\n\timport { createNewPrompt, getPrompts } from '$lib/apis/prompts';\r\n\timport PromptEditor from '$lib/components/workspace/Prompts/PromptEditor.svelte';\r\n\r\n\tlet prompt = null;\r\n\tconst onSubmit = async (_prompt) => {\r\n\t\tconst prompt = await createNewPrompt(localStorage.token, _prompt).catch((error) => {\r\n\t\t\ttoast.error(`${error}`);\r\n\t\t\treturn null;\r\n\t\t});\r\n\r\n\t\tif (prompt) {\r\n\t\t\ttoast.success($i18n.t('Prompt created successfully'));\r\n\r\n\t\t\tawait prompts.set(await getPrompts(localStorage.token));\r\n\t\t\tawait goto('/workspace/prompts');\r\n\t\t}\r\n\t};\r\n\r\n\tonMount(async () => {\r\n\t\twindow.addEventListener('message', async (event) => {\r\n\t\t\tif (\r\n\t\t\t\t!['https://openwebui.com', 'https://www.openwebui.com', 'http://localhost:5173'].includes(\r\n\t\t\t\t\tevent.origin\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t\t\treturn;\r\n\t\t\tconst _prompt = JSON.parse(event.data);\r\n\r\n\t\t\tprompt = {\r\n\t\t\t\ttitle: _prompt.title,\r\n\t\t\t\tcommand: _prompt.command,\r\n\t\t\t\tcontent: _prompt.content,\r\n\t\t\t\taccess_control: null\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\tif (window.opener ?? false) {\r\n\t\t\twindow.opener.postMessage('loaded', '*');\r\n\t\t}\r\n\r\n\t\tif (sessionStorage.prompt) {\r\n\t\t\tconst _prompt = JSON.parse(sessionStorage.prompt);\r\n\r\n\t\t\tprompt = {\r\n\t\t\t\ttitle: _prompt.title,\r\n\t\t\t\tcommand: _prompt.command,\r\n\t\t\t\tcontent: _prompt.content,\r\n\t\t\t\taccess_control: null\r\n\t\t\t};\r\n\t\t\tsessionStorage.removeItem('prompt');\r\n\t\t}\r\n\t});\r\n</script>\r\n\r\n{#key prompt}\r\n\t<PromptEditor {prompt} {onSubmit} />\r\n{/key}\r\n"],"names":["ctx","i18n","getContext","prompt","onSubmit","_prompt","createNewPrompt","error","toast","$i18n","prompts","getPrompts","goto","onMount","event","$$invalidate"],"mappings":"6rBA8DMA,EAAM,CAAA,2GAANA,EAAM,CAAA,CAAA,4JAxDL,MAAAC,EAAOC,EAAW,MAAM,yBAK1BC,EAAS,WACPC,EAAkB,MAAAC,GAAA,CACjBF,MAAeG,EAAgB,aAAa,MAAOD,CAAO,EAAE,MAAOE,IACxEC,EAAM,SAASD,CAAK,EAAA,EACb,SAIPC,EAAM,QAAQC,EAAM,EAAE,6BAA6B,CAAA,QAE7CC,EAAQ,IAAA,MAAUC,EAAW,aAAa,KAAK,CAAA,EAC/C,MAAAC,EAAK,oBAAoB,IAIjC,OAAAC,EAAA,SAAA,IACC,OAAO,iBAAiB,UAAkB,MAAAC,GAAA,MAEtC,wBAAyB,4BAA6B,uBAAyB,EAAA,SAChFA,EAAM,MAAA,EAAA,aAIFT,EAAU,KAAK,MAAMS,EAAM,IAAI,EAErCC,EAAA,EAAAZ,EAAA,CACC,MAAOE,EAAQ,MACf,QAASA,EAAQ,QACjB,QAASA,EAAQ,QACjB,eAAgB,UAId,OAAO,QAAU,KACpB,OAAO,OAAO,YAAY,SAAU,GAAG,EAGpC,eAAe,OAAA,OACZA,EAAU,KAAK,MAAM,eAAe,MAAM,EAEhDU,EAAA,EAAAZ,EAAA,CACC,MAAOE,EAAQ,MACf,QAASA,EAAQ,QACjB,QAASA,EAAQ,QACjB,eAAgB,OAEjB,eAAe,WAAW,QAAQ"}